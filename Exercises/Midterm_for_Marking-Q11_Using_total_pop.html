
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Midterm Examination: Part 1 &#8212; SCMA248 Introduction to Data Science</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">SCMA248 Introduction to Data Science</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to SCMA248 Introduction to Data Science
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1_Introduction_to_Data_Science.html">
   1. Introduction to Data Science
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter2_Python_Basics.html">
   2. Python Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3_Data_Preparation.html">
   3. Data Selection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter4_Data_Visualization.html">
   6. Data Visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter5_Practical_Statistics.html">
   7. Practical Statistics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter6_Regression.html">
   8. Regression Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter7_Introduction_Machine_Learning.html">
   9. Machine learning: Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter8_Unsupervised_Learning.html">
   10. Unsupervised Machine Learning: K-means Clustering
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/Exercises/Midterm_for_Marking-Q11_Using_total_pop.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FExercises/Midterm_for_Marking-Q11_Using_total_pop.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/Exercises/Midterm_for_Marking-Q11_Using_total_pop.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#population-dataset-2020-census-demographic-data-by-county">
   Population Dataset: 2020 Census Demographic Data by County.
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#detailed-description">
     Detailed description
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#population-by-us-states">
     Population by US states
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#visualization-of-u-s-population-by-race-and-u-s-states">
     Visualization of U.S. population by race and U.S. states
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#us-covid-19-dataset">
   US Covid-19 Dataset
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#data-cleaning-and-preparation-handling-missing-values">
     Data Cleaning and Preparation: Handling Missing Values
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#states-with-missing-fips">
     States with missing fips.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#filtering-out-missing-data">
     Filtering out Missing Data
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#droping-out-row-with-missing-fips">
       Droping out row with missing fips
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#list-of-obeservations-with-na-in-both-fips-and-deaths-column">
     List of obeservations with NA in both
     <strong>
      fips
     </strong>
     and
     <strong>
      deaths
     </strong>
     column.
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#merging-multiple-dataframes">
   Merging multiple DataFrames
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#removing-county-from-the-county-names-of-the-population-data-set">
     Removing ‘County’ from the county names of the
     <strong>
      population
     </strong>
     data set.
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#merging-two-dataframes">
     Merging two DataFrames
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#answer-when-merging-dataframes">
     Answer when merging DataFrames
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#working-on-the-merged-dataframe">
     Working on the merged DataFrame
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#query-by-state">
     Query by state
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="midterm-examination-part-1">
<h1>Midterm Examination: Part 1<a class="headerlink" href="#midterm-examination-part-1" title="Permalink to this headline">¶</a></h1>
<p>Due date: 15 March 2022 before 10 am.</p>
<p>Points: 15 for Part 1 (from 21 questions)</p>
<p>Do not alter this file.</p>
<p>Duplicate this file and move it into the Personal folder. Rename the file as Midterm_Part1_id (id is your student ID number, e.g. Midterm_Part1_6305001).</p>
<p>Write Python commands to answer each of the questions. For each question that requires numerical values (not list or dataframe), you also need to assign the variable e.g. ans1 to store the numerical answer for question 1. If there is more than 1 answer required, you must create more variables e.g. ans1_1, ans1_2 to store the values of the answers.</p>
<p>When you want to submit your file, you simply share access with me using my email <a class="reference external" href="mailto:pairote&#46;sat&#37;&#52;&#48;mahidol&#46;edu">pairote<span>&#46;</span>sat<span>&#64;</span>mahidol<span>&#46;</span>edu</a> and my TA <a class="reference external" href="mailto:p&#46;pooy&#46;pui&#46;i&#37;&#52;&#48;gmail&#46;com">p<span>&#46;</span>pooy<span>&#46;</span>pui<span>&#46;</span>i<span>&#64;</span>gmail<span>&#46;</span>com</a>. Do not move your file into the DS&#64;MathMahidol team.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://stackoverflow.com/questions/20625582/how-to-deal-with-settingwithcopywarning-in-pandas</span>

<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">chained_assignment</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">plotnine</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">kl</span><span class="o">/</span><span class="n">h_r05n_j76n32kt0dwy7kynw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_5980</span><span class="o">/</span><span class="mf">3652185203.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">from</span> <span class="nn">plotnine</span> <span class="kn">import</span> <span class="o">*</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;plotnine&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">id</span> <span class="o">=</span> <span class="mi">6305007</span>
</pre></div>
</div>
</div>
</div>
<section id="population-dataset-2020-census-demographic-data-by-county">
<h2>Population Dataset: 2020 Census Demographic Data by County.<a class="headerlink" href="#population-dataset-2020-census-demographic-data-by-county" title="Permalink to this headline">¶</a></h2>
<p>We begin with the first dataset, which we obtained from</p>
<p><a class="reference external" href="https://www.dataemporium.com/dataset/254/?gclid=CjwKCAiAg6yRBhBNEiwAeVyL0Jl9xZg-nt9evBLB04fAZPc-TPTEmrW9kMfoIqMhBJvHjXQ-GV5fPBoChYIQAvD_BwE">https://www.dataemporium.com/dataset/254/?gclid=CjwKCAiAg6yRBhBNEiwAeVyL0Jl9xZg-nt9evBLB04fAZPc-TPTEmrW9kMfoIqMhBJvHjXQ-GV5fPBoChYIQAvD_BwE</a></p>
<p>This dataset was created from the 2020 Census. It contains one row per county with the total population and a breakdown by race.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/Users/Kaemyuijang/SCMA248/Data/US_population.csv&#39;</span>

<span class="c1">#df = pd.read_csv(path, parse_dates=True, index_col = &#39;date&#39;)</span>

<span class="n">population</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="detailed-description">
<h3>Detailed description<a class="headerlink" href="#detailed-description" title="Permalink to this headline">¶</a></h3>
<p>This table breaks down the total population and population by race for each county in the United States, based on the 2020 Census.</p>
<p><strong>Some Terminology</strong>.</p>
<ul class="simple">
<li><p>A city is created by any population that has its own system of government and a semblance of a legal system. Cities are located within a county, within a state.</p></li>
<li><p>A county is a geographic unit created for political purposes within a state.</p></li>
</ul>
<p>Read more : Difference between city and county
<a class="reference external" href="http://www.differencebetween.net/miscellaneous/difference-between-city-and-county/#ixzz7NKcARPB5">http://www.differencebetween.net/miscellaneous/difference-between-city-and-county/#ixzz7NKcARPB5</a></p>
<p><strong>This table only includes numbers for people who checked off a single race in the census</strong>. This is the majority of people. You can see the number of people who belong to two or more races by subtracting POP_ONE_RACE from TOTAL_POPULATION.</p>
<p>Before proceeding to the next step, make sure you understand the difference between POP_ONE_RACE from TOTAL_POPULATION.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span> <span class="n">population</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

<span class="n">population</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state_abbr</th>
      <th>county</th>
      <th>total_population</th>
      <th>pop_one_race</th>
      <th>white</th>
      <th>black</th>
      <th>amarican_indian</th>
      <th>asian</th>
      <th>hawaiian</th>
      <th>other</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CT</td>
      <td>Fairfield County</td>
      <td>957419</td>
      <td>854584</td>
      <td>584184</td>
      <td>106756</td>
      <td>4369</td>
      <td>51341</td>
      <td>347</td>
      <td>107587</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CT</td>
      <td>Hartford County</td>
      <td>899498</td>
      <td>819125</td>
      <td>554184</td>
      <td>127194</td>
      <td>3145</td>
      <td>53844</td>
      <td>328</td>
      <td>80430</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CT</td>
      <td>Litchfield County</td>
      <td>185186</td>
      <td>172181</td>
      <td>158774</td>
      <td>3348</td>
      <td>511</td>
      <td>3486</td>
      <td>67</td>
      <td>5995</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CT</td>
      <td>Middlesex County</td>
      <td>164245</td>
      <td>152898</td>
      <td>134715</td>
      <td>8565</td>
      <td>392</td>
      <td>4987</td>
      <td>50</td>
      <td>4189</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CT</td>
      <td>New Haven County</td>
      <td>864835</td>
      <td>782472</td>
      <td>543831</td>
      <td>118933</td>
      <td>4058</td>
      <td>37520</td>
      <td>470</td>
      <td>77660</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Q1: Verify that the sum of counts in the columns [‘white’,’black’,’amarican_indian’,’asian’,’hawaiian’,’other’] is equal to the count in the column ‘pop_one_race’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span><span class="p">[</span><span class="s2">&quot;sum&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">population</span><span class="p">[[</span><span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="s1">&#39;amarican_indian&#39;</span><span class="p">,</span><span class="s1">&#39;asian&#39;</span><span class="p">,</span><span class="s1">&#39;hawaiian&#39;</span><span class="p">,</span><span class="s1">&#39;other&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">population</span>
<span class="n">ans1</span> <span class="o">=</span> <span class="n">population</span><span class="p">[</span><span class="s1">&#39;pop_one_race&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">equals</span><span class="p">(</span><span class="n">population</span><span class="p">[</span><span class="s1">&#39;sum&#39;</span><span class="p">])</span>
<span class="n">ans1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state_abbr</th>
      <th>county</th>
      <th>total_population</th>
      <th>pop_one_race</th>
      <th>white</th>
      <th>black</th>
      <th>amarican_indian</th>
      <th>asian</th>
      <th>hawaiian</th>
      <th>other</th>
      <th>sum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CT</td>
      <td>Fairfield County</td>
      <td>957419</td>
      <td>854584</td>
      <td>584184</td>
      <td>106756</td>
      <td>4369</td>
      <td>51341</td>
      <td>347</td>
      <td>107587</td>
      <td>854584</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CT</td>
      <td>Hartford County</td>
      <td>899498</td>
      <td>819125</td>
      <td>554184</td>
      <td>127194</td>
      <td>3145</td>
      <td>53844</td>
      <td>328</td>
      <td>80430</td>
      <td>819125</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CT</td>
      <td>Litchfield County</td>
      <td>185186</td>
      <td>172181</td>
      <td>158774</td>
      <td>3348</td>
      <td>511</td>
      <td>3486</td>
      <td>67</td>
      <td>5995</td>
      <td>172181</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CT</td>
      <td>Middlesex County</td>
      <td>164245</td>
      <td>152898</td>
      <td>134715</td>
      <td>8565</td>
      <td>392</td>
      <td>4987</td>
      <td>50</td>
      <td>4189</td>
      <td>152898</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CT</td>
      <td>New Haven County</td>
      <td>864835</td>
      <td>782472</td>
      <td>543831</td>
      <td>118933</td>
      <td>4058</td>
      <td>37520</td>
      <td>470</td>
      <td>77660</td>
      <td>782472</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Q2: How many counties are included in this dataset?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ans2</span> <span class="o">=</span> <span class="n">population</span><span class="o">.</span><span class="n">county</span><span class="o">.</span><span class="n">size</span>
<span class="n">ans2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3221
</pre></div>
</div>
</div>
</div>
<p>Q3: How many unique county names are there?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ans3</span> <span class="o">=</span> <span class="n">population</span><span class="o">.</span><span class="n">county</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">size</span>
<span class="n">ans3</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1956
</pre></div>
</div>
</div>
</div>
<p>Q4: What can be concluded from the difference between the number of counties and the number of unique county names?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3221, 11)
</pre></div>
</div>
</div>
</div>
<p>Q5: Create a table with the number of counties in each U.S. state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;state_abbr&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>state_abbr
AK     30
AL     67
AR     75
AZ     15
CA     58
CO     64
CT      8
DC      1
DE      3
FL     67
GA    159
HI      5
IA     99
ID     44
IL    102
IN     92
KS    105
KY    120
LA     64
MA     14
MD     24
ME     16
MI     83
MN     87
MO    115
MS     82
MT     56
NC    100
ND     53
NE     93
NH     10
NJ     21
NM     33
NV     17
NY     62
OH     88
OK     77
OR     36
PA     67
PR     78
RI      5
SC     46
SD     66
TN     95
TX    254
UT     29
VA    133
VT     14
WA     39
WI     72
WV     55
WY     23
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Q6: The following Python command uses <code class="docutils literal notranslate"><span class="pre">np.random.seed(id)</span></code> to set the seed number of your student ID. Complete the following command to create the variable ‘state_given’, which stores a randomly selected US state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
<span class="n">states_given</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">population</span><span class="o">.</span><span class="n">state_abbr</span><span class="o">.</span><span class="n">unique</span><span class="p">(),</span> <span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">states_given</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6305007
[&#39;OR&#39;]
</pre></div>
</div>
</div>
</div>
<p>Q7: List all counties in the randomly selected US state defined by <code class="docutils literal notranslate"><span class="pre">states_given</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;state_abbr == @states_given&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state_abbr</th>
      <th>county</th>
      <th>total_population</th>
      <th>pop_one_race</th>
      <th>white</th>
      <th>black</th>
      <th>amarican_indian</th>
      <th>asian</th>
      <th>hawaiian</th>
      <th>other</th>
      <th>sum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2694</th>
      <td>OR</td>
      <td>Baker County</td>
      <td>16668</td>
      <td>15635</td>
      <td>14936</td>
      <td>77</td>
      <td>186</td>
      <td>66</td>
      <td>21</td>
      <td>349</td>
      <td>15635</td>
    </tr>
    <tr>
      <th>2695</th>
      <td>OR</td>
      <td>Benton County</td>
      <td>95184</td>
      <td>86292</td>
      <td>74612</td>
      <td>1002</td>
      <td>819</td>
      <td>6428</td>
      <td>292</td>
      <td>3139</td>
      <td>86292</td>
    </tr>
    <tr>
      <th>2696</th>
      <td>OR</td>
      <td>Clackamas County</td>
      <td>421401</td>
      <td>380858</td>
      <td>334855</td>
      <td>4554</td>
      <td>3510</td>
      <td>20699</td>
      <td>1117</td>
      <td>16123</td>
      <td>380858</td>
    </tr>
    <tr>
      <th>2697</th>
      <td>OR</td>
      <td>Clatsop County</td>
      <td>41072</td>
      <td>37477</td>
      <td>34525</td>
      <td>226</td>
      <td>431</td>
      <td>564</td>
      <td>104</td>
      <td>1627</td>
      <td>37477</td>
    </tr>
    <tr>
      <th>2698</th>
      <td>OR</td>
      <td>Columbia County</td>
      <td>52589</td>
      <td>48007</td>
      <td>45243</td>
      <td>323</td>
      <td>733</td>
      <td>583</td>
      <td>121</td>
      <td>1004</td>
      <td>48007</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;state_abbr == &quot;NH&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state_abbr</th>
      <th>county</th>
      <th>total_population</th>
      <th>pop_one_race</th>
      <th>white</th>
      <th>black</th>
      <th>amarican_indian</th>
      <th>asian</th>
      <th>hawaiian</th>
      <th>other</th>
      <th>sum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>233</th>
      <td>NH</td>
      <td>Belknap County</td>
      <td>63705</td>
      <td>60615</td>
      <td>59134</td>
      <td>359</td>
      <td>128</td>
      <td>588</td>
      <td>14</td>
      <td>392</td>
      <td>60615</td>
    </tr>
    <tr>
      <th>234</th>
      <td>NH</td>
      <td>Carroll County</td>
      <td>50107</td>
      <td>48155</td>
      <td>47199</td>
      <td>134</td>
      <td>111</td>
      <td>359</td>
      <td>9</td>
      <td>343</td>
      <td>48155</td>
    </tr>
    <tr>
      <th>235</th>
      <td>NH</td>
      <td>Cheshire County</td>
      <td>76458</td>
      <td>72558</td>
      <td>69907</td>
      <td>708</td>
      <td>169</td>
      <td>1079</td>
      <td>53</td>
      <td>642</td>
      <td>72558</td>
    </tr>
    <tr>
      <th>236</th>
      <td>NH</td>
      <td>Coos County</td>
      <td>31268</td>
      <td>29925</td>
      <td>28946</td>
      <td>526</td>
      <td>93</td>
      <td>202</td>
      <td>3</td>
      <td>155</td>
      <td>29925</td>
    </tr>
    <tr>
      <th>237</th>
      <td>NH</td>
      <td>Grafton County</td>
      <td>91118</td>
      <td>86114</td>
      <td>81268</td>
      <td>819</td>
      <td>222</td>
      <td>2867</td>
      <td>24</td>
      <td>914</td>
      <td>86114</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># How to use loop variable inside pandas df.query()</span>
<span class="c1"># https://stackoverflow.com/questions/64828539/how-to-use-loop-variable-inside-pandas-df-query</span>

<span class="n">states_list</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;TX&quot;</span><span class="p">,</span><span class="s2">&quot;WI&quot;</span><span class="p">]</span>

<span class="c1">#print(population.query(&#39;states_list == &quot;AL&quot;&#39;)[[&#39;county&#39;]])</span>

<span class="k">for</span> <span class="n">st</span> <span class="ow">in</span> <span class="n">states_list</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
    <span class="c1">#print(&#39;states_list ==&#39; + str(st))</span>
       
    <span class="nb">print</span><span class="p">(</span><span class="n">population</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;state_abbr ==@st&#39;</span><span class="p">)[[</span><span class="s1">&#39;county&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TX
               county
2440  Anderson County
2441   Andrews County
2442  Angelina County
2443   Aransas County
2444    Archer County
...               ...
2689      Wood County
2690    Yoakum County
2691     Young County
2692    Zapata County
2693    Zavala County

[254 rows x 1 columns]
WI
                county
3149      Adams County
3150    Ashland County
3151     Barron County
3152   Bayfield County
3153      Brown County
...                ...
3216   Waukesha County
3217    Waupaca County
3218   Waushara County
3219  Winnebago County
3220       Wood County

[72 rows x 1 columns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span><span class="o">.</span><span class="n">state_abbr</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;CT&#39;, &#39;MN&#39;, &#39;WY&#39;, &#39;NJ&#39;, &#39;ND&#39;, &#39;NV&#39;, &#39;MD&#39;, &#39;NH&#39;, &#39;ME&#39;, &#39;MT&#39;, &#39;MS&#39;,
       &#39;OK&#39;, &#39;GA&#39;, &#39;KY&#39;, &#39;PA&#39;, &#39;SC&#39;, &#39;KS&#39;, &#39;CO&#39;, &#39;SD&#39;, &#39;NC&#39;, &#39;AK&#39;, &#39;UT&#39;,
       &#39;OH&#39;, &#39;ID&#39;, &#39;LA&#39;, &#39;WV&#39;, &#39;MI&#39;, &#39;MO&#39;, &#39;AL&#39;, &#39;RI&#39;, &#39;DE&#39;, &#39;VT&#39;, &#39;MA&#39;,
       &#39;VA&#39;, &#39;AR&#39;, &#39;NM&#39;, &#39;CA&#39;, &#39;AZ&#39;, &#39;TN&#39;, &#39;WA&#39;, &#39;PR&#39;, &#39;IL&#39;, &#39;TX&#39;, &#39;OR&#39;,
       &#39;IA&#39;, &#39;HI&#39;, &#39;NE&#39;, &#39;NY&#39;, &#39;IN&#39;, &#39;DC&#39;, &#39;FL&#39;, &#39;WI&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<p>Q8: Write Python code to select two random US states and include them in a list named <strong>states_list</strong>. Do not forget to use np.random.seed to set the random value to your ID.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
<span class="n">states_list</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">population</span><span class="o">.</span><span class="n">state_abbr</span><span class="o">.</span><span class="n">unique</span><span class="p">(),</span> <span class="mi">2</span><span class="p">,</span> <span class="n">replace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">states_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;OR&#39;, &#39;WA&#39;]
</pre></div>
</div>
</div>
</div>
<p>Q9: List all counties for each state in the <strong>states_list</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">st</span> <span class="ow">in</span> <span class="n">states_list</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">st</span><span class="p">)</span>
    <span class="c1">#print(&#39;states_list ==&#39; + str(st))</span>
       
    <span class="c1">#print(population.query(&#39;state_abbr ==@st&#39;)[[&#39;county&#39;]])</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">population</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;state_abbr ==@st&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>OR
     state_abbr             county  total_population  pop_one_race   white  \
2694         OR       Baker County             16668         15635   14936   
2695         OR      Benton County             95184         86292   74612   
2696         OR   Clackamas County            421401        380858  334855   
2697         OR     Clatsop County             41072         37477   34525   
2698         OR    Columbia County             52589         48007   45243   
2699         OR        Coos County             64929         59136   54930   
2700         OR       Crook County             24738         22722   21349   
2701         OR       Curry County             23446         21331   19925   
2702         OR   Deschutes County            198253        180993  169137   
2703         OR     Douglas County            111201        101896   96048   
2704         OR     Gilliam County              1995          1850    1770   
2705         OR       Grant County              7233          6703    6523   
2706         OR      Harney County              7495          6969    6566   
2707         OR  Hood River County             23977         20267   16381   
2708         OR     Jackson County            223259        198701  178193   
2709         OR   Jefferson County             24502         22091   15992   
2710         OR   Josephine County             88090         80038   75344   
2711         OR     Klamath County             69413         62494   54494   
2712         OR        Lake County              8160          7257    6691   
2713         OR        Lane County            382971        344179  309194   
2714         OR     Lincoln County             50395         45511   40624   
2715         OR        Linn County            128610        116596  107700   
2716         OR     Malheur County             31571         28327   21619   
2717         OR      Marion County            345920        303363  233321   
2718         OR      Morrow County             12186         10514    7472   
2719         OR   Multnomah County            815428        727014  556202   
2720         OR        Polk County             87433         78117   68274   
2721         OR     Sherman County              1870          1714    1643   
2722         OR   Tillamook County             27390         24773   22620   
2723         OR    Umatilla County             80075         70618   53461   
2724         OR       Union County             26196         24142   22565   
2725         OR     Wallowa County              7391          6922    6673   
2726         OR       Wasco County             26670         23673   19821   
2727         OR  Washington County            600372        529866  385455   
2728         OR     Wheeler County              1451          1331    1271   
2729         OR     Yamhill County            107722         96540   83667   

      black  amarican_indian  asian  hawaiian  other     sum  
2694     77              186     66        21    349   15635  
2695   1002              819   6428       292   3139   86292  
2696   4554             3510  20699      1117  16123  380858  
2697    226              431    564       104   1627   37477  
2698    323              733    583       121   1004   48007  
2699    289             1493    747       128   1549   59136  
2700     80              317    114        30    832   22722  
2701     84              541    214        25    542   21331  
2702    887             1563   2481       272   6653  180993  
2703    400             1950   1231       164   2103  101896  
2704      4               29      9        11     27    1850  
2705     13               65     23        10     69    6703  
2706      8              246     36         0    113    6969  
2707     53              274    392        37   3130   20267  
2708   1734             2781   3387       867  11739  198701  
2709    145             3323    149        24   2458   22091  
2710    415             1071    886       128   2194   80038  
2711    562             2998    786       122   3532   62494  
2712     49              131     54        10    322    7257  
2713   4660             4674   9620      1015  15016  344179  
2714    199             1795    658        95   2140   45511  
2715    681             1727   1477       295   4716  116596  
2716    465              539    396        53   5255   28327  
2717   4161             6836   7501      3821  47723  303363  
2718     58              167     33         5   2779   10514  
2719  45370             9906  62022      5457  48057  727014  
2720    735             1912   1774       361   5061   78117  
2721      0               19      8         3     41    1714  
2722     79              307    283        85   1399   24773  
2723    701             3082    720       151  12503   70618  
2724    161              242    220       492    462   24142  
2725      9               60     31         4    145    6922  
2726    133             1119    252       195   2153   23673  
2727  13437             6179  69106      3477  52212  529866  
2728      1               26      9         0     24    1331  
2729    900             1942   1579       212   8240   96540  
WA
     state_abbr               county  total_population  pop_one_race    white  \
2221         WA         Adams County             20613         17078     9164   
2222         WA        Asotin County             22285         20813    19858   
2223         WA        Benton County            206873        182727   146087   
2224         WA        Chelan County             79074         70583    55289   
2225         WA       Clallam County             77155         70469    62450   
2226         WA         Clark County            503311        451040   379827   
2227         WA      Columbia County              3952          3645     3442   
2228         WA       Cowlitz County            110730        100536    90812   
2229         WA       Douglas County             42938         36824    27842   
2230         WA         Ferry County              7178          6602     5118   
2231         WA      Franklin County             96749         80625    45837   
2232         WA      Garfield County              2286          2164     2098   
2233         WA         Grant County             99123         85914    57433   
2234         WA  Grays Harbor County             75636         68806    59052   
2235         WA        Island County             86857         77849    67928   
2236         WA     Jefferson County             32977         30425    28588   
2237         WA          King County           2269675       2033922  1273054   
2238         WA        Kitsap County            275611        243977   206398   
2239         WA      Kittitas County             44337         40635    36479   
2240         WA     Klickitat County             22735         20643    18271   
2241         WA         Lewis County             82149         74784    67825   
2242         WA       Lincoln County             10876         10166     9704   
2243         WA         Mason County             65726         59184    51023   
2244         WA      Okanogan County             42104         37969    27606   
2245         WA       Pacific County             23365         21406    19104   
2246         WA  Pend Oreille County             13401         12536    11811   
2247         WA        Pierce County            921130        805004   595446   
2248         WA      San Juan County             17788         16316    15276   
2249         WA        Skagit County            129523        115794    96540   
2250         WA      Skamania County             12036         11013    10308   
2251         WA     Snohomish County            827957        738461   546855   
2252         WA       Spokane County            539339        490979   442952   
2253         WA       Stevens County             46445         43131    39313   
2254         WA      Thurston County            294793        260633   215798   
2255         WA     Wahkiakum County              4422          4067     3884   
2256         WA   Walla Walla County             62584         55390    45471   
2257         WA       Whatcom County            226847        205114   175946   
2258         WA       Whitman County             47973         43437    36586   
2259         WA        Yakima County            256728        217961   124445   

       black  amarican_indian   asian  hawaiian   other      sum  
2221      41              439     135        13    7286    17078  
2222     116              299     206        34     300    20813  
2223    2893             2052    6397       607   24691   182727  
2224     296              817     809       124   13248    70583  
2225     615             4346    1263       119    1676    70469  
2226   11396             4835   24274      5306   25402   451040  
2227      11               50      23         1     118     3645  
2228     820             1720    1772       668    4744   100536  
2229     150              673     412        62    7685    36824  
2230      28             1309      46        11      90     6602  
2231    1790             1403    1904       232   29459    80625  
2232       9               18      11         0      28     2164  
2233     782             1660    1202       104   24733    85914  
2234    1026             3876    1050       134    3668    68806  
2235    2399              717    4019       440    2346    77849  
2236     207              565     497        50     518    30425  
2237  151468            19073  452475     20022  117830  2033922  
2238    7835             4306   14412      2969    8057   243977  
2239     402              539     931        93    2191    40635  
2240      64              550     145        42    1571    20643  
2241     564             1190     824       158    4223    74784  
2242      21              225      73        14     129    10166  
2243     713             2632     783       224    3809    59184  
2244     168             4881     284        41    4989    37969  
2245     101              554     463        47    1137    21406  
2246      57              396      78        11     183    12536  
2247   66006            12777   63460     18844   48471   805004  
2248      54              115     229        27     615    16316  
2249     888             2878    2832       418   12238   115794  
2250      74              187     121        34     289    11013  
2251   29293            10805  101464      5016   45028   738461  
2252   10979             8092   12654      4303   11999   490979  
2253     149             2680     290        89     610    43131  
2254    9403             4458   17268      3347   10359   260633  
2255      22               61      44         3      53     4067  
2256    1056              696     943       137    7087    55390  
2257    2347             6277   10127       725    9692   205114  
2258    1203              338    3646       155    1509    43437  
2259    2119            12979    3030       309   75079   217961  
</pre></div>
</div>
</div>
</div>
</section>
<section id="population-by-us-states">
<h3>Population by US states<a class="headerlink" href="#population-by-us-states" title="Permalink to this headline">¶</a></h3>
<p>Q10: Write Python code to create a table including the population for each U.S. state. The table should include total population, pop_one_race, white, black, etc. for each state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population_state</span> <span class="o">=</span> <span class="n">population</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;state_abbr&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population_state</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_population</th>
      <th>pop_one_race</th>
      <th>white</th>
      <th>black</th>
      <th>amarican_indian</th>
      <th>asian</th>
      <th>hawaiian</th>
      <th>other</th>
      <th>sum</th>
    </tr>
    <tr>
      <th>state_abbr</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AK</th>
      <td>733391</td>
      <td>643867</td>
      <td>435392</td>
      <td>21898</td>
      <td>111575</td>
      <td>44032</td>
      <td>12698</td>
      <td>18272</td>
      <td>643867</td>
    </tr>
    <tr>
      <th>AL</th>
      <td>5024279</td>
      <td>4767326</td>
      <td>3220452</td>
      <td>1296162</td>
      <td>33625</td>
      <td>76660</td>
      <td>2984</td>
      <td>137443</td>
      <td>4767326</td>
    </tr>
    <tr>
      <th>AR</th>
      <td>3011524</td>
      <td>2797949</td>
      <td>2114512</td>
      <td>453783</td>
      <td>27177</td>
      <td>51839</td>
      <td>14533</td>
      <td>136105</td>
      <td>2797949</td>
    </tr>
    <tr>
      <th>AZ</th>
      <td>7151502</td>
      <td>6154696</td>
      <td>4322337</td>
      <td>339150</td>
      <td>319512</td>
      <td>257430</td>
      <td>16397</td>
      <td>899870</td>
      <td>6154696</td>
    </tr>
    <tr>
      <th>CA</th>
      <td>39538223</td>
      <td>33777988</td>
      <td>16296122</td>
      <td>2237044</td>
      <td>631016</td>
      <td>6085947</td>
      <td>157263</td>
      <td>8370596</td>
      <td>33777988</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Q11: From the table of population by race for each US state created above, write Python code to calculate the (row) percentages (for each US state) of the following variables
<strong>‘white’,’black’,’amarican_indian’,’asian’,’hawaiian’,’other’</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">435392</span><span class="o">/</span><span class="mi">733391</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5936696796115578
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">races_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;white&#39;</span><span class="p">,</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="s1">&#39;amarican_indian&#39;</span><span class="p">,</span><span class="s1">&#39;asian&#39;</span><span class="p">,</span><span class="s1">&#39;hawaiian&#39;</span><span class="p">,</span><span class="s1">&#39;other&#39;</span><span class="p">]</span>

<span class="c1">#population_state[races_list] = population_state[races_list].apply(lambda x: x/x.sum(), axis=1)</span>

<span class="c1">#population_state.head()</span>
<span class="n">q11</span> <span class="o">=</span> <span class="n">population_state</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">x</span><span class="o">/</span><span class="n">population_state</span><span class="o">.</span><span class="n">total_population</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)[</span><span class="n">races_list</span><span class="p">]</span>
<span class="n">q11</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>white</th>
      <th>black</th>
      <th>amarican_indian</th>
      <th>asian</th>
      <th>hawaiian</th>
      <th>other</th>
    </tr>
    <tr>
      <th>state_abbr</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>AK</th>
      <td>59.366968</td>
      <td>2.985856</td>
      <td>15.213576</td>
      <td>6.003892</td>
      <td>1.731409</td>
      <td>2.491440</td>
    </tr>
    <tr>
      <th>AL</th>
      <td>64.097794</td>
      <td>25.797970</td>
      <td>0.669250</td>
      <td>1.525791</td>
      <td>0.059392</td>
      <td>2.735577</td>
    </tr>
    <tr>
      <th>AR</th>
      <td>70.214018</td>
      <td>15.068218</td>
      <td>0.902433</td>
      <td>1.721354</td>
      <td>0.482580</td>
      <td>4.519473</td>
    </tr>
    <tr>
      <th>AZ</th>
      <td>60.439569</td>
      <td>4.742360</td>
      <td>4.467761</td>
      <td>3.599663</td>
      <td>0.229281</td>
      <td>12.582951</td>
    </tr>
    <tr>
      <th>CA</th>
      <td>41.216121</td>
      <td>5.657928</td>
      <td>1.595964</td>
      <td>15.392566</td>
      <td>0.397749</td>
      <td>21.170896</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Q12: List the first five states with the highest percentage of white Americans.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#population_state.sort_values(by = [&#39;white&#39;], ascending = False).head(5)</span>
<span class="n">q11</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;white&#39;</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>white</th>
      <th>black</th>
      <th>amarican_indian</th>
      <th>asian</th>
      <th>hawaiian</th>
      <th>other</th>
    </tr>
    <tr>
      <th>state_abbr</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ME</th>
      <td>90.801397</td>
      <td>1.890251</td>
      <td>0.578775</td>
      <td>1.233008</td>
      <td>0.032517</td>
      <td>0.714202</td>
    </tr>
    <tr>
      <th>VT</th>
      <td>89.841652</td>
      <td>1.404808</td>
      <td>0.355945</td>
      <td>1.795897</td>
      <td>0.028146</td>
      <td>0.815921</td>
    </tr>
    <tr>
      <th>WV</th>
      <td>89.799556</td>
      <td>3.669087</td>
      <td>0.206610</td>
      <td>0.842330</td>
      <td>0.026537</td>
      <td>0.720237</td>
    </tr>
    <tr>
      <th>NH</th>
      <td>88.288740</td>
      <td>1.461094</td>
      <td>0.220032</td>
      <td>2.604011</td>
      <td>0.032885</td>
      <td>1.749655</td>
    </tr>
    <tr>
      <th>WY</th>
      <td>84.662070</td>
      <td>0.906993</td>
      <td>2.409288</td>
      <td>0.903526</td>
      <td>0.100373</td>
      <td>3.481488</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Q13: List the first five states with the highest percentage of black Americans.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#population_state.sort_values(by = [&#39;black&#39;], ascending = False).head(5)</span>
<span class="n">q11</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">],</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>white</th>
      <th>black</th>
      <th>amarican_indian</th>
      <th>asian</th>
      <th>hawaiian</th>
      <th>other</th>
    </tr>
    <tr>
      <th>state_abbr</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>DC</th>
      <td>39.619459</td>
      <td>41.449071</td>
      <td>0.463059</td>
      <td>4.864802</td>
      <td>0.062650</td>
      <td>5.408494</td>
    </tr>
    <tr>
      <th>MS</th>
      <td>56.019477</td>
      <td>36.622047</td>
      <td>0.555503</td>
      <td>1.104557</td>
      <td>0.038970</td>
      <td>1.920116</td>
    </tr>
    <tr>
      <th>LA</th>
      <td>57.058623</td>
      <td>31.431932</td>
      <td>0.679662</td>
      <td>1.855786</td>
      <td>0.041028</td>
      <td>3.063685</td>
    </tr>
    <tr>
      <th>GA</th>
      <td>51.862684</td>
      <td>30.998334</td>
      <td>0.472540</td>
      <td>4.471920</td>
      <td>0.068139</td>
      <td>5.181701</td>
    </tr>
    <tr>
      <th>MD</th>
      <td>48.692973</td>
      <td>29.470714</td>
      <td>0.515523</td>
      <td>6.814453</td>
      <td>0.052564</td>
      <td>6.652519</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="visualization-of-u-s-population-by-race-and-u-s-states">
<h3>Visualization of U.S. population by race and U.S. states<a class="headerlink" href="#visualization-of-u-s-population-by-race-and-u-s-states" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">popultion_melted</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">population_state</span><span class="p">[</span><span class="n">races_list</span><span class="o">+</span><span class="p">[</span><span class="s1">&#39;state_abbr&#39;</span><span class="p">]],</span> <span class="n">id_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;state_abbr&#39;</span><span class="p">],</span> <span class="n">value_vars</span><span class="o">=</span><span class="n">races_list</span><span class="p">)</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;value&quot;</span><span class="p">:</span><span class="s2">&quot;proportion&quot;</span><span class="p">,</span><span class="s2">&quot;variable&quot;</span><span class="p">:</span><span class="s2">&quot;race&quot;</span><span class="p">})</span>

<span class="nb">print</span><span class="p">(</span><span class="n">popultion_melted</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    state_abbr   race  proportion
0           AK  white    0.676214
1           AL  white    0.675526
2           AR  white    0.755736
3           AZ  white    0.702283
4           CA  white    0.482448
..         ...    ...         ...
307         VT  other    0.008658
308         WA  other    0.074708
309         WI  other    0.032896
310         WV  other    0.007560
311         WY  other    0.037652

[312 rows x 3 columns]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
<span class="n">ggplot</span><span class="p">(</span><span class="n">popultion_melted</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;state_abbr in @states_list&#39;</span><span class="p">))</span> 
    <span class="o">+</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;state_abbr&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;proportion&#39;</span><span class="p">,</span><span class="n">fill</span> <span class="o">=</span> <span class="s1">&#39;race&#39;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">geom_col</span><span class="p">(</span><span class="n">position</span> <span class="o">=</span> <span class="s2">&quot;fill&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">theme</span><span class="p">(</span><span class="n">axis_text_x</span><span class="o">=</span><span class="n">element_text</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">hjust</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> 
    <span class="c1">#+ facet_wrap(&#39;state_abbr&#39;)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Midterm_for_Marking-Q11_Using_total_pop_45_0.png" src="../_images/Midterm_for_Marking-Q11_Using_total_pop_45_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (309372941)&gt;
</pre></div>
</div>
</div>
</div>
<p>Q14: Write Python to graph the US population by race broken down by state.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
<span class="n">ggplot</span><span class="p">(</span><span class="n">popultion_melted</span><span class="p">)</span> 
    <span class="o">+</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;state_abbr&#39;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;proportion&#39;</span><span class="p">,</span><span class="n">fill</span> <span class="o">=</span> <span class="s1">&#39;race&#39;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">geom_col</span><span class="p">(</span><span class="n">position</span> <span class="o">=</span> <span class="s2">&quot;fill&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">theme</span><span class="p">(</span><span class="n">axis_text_x</span><span class="o">=</span><span class="n">element_text</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">hjust</span><span class="o">=</span><span class="mi">4</span><span class="p">))</span> 
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Midterm_for_Marking-Q11_Using_total_pop_47_0.png" src="../_images/Midterm_for_Marking-Q11_Using_total_pop_47_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (309375445)&gt;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="us-covid-19-dataset">
<h2>US Covid-19 Dataset<a class="headerlink" href="#us-covid-19-dataset" title="Permalink to this headline">¶</a></h2>
<p>The second dataset can be downloaded from</p>
<p><a class="reference external" href="https://www.kaggle.com/fireballbyedimyrnmom/us-counties-covid-19-dataset">https://www.kaggle.com/fireballbyedimyrnmom/us-counties-covid-19-dataset</a>.</p>
<p>Each data row contains data on cumulative coronavirus cases and deaths.</p>
<p>The specific data here, are the data <strong>PER US COUNTY</strong>.</p>
<p>We will work with this Covid-19 dataset by preprocessing data, performing statistical data analysis and presenting the results.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/Users/Kaemyuijang/SCMA248/Data/us-counties.csv&#39;</span>

<span class="c1">#df = pd.read_csv(path, parse_dates=True, index_col = &#39;date&#39;)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span> <span class="n">index_col</span> <span class="o">=</span> <span class="s1">&#39;date&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="data-cleaning-and-preparation-handling-missing-values">
<h3>Data Cleaning and Preparation: Handling Missing Values<a class="headerlink" href="#data-cleaning-and-preparation-handling-missing-values" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>county</th>
      <th>state</th>
      <th>fips</th>
      <th>cases</th>
      <th>deaths</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-21</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-01-22</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-01-23</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-01-24</th>
      <td>Cook</td>
      <td>Illinois</td>
      <td>17031.0</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-01-24</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;state == &quot;Nevada&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fips</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([32003., 32031., 32510., 32007.,    nan, 32023., 32005., 32019.,
       32013., 32033., 32001., 32021., 32015., 32017., 32029., 32027.,
       32011., 32009.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#df.query(&#39;fips ==32510.&#39;).</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2252245, 5)
</pre></div>
</div>
</div>
</div>
<p>Q15: List all variables (or columns) in this Covid-19 dataset with missing data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Find columns with missing data</span>
<span class="c1"># https://moonbooks.org/Articles/How-to-filter-missing-data-NAN-or-NULL-values-in-a-pandas-DataFrame-/</span>

<span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>county    False
state     False
fips       True
cases     False
deaths     True
dtype: bool
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get a list of columns with missing data</span>

<span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">()]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;fips&#39;, &#39;deaths&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>Q16: Calculate the number of missing data for each variable (i.e. in each column).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the number of missing data per column</span>

<span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>county        0
state         0
fips      20955
cases         0
deaths    51599
dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="states-with-missing-fips">
<h3>States with missing fips.<a class="headerlink" href="#states-with-missing-fips" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">fips</span><span class="o">.</span><span class="n">isnull</span><span class="p">()])</span><span class="o">.</span><span class="n">state</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;New York&#39;, &#39;Rhode Island&#39;, &#39;New Jersey&#39;, &#39;Puerto Rico&#39;,
       &#39;Virgin Islands&#39;, &#39;Guam&#39;, &#39;Maine&#39;, &#39;Massachusetts&#39;, &#39;Louisiana&#39;,
       &#39;Kentucky&#39;, &#39;Nevada&#39;, &#39;Tennessee&#39;, &#39;Arkansas&#39;, &#39;Georgia&#39;,
       &#39;Missouri&#39;, &#39;Minnesota&#39;, &#39;California&#39;, &#39;Colorado&#39;, &#39;Florida&#39;,
       &#39;Hawaii&#39;, &#39;Illinois&#39;, &#39;Vermont&#39;, &#39;Arizona&#39;, &#39;Michigan&#39;, &#39;Texas&#39;,
       &#39;Virginia&#39;, &#39;Washington&#39;, &#39;Utah&#39;, &#39;Idaho&#39;, &#39;Mississippi&#39;,
       &#39;Northern Mariana Islands&#39;, &#39;Connecticut&#39;, &#39;Nebraska&#39;, &#39;Montana&#39;,
       &#39;Pennsylvania&#39;, &#39;Indiana&#39;, &#39;Iowa&#39;, &#39;Maryland&#39;, &#39;Oklahoma&#39;,
       &#39;West Virginia&#39;, &#39;Alaska&#39;, &#39;New Mexico&#39;, &#39;New Hampshire&#39;,
       &#39;South Dakota&#39;, &#39;Kansas&#39;, &#39;Wyoming&#39;, &#39;Delaware&#39;, &#39;North Dakota&#39;,
       &#39;Ohio&#39;, &#39;Wisconsin&#39;, &#39;South Carolina&#39;, &#39;Oregon&#39;, &#39;North Carolina&#39;,
       &#39;American Samoa&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
</section>
<section id="filtering-out-missing-data">
<h3>Filtering out Missing Data<a class="headerlink" href="#filtering-out-missing-data" title="Permalink to this headline">¶</a></h3>
<section id="droping-out-row-with-missing-fips">
<h4>Droping out row with missing fips<a class="headerlink" href="#droping-out-row-with-missing-fips" title="Permalink to this headline">¶</a></h4>
<p>Here is the list of observations with missing fips.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">fips</span><span class="o">.</span><span class="n">isnull</span><span class="p">()])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>county</th>
      <th>state</th>
      <th>fips</th>
      <th>cases</th>
      <th>deaths</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-03-01</th>
      <td>New York City</td>
      <td>New York</td>
      <td>NaN</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-03-01</th>
      <td>Unknown</td>
      <td>Rhode Island</td>
      <td>NaN</td>
      <td>2</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-03-02</th>
      <td>New York City</td>
      <td>New York</td>
      <td>NaN</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-03-02</th>
      <td>Unknown</td>
      <td>Rhode Island</td>
      <td>NaN</td>
      <td>2</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-03-03</th>
      <td>New York City</td>
      <td>New York</td>
      <td>NaN</td>
      <td>2</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2022-02-25</th>
      <td>Unknown</td>
      <td>Puerto Rico</td>
      <td>NaN</td>
      <td>16665</td>
      <td>4101.0</td>
    </tr>
    <tr>
      <th>2022-02-25</th>
      <td>Unknown</td>
      <td>Rhode Island</td>
      <td>NaN</td>
      <td>29206</td>
      <td>12.0</td>
    </tr>
    <tr>
      <th>2022-02-25</th>
      <td>Unknown</td>
      <td>Tennessee</td>
      <td>NaN</td>
      <td>23465</td>
      <td>557.0</td>
    </tr>
    <tr>
      <th>2022-02-25</th>
      <td>Unknown</td>
      <td>Utah</td>
      <td>NaN</td>
      <td>4184</td>
      <td>75.0</td>
    </tr>
    <tr>
      <th>2022-02-25</th>
      <td>Unknown</td>
      <td>Vermont</td>
      <td>NaN</td>
      <td>15364</td>
      <td>17.0</td>
    </tr>
  </tbody>
</table>
<p>20955 rows × 5 columns</p>
</div></div></div>
</div>
<p>Q16: Write Python code to drop rows only when the column ‘fips’ has NaN in it. How many rows are there in the resutling DataFrame.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fips&#39;</span><span class="p">]))</span>

<span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fips&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                county       state     fips  cases  deaths
date                                                      
2020-01-21   Snohomish  Washington  53061.0      1     0.0
2020-01-22   Snohomish  Washington  53061.0      1     0.0
2020-01-23   Snohomish  Washington  53061.0      1     0.0
2020-01-24        Cook    Illinois  17031.0      1     0.0
2020-01-24   Snohomish  Washington  53061.0      1     0.0
...                ...         ...      ...    ...     ...
2022-02-25  Sweetwater     Wyoming  56037.0  10991   123.0
2022-02-25       Teton     Wyoming  56039.0   9767    16.0
2022-02-25       Uinta     Wyoming  56041.0   5616    36.0
2022-02-25    Washakie     Wyoming  56043.0   2336    43.0
2022-02-25      Weston     Wyoming  56045.0   1541    18.0

[2231290 rows x 5 columns]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2231290, 5)
</pre></div>
</div>
</div>
</div>
<p>Now we can varify that we have successfully dropped rows with NaN values only in the fips column.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fips&#39;</span><span class="p">]))</span><span class="o">.</span><span class="n">fips</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p>Q18: How many NaN values remain in the <strong>Deaths</strong> column in the resutling DataFrame after deleting only rows where the  ‘fips’ column contains NaN?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;fips&#39;</span><span class="p">]))</span><span class="o">.</span><span class="n">deaths</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>51599
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2252245, 5)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="list-of-obeservations-with-na-in-both-fips-and-deaths-column">
<h3>List of obeservations with NA in both <strong>fips</strong> and <strong>deaths</strong> column.<a class="headerlink" href="#list-of-obeservations-with-na-in-both-fips-and-deaths-column" title="Permalink to this headline">¶</a></h3>
<p>We want to select only those rows from this DataFrame, where columns <strong>fips</strong> and <strong>deaths</strong> have NaN values i.e.</p>
<p>See Select Dataframe Rows with NaN in multiple columns</p>
<p><a class="reference external" href="https://thispointer.com/pandas-select-rows-with-nan-in-column/">https://thispointer.com/pandas-select-rows-with-nan-in-column/</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">fips</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">df</span><span class="o">.</span><span class="n">deaths</span><span class="o">.</span><span class="n">isnull</span><span class="p">()])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>county</th>
      <th>state</th>
      <th>fips</th>
      <th>cases</th>
      <th>deaths</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<p>Q19: Drop all rows with missing values in the deaths column</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2179691, 5)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state_abbr</th>
      <th>county</th>
      <th>total_population</th>
      <th>pop_one_race</th>
      <th>white</th>
      <th>black</th>
      <th>amarican_indian</th>
      <th>asian</th>
      <th>hawaiian</th>
      <th>other</th>
      <th>sum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CT</td>
      <td>Fairfield County</td>
      <td>957419</td>
      <td>854584</td>
      <td>584184</td>
      <td>106756</td>
      <td>4369</td>
      <td>51341</td>
      <td>347</td>
      <td>107587</td>
      <td>854584</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CT</td>
      <td>Hartford County</td>
      <td>899498</td>
      <td>819125</td>
      <td>554184</td>
      <td>127194</td>
      <td>3145</td>
      <td>53844</td>
      <td>328</td>
      <td>80430</td>
      <td>819125</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CT</td>
      <td>Litchfield County</td>
      <td>185186</td>
      <td>172181</td>
      <td>158774</td>
      <td>3348</td>
      <td>511</td>
      <td>3486</td>
      <td>67</td>
      <td>5995</td>
      <td>172181</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CT</td>
      <td>Middlesex County</td>
      <td>164245</td>
      <td>152898</td>
      <td>134715</td>
      <td>8565</td>
      <td>392</td>
      <td>4987</td>
      <td>50</td>
      <td>4189</td>
      <td>152898</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CT</td>
      <td>New Haven County</td>
      <td>864835</td>
      <td>782472</td>
      <td>543831</td>
      <td>118933</td>
      <td>4058</td>
      <td>37520</td>
      <td>470</td>
      <td>77660</td>
      <td>782472</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
</section>
<section id="merging-multiple-dataframes">
<h2>Merging multiple DataFrames<a class="headerlink" href="#merging-multiple-dataframes" title="Permalink to this headline">¶</a></h2>
<p>The Covid-19 dataset contains only data on cumulative coronavirus cases and deaths. To perform our analysis, e.g., to compare infection rates among different U.S. states, we need to add more information on the population size of each county.</p>
<p>We will need to download another data frame that contains the list of state abbreviations. We will then combine multiple data frames by adding the ‘total_population’ to the Covid-19 dataset.</p>
<ul class="simple">
<li><p>List of State Abbreviations:</p></li>
</ul>
<p><a class="reference external" href="https://worldpopulationreview.com/states/state-abbreviations">https://worldpopulationreview.com/states/state-abbreviations</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/Users/Kaemyuijang/SCMA248/Data/us_state_abbreviations.csv&#39;</span>

<span class="n">abbr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">abbr</span><span class="o">.</span><span class="n">columns</span><span class="o">=</span> <span class="n">abbr</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>

<span class="c1">#abbr.rename(columns={&quot;State&quot;:&quot;state&quot;,&quot;Abbrev&quot;:&quot;abbrev&quot;,&quot;Code&quot;:&quot;code&quot;}, inplace = True)</span>

<span class="n">abbr</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state</th>
      <th>abbrev</th>
      <th>code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Alabama</td>
      <td>Ala.</td>
      <td>AL</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Alaska</td>
      <td>Alaska</td>
      <td>AK</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Arizona</td>
      <td>Ariz.</td>
      <td>AZ</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Arkansas</td>
      <td>Ark.</td>
      <td>AR</td>
    </tr>
    <tr>
      <th>4</th>
      <td>California</td>
      <td>Calif.</td>
      <td>CA</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state_abbr</th>
      <th>county</th>
      <th>total_population</th>
      <th>pop_one_race</th>
      <th>white</th>
      <th>black</th>
      <th>amarican_indian</th>
      <th>asian</th>
      <th>hawaiian</th>
      <th>other</th>
      <th>sum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CT</td>
      <td>Fairfield County</td>
      <td>957419</td>
      <td>854584</td>
      <td>584184</td>
      <td>106756</td>
      <td>4369</td>
      <td>51341</td>
      <td>347</td>
      <td>107587</td>
      <td>854584</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CT</td>
      <td>Hartford County</td>
      <td>899498</td>
      <td>819125</td>
      <td>554184</td>
      <td>127194</td>
      <td>3145</td>
      <td>53844</td>
      <td>328</td>
      <td>80430</td>
      <td>819125</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CT</td>
      <td>Litchfield County</td>
      <td>185186</td>
      <td>172181</td>
      <td>158774</td>
      <td>3348</td>
      <td>511</td>
      <td>3486</td>
      <td>67</td>
      <td>5995</td>
      <td>172181</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CT</td>
      <td>Middlesex County</td>
      <td>164245</td>
      <td>152898</td>
      <td>134715</td>
      <td>8565</td>
      <td>392</td>
      <td>4987</td>
      <td>50</td>
      <td>4189</td>
      <td>152898</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CT</td>
      <td>New Haven County</td>
      <td>864835</td>
      <td>782472</td>
      <td>543831</td>
      <td>118933</td>
      <td>4058</td>
      <td>37520</td>
      <td>470</td>
      <td>77660</td>
      <td>782472</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>county</th>
      <th>state</th>
      <th>fips</th>
      <th>cases</th>
      <th>deaths</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-21</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-01-22</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-01-23</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-01-24</th>
      <td>Cook</td>
      <td>Illinois</td>
      <td>17031.0</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2020-01-24</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Q20: Using the population and us_state_abbreviations datasets, write Python code to add the ‘total_population’ to the Covid-19 dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_index</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">abbr</span><span class="p">[[</span><span class="s1">&#39;state&#39;</span><span class="p">,</span><span class="s1">&#39;code&#39;</span><span class="p">]],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="s1">&#39;state&#39;</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">index</span> <span class="o">=</span> <span class="n">df_index</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>county</th>
      <th>state</th>
      <th>fips</th>
      <th>cases</th>
      <th>deaths</th>
      <th>code</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-21</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>2020-01-22</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>2020-01-23</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>2020-01-24</th>
      <td>Cook</td>
      <td>Illinois</td>
      <td>17031.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>IL</td>
    </tr>
    <tr>
      <th>2020-01-24</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>WA</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state_abbr</th>
      <th>county</th>
      <th>total_population</th>
      <th>pop_one_race</th>
      <th>white</th>
      <th>black</th>
      <th>amarican_indian</th>
      <th>asian</th>
      <th>hawaiian</th>
      <th>other</th>
      <th>sum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CT</td>
      <td>Fairfield County</td>
      <td>957419</td>
      <td>854584</td>
      <td>584184</td>
      <td>106756</td>
      <td>4369</td>
      <td>51341</td>
      <td>347</td>
      <td>107587</td>
      <td>854584</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CT</td>
      <td>Hartford County</td>
      <td>899498</td>
      <td>819125</td>
      <td>554184</td>
      <td>127194</td>
      <td>3145</td>
      <td>53844</td>
      <td>328</td>
      <td>80430</td>
      <td>819125</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CT</td>
      <td>Litchfield County</td>
      <td>185186</td>
      <td>172181</td>
      <td>158774</td>
      <td>3348</td>
      <td>511</td>
      <td>3486</td>
      <td>67</td>
      <td>5995</td>
      <td>172181</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CT</td>
      <td>Middlesex County</td>
      <td>164245</td>
      <td>152898</td>
      <td>134715</td>
      <td>8565</td>
      <td>392</td>
      <td>4987</td>
      <td>50</td>
      <td>4189</td>
      <td>152898</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CT</td>
      <td>New Haven County</td>
      <td>864835</td>
      <td>782472</td>
      <td>543831</td>
      <td>118933</td>
      <td>4058</td>
      <td>37520</td>
      <td>470</td>
      <td>77660</td>
      <td>782472</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="removing-county-from-the-county-names-of-the-population-data-set">
<h3>Removing ‘County’ from the county names of the <strong>population</strong> data set.<a class="headerlink" href="#removing-county-from-the-county-names-of-the-population-data-set" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://stackoverflow.com/questions/13682044/remove-unwanted-parts-from-strings-in-a-column</span>
<span class="n">population</span><span class="p">[</span><span class="s1">&#39;county&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">population</span><span class="p">[</span><span class="s1">&#39;county&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s1">&#39; County&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The number of unique county names in population</span>
<span class="n">population</span><span class="o">.</span><span class="n">county</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">size</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1932
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The number of unique county names in Covid-19 data</span>
<span class="n">df</span><span class="o">.</span><span class="n">county</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span><span class="o">.</span><span class="n">size</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1852
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>county</th>
      <th>state</th>
      <th>fips</th>
      <th>cases</th>
      <th>deaths</th>
      <th>code</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-21</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>2020-01-22</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>2020-01-23</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>2020-01-24</th>
      <td>Cook</td>
      <td>Illinois</td>
      <td>17031.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>IL</td>
    </tr>
    <tr>
      <th>2020-01-24</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>WA</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df.drop(columns=[&#39;total_population_x&#39;,&#39;total_population_y&#39;], inplace = True)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;county&#39;, &#39;state&#39;, &#39;fips&#39;, &#39;cases&#39;, &#39;deaths&#39;, &#39;code&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2179691, 6)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>county</th>
      <th>state</th>
      <th>fips</th>
      <th>cases</th>
      <th>deaths</th>
      <th>code</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-21</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>2020-01-22</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>2020-01-23</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>WA</td>
    </tr>
    <tr>
      <th>2020-01-24</th>
      <td>Cook</td>
      <td>Illinois</td>
      <td>17031.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>IL</td>
    </tr>
    <tr>
      <th>2020-01-24</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>WA</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>state_abbr</th>
      <th>county</th>
      <th>total_population</th>
      <th>pop_one_race</th>
      <th>white</th>
      <th>black</th>
      <th>amarican_indian</th>
      <th>asian</th>
      <th>hawaiian</th>
      <th>other</th>
      <th>sum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>CT</td>
      <td>Fairfield</td>
      <td>957419</td>
      <td>854584</td>
      <td>584184</td>
      <td>106756</td>
      <td>4369</td>
      <td>51341</td>
      <td>347</td>
      <td>107587</td>
      <td>854584</td>
    </tr>
    <tr>
      <th>1</th>
      <td>CT</td>
      <td>Hartford</td>
      <td>899498</td>
      <td>819125</td>
      <td>554184</td>
      <td>127194</td>
      <td>3145</td>
      <td>53844</td>
      <td>328</td>
      <td>80430</td>
      <td>819125</td>
    </tr>
    <tr>
      <th>2</th>
      <td>CT</td>
      <td>Litchfield</td>
      <td>185186</td>
      <td>172181</td>
      <td>158774</td>
      <td>3348</td>
      <td>511</td>
      <td>3486</td>
      <td>67</td>
      <td>5995</td>
      <td>172181</td>
    </tr>
    <tr>
      <th>3</th>
      <td>CT</td>
      <td>Middlesex</td>
      <td>164245</td>
      <td>152898</td>
      <td>134715</td>
      <td>8565</td>
      <td>392</td>
      <td>4987</td>
      <td>50</td>
      <td>4189</td>
      <td>152898</td>
    </tr>
    <tr>
      <th>4</th>
      <td>CT</td>
      <td>New Have</td>
      <td>864835</td>
      <td>782472</td>
      <td>543831</td>
      <td>118933</td>
      <td>4058</td>
      <td>37520</td>
      <td>470</td>
      <td>77660</td>
      <td>782472</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df = pd.merge(df,population[[&#39;county&#39;,&#39;code&#39;,&#39;total_population&#39;]], how=&#39;inner&#39;,on=[&#39;county&#39;,&#39;code&#39;])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df = pd.merge(df,population[[&#39;code&#39;,&#39;county&#39;,&#39;total_population&#39;]], how=&#39;left&#39;,left_on=[&#39;county&#39;,&#39;code&#39;], right_on=[&#39;county&#39;,&#39;code&#39;])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df = pd.merge(df,population[[&#39;county&#39;,&#39;total_population&#39;]], how=&#39;left&#39;, on=&#39;county&#39;)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="merging-two-dataframes">
<h3>Merging two DataFrames<a class="headerlink" href="#merging-two-dataframes" title="Permalink to this headline">¶</a></h3>
<p>To add total population, rename the column <strong>state_abbr</strong> of the DataFrame population to <strong>code</strong> for merging</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#abbr.rename(columns={&quot;State&quot;:&quot;state&quot;,&quot;Abbrev&quot;:&quot;abbrev&quot;,&quot;Code&quot;:&quot;code&quot;}, inplace = True)</span>

<span class="n">population</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;state_abbr&quot;</span><span class="p">:</span><span class="s2">&quot;code&quot;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">population</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;code&#39;</span><span class="p">,</span><span class="s1">&#39;county&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>  code      county  total_population  pop_one_race   white   black  \
0   CT   Fairfield            957419        854584  584184  106756   
1   CT    Hartford            899498        819125  554184  127194   
2   CT  Litchfield            185186        172181  158774    3348   
3   CT   Middlesex            164245        152898  134715    8565   
4   CT    New Have            864835        782472  543831  118933   

   amarican_indian  asian  hawaiian   other     sum  
0             4369  51341       347  107587  854584  
1             3145  53844       328   80430  819125  
2              511   3486        67    5995  172181  
3              392   4987        50    4189  152898  
4             4058  37520       470   77660  782472  
           code     county
date                      
2020-01-21   WA  Snohomish
2020-01-22   WA  Snohomish
2020-01-23   WA  Snohomish
2020-01-24   IL       Cook
2020-01-24   WA  Snohomish
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;county&#39;, &#39;state&#39;, &#39;fips&#39;, &#39;cases&#39;, &#39;deaths&#39;, &#39;code&#39;], dtype=&#39;object&#39;)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2179691, 6)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">population</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">population</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;code&#39;, &#39;county&#39;, &#39;total_population&#39;, &#39;pop_one_race&#39;, &#39;white&#39;, &#39;black&#39;,
       &#39;amarican_indian&#39;, &#39;asian&#39;, &#39;hawaiian&#39;, &#39;other&#39;, &#39;sum&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(3221, 11)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">population</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;code == &quot;CO&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">county</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;code == &quot;CO&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">county</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2179691, 6)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>county</th>
      <th>state</th>
      <th>fips</th>
      <th>cases</th>
      <th>deaths</th>
      <th>code</th>
      <th>date</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-21</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>WA</td>
      <td>2020-01-21</td>
    </tr>
    <tr>
      <th>2020-01-22</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>WA</td>
      <td>2020-01-22</td>
    </tr>
    <tr>
      <th>2020-01-23</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>WA</td>
      <td>2020-01-23</td>
    </tr>
    <tr>
      <th>2020-01-24</th>
      <td>Cook</td>
      <td>Illinois</td>
      <td>17031.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>IL</td>
      <td>2020-01-24</td>
    </tr>
    <tr>
      <th>2020-01-24</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>WA</td>
      <td>2020-01-24</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">population</span><span class="p">[[</span><span class="s1">&#39;code&#39;</span><span class="p">,</span><span class="s1">&#39;county&#39;</span><span class="p">,</span><span class="s1">&#39;total_population&#39;</span><span class="p">]],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;county&#39;</span><span class="p">,</span><span class="s1">&#39;code&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(2181095, 8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1312449, 8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pd.merge(df,population[[&#39;code&#39;,&#39;county&#39;,&#39;total_population&#39;]], how=&#39;left&#39;, on=[&#39;county&#39;,&#39;code&#39;])</span>

<span class="n">df_merged</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">population</span><span class="p">[[</span><span class="s1">&#39;code&#39;</span><span class="p">,</span><span class="s1">&#39;county&#39;</span><span class="p">,</span><span class="s1">&#39;total_population&#39;</span><span class="p">]],</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;inner&#39;</span><span class="p">,</span> <span class="n">on</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;county&#39;</span><span class="p">,</span><span class="s1">&#39;code&#39;</span><span class="p">])</span>
<span class="c1">#df.index = df_index</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="answer-when-merging-dataframes">
<h3>Answer when merging DataFrames<a class="headerlink" href="#answer-when-merging-dataframes" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">df_merged</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>

<span class="n">df_merged</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      county       state     fips  cases  deaths code       date  \
0  Snohomish  Washington  53061.0      1     0.0   WA 2020-01-21   
1  Snohomish  Washington  53061.0      1     0.0   WA 2020-01-22   
2  Snohomish  Washington  53061.0      1     0.0   WA 2020-01-23   
3  Snohomish  Washington  53061.0      1     0.0   WA 2020-01-24   
4  Snohomish  Washington  53061.0      1     0.0   WA 2020-01-25   

   total_population  
0            827957  
1            827957  
2            827957  
3            827957  
4            827957  
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>county              0
state               0
fips                0
cases               0
deaths              0
code                0
date                0
total_population    0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_merged</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1312449, 8)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_merged</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;county&#39;, &#39;state&#39;, &#39;fips&#39;, &#39;cases&#39;, &#39;deaths&#39;, &#39;code&#39;, &#39;date&#39;,
       &#39;total_population&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">list</span><span class="p">(</span><span class="n">df_merged</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;county&#39;,
 &#39;state&#39;,
 &#39;fips&#39;,
 &#39;cases&#39;,
 &#39;deaths&#39;,
 &#39;code&#39;,
 &#39;date&#39;,
 &#39;total_population&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_merged</span> <span class="o">=</span> <span class="n">df_merged</span><span class="p">[[</span> <span class="s1">&#39;date&#39;</span><span class="p">,</span><span class="s1">&#39;county&#39;</span><span class="p">,</span> <span class="s1">&#39;code&#39;</span><span class="p">,</span><span class="s1">&#39;state&#39;</span><span class="p">,</span> <span class="s1">&#39;fips&#39;</span><span class="p">,</span> <span class="s1">&#39;cases&#39;</span><span class="p">,</span> <span class="s1">&#39;deaths&#39;</span><span class="p">,</span><span class="s1">&#39;total_population&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_merged</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>county</th>
      <th>code</th>
      <th>state</th>
      <th>fips</th>
      <th>cases</th>
      <th>deaths</th>
      <th>total_population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-01-21</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-01-22</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-01-23</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-01-24</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-01-25</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1312444</th>
      <td>2022-02-21</td>
      <td>Loving</td>
      <td>TX</td>
      <td>Texas</td>
      <td>48301.0</td>
      <td>157</td>
      <td>0.0</td>
      <td>64</td>
    </tr>
    <tr>
      <th>1312445</th>
      <td>2022-02-22</td>
      <td>Loving</td>
      <td>TX</td>
      <td>Texas</td>
      <td>48301.0</td>
      <td>162</td>
      <td>0.0</td>
      <td>64</td>
    </tr>
    <tr>
      <th>1312446</th>
      <td>2022-02-23</td>
      <td>Loving</td>
      <td>TX</td>
      <td>Texas</td>
      <td>48301.0</td>
      <td>163</td>
      <td>0.0</td>
      <td>64</td>
    </tr>
    <tr>
      <th>1312447</th>
      <td>2022-02-24</td>
      <td>Loving</td>
      <td>TX</td>
      <td>Texas</td>
      <td>48301.0</td>
      <td>164</td>
      <td>0.0</td>
      <td>64</td>
    </tr>
    <tr>
      <th>1312448</th>
      <td>2022-02-25</td>
      <td>Loving</td>
      <td>TX</td>
      <td>Texas</td>
      <td>48301.0</td>
      <td>164</td>
      <td>0.0</td>
      <td>64</td>
    </tr>
  </tbody>
</table>
<p>1312449 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">df_merged</span><span class="o">.</span><span class="n">county</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1197
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_merged</span><span class="o">.</span><span class="n">code</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;WA&#39;, &#39;IL&#39;, &#39;CA&#39;, &#39;AZ&#39;, &#39;MA&#39;, &#39;WI&#39;, &#39;TX&#39;, &#39;NE&#39;, &#39;UT&#39;, &#39;FL&#39;, &#39;NC&#39;,
       &#39;NY&#39;, &#39;CO&#39;, &#39;NV&#39;, &#39;GA&#39;, &#39;KY&#39;, &#39;OK&#39;, &#39;PA&#39;, &#39;SC&#39;, &#39;DC&#39;, &#39;MO&#39;, &#39;NH&#39;,
       &#39;OR&#39;, &#39;VA&#39;, &#39;CT&#39;, &#39;IN&#39;, &#39;MD&#39;, &#39;MN&#39;, &#39;NJ&#39;, &#39;IA&#39;, &#39;OH&#39;, &#39;MI&#39;, &#39;SD&#39;,
       &#39;DE&#39;, &#39;NM&#39;, &#39;ND&#39;, &#39;AR&#39;, &#39;KS&#39;, &#39;TN&#39;, &#39;AL&#39;, &#39;ID&#39;, &#39;ME&#39;, &#39;MS&#39;, &#39;MT&#39;,
       &#39;HI&#39;, &#39;VT&#39;, &#39;AK&#39;, &#39;WY&#39;, &#39;WV&#39;, &#39;RI&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_merged</span><span class="o">.</span><span class="n">fips</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([53061., 17031.,  6059., ..., 48269., 32009., 48301.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># check</span>

<span class="n">df_merged</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;state == &quot;Alaska&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">fips</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([2090., 2130., 2122., 2110., 2170., 2290., 2240., 2195., 2050.,
       2198., 2180., 2150., 2220., 2188., 2185., 2070., 2016., 2275.,
       2013., 2100., 2068., 2158.])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;code == &quot;NV&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">county</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>192     Churchill
193         Clark
194       Douglas
195           Elk
196     Esmeralda
197        Eureka
198       Humbold
199        Lander
200        Lincol
201             L
202       Mineral
203           Nye
204      Pershing
205         Store
206        Washoe
207    White Pine
208     Carson Ci
Name: county, dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;code == &quot;AK&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>county</th>
      <th>total_population</th>
      <th>pop_one_race</th>
      <th>white</th>
      <th>black</th>
      <th>amarican_indian</th>
      <th>asian</th>
      <th>hawaiian</th>
      <th>other</th>
      <th>sum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1201</th>
      <td>AK</td>
      <td>Aleutians East Borough</td>
      <td>3420</td>
      <td>3212</td>
      <td>684</td>
      <td>297</td>
      <td>802</td>
      <td>771</td>
      <td>32</td>
      <td>626</td>
      <td>3212</td>
    </tr>
    <tr>
      <th>1202</th>
      <td>AK</td>
      <td>Aleutians West Census Area</td>
      <td>5232</td>
      <td>4858</td>
      <td>1667</td>
      <td>259</td>
      <td>728</td>
      <td>1513</td>
      <td>239</td>
      <td>452</td>
      <td>4858</td>
    </tr>
    <tr>
      <th>1203</th>
      <td>AK</td>
      <td>Anchorage Municipali</td>
      <td>291247</td>
      <td>250445</td>
      <td>164446</td>
      <td>14576</td>
      <td>23661</td>
      <td>27646</td>
      <td>10001</td>
      <td>10115</td>
      <td>250445</td>
    </tr>
    <tr>
      <th>1204</th>
      <td>AK</td>
      <td>Bethel Census Area</td>
      <td>18666</td>
      <td>17650</td>
      <td>1665</td>
      <td>85</td>
      <td>15632</td>
      <td>202</td>
      <td>2</td>
      <td>64</td>
      <td>17650</td>
    </tr>
    <tr>
      <th>1205</th>
      <td>AK</td>
      <td>Bristol Bay Borough</td>
      <td>844</td>
      <td>701</td>
      <td>370</td>
      <td>6</td>
      <td>305</td>
      <td>5</td>
      <td>3</td>
      <td>12</td>
      <td>701</td>
    </tr>
    <tr>
      <th>1206</th>
      <td>AK</td>
      <td>Chugach Census Area</td>
      <td>7102</td>
      <td>6342</td>
      <td>4907</td>
      <td>49</td>
      <td>669</td>
      <td>529</td>
      <td>62</td>
      <td>126</td>
      <td>6342</td>
    </tr>
    <tr>
      <th>1207</th>
      <td>AK</td>
      <td>Copper River Census Area</td>
      <td>2617</td>
      <td>2335</td>
      <td>1611</td>
      <td>8</td>
      <td>663</td>
      <td>17</td>
      <td>10</td>
      <td>26</td>
      <td>2335</td>
    </tr>
    <tr>
      <th>1208</th>
      <td>AK</td>
      <td>Denali Borough</td>
      <td>1619</td>
      <td>1480</td>
      <td>1382</td>
      <td>11</td>
      <td>61</td>
      <td>13</td>
      <td>5</td>
      <td>8</td>
      <td>1480</td>
    </tr>
    <tr>
      <th>1209</th>
      <td>AK</td>
      <td>Dillingham Census Area</td>
      <td>4857</td>
      <td>4361</td>
      <td>799</td>
      <td>25</td>
      <td>3453</td>
      <td>48</td>
      <td>9</td>
      <td>27</td>
      <td>4361</td>
    </tr>
    <tr>
      <th>1210</th>
      <td>AK</td>
      <td>Fairbanks North Star Borough</td>
      <td>95655</td>
      <td>83485</td>
      <td>65971</td>
      <td>4014</td>
      <td>7555</td>
      <td>3104</td>
      <td>604</td>
      <td>2237</td>
      <td>83485</td>
    </tr>
    <tr>
      <th>1211</th>
      <td>AK</td>
      <td>Haines Borough</td>
      <td>2080</td>
      <td>1838</td>
      <td>1589</td>
      <td>2</td>
      <td>214</td>
      <td>14</td>
      <td>2</td>
      <td>17</td>
      <td>1838</td>
    </tr>
    <tr>
      <th>1212</th>
      <td>AK</td>
      <td>Hoonah-Angoon Census Area</td>
      <td>2365</td>
      <td>2081</td>
      <td>1147</td>
      <td>6</td>
      <td>878</td>
      <td>16</td>
      <td>5</td>
      <td>29</td>
      <td>2081</td>
    </tr>
    <tr>
      <th>1213</th>
      <td>AK</td>
      <td>Juneau City and Borough</td>
      <td>32255</td>
      <td>27318</td>
      <td>20124</td>
      <td>350</td>
      <td>3614</td>
      <td>2101</td>
      <td>476</td>
      <td>653</td>
      <td>27318</td>
    </tr>
    <tr>
      <th>1214</th>
      <td>AK</td>
      <td>Kenai Peninsula Borough</td>
      <td>58799</td>
      <td>52811</td>
      <td>46382</td>
      <td>386</td>
      <td>4228</td>
      <td>809</td>
      <td>182</td>
      <td>824</td>
      <td>52811</td>
    </tr>
    <tr>
      <th>1215</th>
      <td>AK</td>
      <td>Ketchikan Gateway Borough</td>
      <td>13948</td>
      <td>12246</td>
      <td>8430</td>
      <td>103</td>
      <td>2334</td>
      <td>1129</td>
      <td>26</td>
      <td>224</td>
      <td>12246</td>
    </tr>
    <tr>
      <th>1216</th>
      <td>AK</td>
      <td>Kodiak Island Borough</td>
      <td>13101</td>
      <td>11794</td>
      <td>6570</td>
      <td>90</td>
      <td>1826</td>
      <td>2803</td>
      <td>117</td>
      <td>388</td>
      <td>11794</td>
    </tr>
    <tr>
      <th>1217</th>
      <td>AK</td>
      <td>Kusilvak Census Area</td>
      <td>8368</td>
      <td>8176</td>
      <td>173</td>
      <td>16</td>
      <td>7946</td>
      <td>23</td>
      <td>0</td>
      <td>18</td>
      <td>8176</td>
    </tr>
    <tr>
      <th>1218</th>
      <td>AK</td>
      <td>Lake and Peninsula Borough</td>
      <td>1476</td>
      <td>1309</td>
      <td>303</td>
      <td>2</td>
      <td>994</td>
      <td>9</td>
      <td>1</td>
      <td>0</td>
      <td>1309</td>
    </tr>
    <tr>
      <th>1219</th>
      <td>AK</td>
      <td>Matanuska-Susitna Borough</td>
      <td>107081</td>
      <td>94782</td>
      <td>83035</td>
      <td>1121</td>
      <td>6844</td>
      <td>1559</td>
      <td>506</td>
      <td>1717</td>
      <td>94782</td>
    </tr>
    <tr>
      <th>1220</th>
      <td>AK</td>
      <td>Nome Census Area</td>
      <td>10046</td>
      <td>9205</td>
      <td>1422</td>
      <td>55</td>
      <td>7556</td>
      <td>111</td>
      <td>5</td>
      <td>56</td>
      <td>9205</td>
    </tr>
    <tr>
      <th>1221</th>
      <td>AK</td>
      <td>North Slope Borough</td>
      <td>11031</td>
      <td>10072</td>
      <td>3082</td>
      <td>162</td>
      <td>5748</td>
      <td>641</td>
      <td>321</td>
      <td>118</td>
      <td>10072</td>
    </tr>
    <tr>
      <th>1222</th>
      <td>AK</td>
      <td>Northwest Arctic Borough</td>
      <td>7793</td>
      <td>7331</td>
      <td>700</td>
      <td>72</td>
      <td>6469</td>
      <td>55</td>
      <td>12</td>
      <td>23</td>
      <td>7331</td>
    </tr>
    <tr>
      <th>1223</th>
      <td>AK</td>
      <td>Petersburg Borough</td>
      <td>3398</td>
      <td>2962</td>
      <td>2470</td>
      <td>49</td>
      <td>247</td>
      <td>123</td>
      <td>12</td>
      <td>61</td>
      <td>2962</td>
    </tr>
    <tr>
      <th>1224</th>
      <td>AK</td>
      <td>Prince of Wales-Hyder Census Area</td>
      <td>5753</td>
      <td>5095</td>
      <td>2403</td>
      <td>22</td>
      <td>2584</td>
      <td>27</td>
      <td>30</td>
      <td>29</td>
      <td>5095</td>
    </tr>
    <tr>
      <th>1225</th>
      <td>AK</td>
      <td>Sitka City and Borough</td>
      <td>8458</td>
      <td>7261</td>
      <td>5174</td>
      <td>37</td>
      <td>1248</td>
      <td>573</td>
      <td>14</td>
      <td>215</td>
      <td>7261</td>
    </tr>
    <tr>
      <th>1226</th>
      <td>AK</td>
      <td>Skagway Municipali</td>
      <td>1240</td>
      <td>1160</td>
      <td>1070</td>
      <td>10</td>
      <td>32</td>
      <td>39</td>
      <td>0</td>
      <td>9</td>
      <td>1160</td>
    </tr>
    <tr>
      <th>1227</th>
      <td>AK</td>
      <td>Southeast Fairbanks Census Area</td>
      <td>6808</td>
      <td>6216</td>
      <td>5085</td>
      <td>74</td>
      <td>817</td>
      <td>87</td>
      <td>16</td>
      <td>137</td>
      <td>6216</td>
    </tr>
    <tr>
      <th>1228</th>
      <td>AK</td>
      <td>Wrangell City and Borough</td>
      <td>2127</td>
      <td>1789</td>
      <td>1352</td>
      <td>0</td>
      <td>380</td>
      <td>25</td>
      <td>2</td>
      <td>30</td>
      <td>1789</td>
    </tr>
    <tr>
      <th>1229</th>
      <td>AK</td>
      <td>Yakutat City and Borough</td>
      <td>662</td>
      <td>544</td>
      <td>249</td>
      <td>4</td>
      <td>255</td>
      <td>32</td>
      <td>1</td>
      <td>3</td>
      <td>544</td>
    </tr>
    <tr>
      <th>1230</th>
      <td>AK</td>
      <td>Yukon-Koyukuk Census Area</td>
      <td>5343</td>
      <td>5008</td>
      <td>1130</td>
      <td>7</td>
      <td>3832</td>
      <td>8</td>
      <td>3</td>
      <td>28</td>
      <td>5008</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;county ==&quot;District of Columbia&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>county</th>
      <th>total_population</th>
      <th>pop_one_race</th>
      <th>white</th>
      <th>black</th>
      <th>amarican_indian</th>
      <th>asian</th>
      <th>hawaiian</th>
      <th>other</th>
      <th>sum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>3081</th>
      <td>DC</td>
      <td>District of Columbia</td>
      <td>689545</td>
      <td>633468</td>
      <td>273194</td>
      <td>285810</td>
      <td>3193</td>
      <td>33545</td>
      <td>432</td>
      <td>37294</td>
      <td>633468</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;code == &quot;NV&quot; &amp; county ==&quot;Carson Ci&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>county</th>
      <th>total_population</th>
      <th>pop_one_race</th>
      <th>white</th>
      <th>black</th>
      <th>amarican_indian</th>
      <th>asian</th>
      <th>hawaiian</th>
      <th>other</th>
      <th>sum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>208</th>
      <td>NV</td>
      <td>Carson Ci</td>
      <td>58639</td>
      <td>51097</td>
      <td>39852</td>
      <td>1142</td>
      <td>1459</td>
      <td>1416</td>
      <td>135</td>
      <td>7093</td>
      <td>51097</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_merged</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;state == &quot;Alaska&quot; &amp; county == &quot;Skagway Municipali&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>county</th>
      <th>code</th>
      <th>state</th>
      <th>fips</th>
      <th>cases</th>
      <th>deaths</th>
      <th>total_population</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_merged</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;fips == 58639.&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>county</th>
      <th>code</th>
      <th>state</th>
      <th>fips</th>
      <th>cases</th>
      <th>deaths</th>
      <th>total_population</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_merged</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;state == &quot;Maryland&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>county</th>
      <th>code</th>
      <th>state</th>
      <th>fips</th>
      <th>cases</th>
      <th>deaths</th>
      <th>total_population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>48069</th>
      <td>2020-03-08</td>
      <td>Harford</td>
      <td>MD</td>
      <td>Maryland</td>
      <td>24025.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>260924</td>
    </tr>
    <tr>
      <th>48070</th>
      <td>2020-03-09</td>
      <td>Harford</td>
      <td>MD</td>
      <td>Maryland</td>
      <td>24025.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>260924</td>
    </tr>
    <tr>
      <th>48071</th>
      <td>2020-03-10</td>
      <td>Harford</td>
      <td>MD</td>
      <td>Maryland</td>
      <td>24025.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>260924</td>
    </tr>
    <tr>
      <th>48072</th>
      <td>2020-03-11</td>
      <td>Harford</td>
      <td>MD</td>
      <td>Maryland</td>
      <td>24025.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>260924</td>
    </tr>
    <tr>
      <th>48073</th>
      <td>2020-03-12</td>
      <td>Harford</td>
      <td>MD</td>
      <td>Maryland</td>
      <td>24025.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>260924</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>48164</th>
      <td>2020-06-11</td>
      <td>Harford</td>
      <td>MD</td>
      <td>Maryland</td>
      <td>24025.0</td>
      <td>993</td>
      <td>57.0</td>
      <td>260924</td>
    </tr>
    <tr>
      <th>48165</th>
      <td>2020-06-12</td>
      <td>Harford</td>
      <td>MD</td>
      <td>Maryland</td>
      <td>24025.0</td>
      <td>994</td>
      <td>58.0</td>
      <td>260924</td>
    </tr>
    <tr>
      <th>48166</th>
      <td>2020-06-13</td>
      <td>Harford</td>
      <td>MD</td>
      <td>Maryland</td>
      <td>24025.0</td>
      <td>1007</td>
      <td>58.0</td>
      <td>260924</td>
    </tr>
    <tr>
      <th>48167</th>
      <td>2020-06-14</td>
      <td>Harford</td>
      <td>MD</td>
      <td>Maryland</td>
      <td>24025.0</td>
      <td>1012</td>
      <td>58.0</td>
      <td>260924</td>
    </tr>
    <tr>
      <th>48168</th>
      <td>2020-06-15</td>
      <td>Harford</td>
      <td>MD</td>
      <td>Maryland</td>
      <td>24025.0</td>
      <td>1022</td>
      <td>58.0</td>
      <td>260924</td>
    </tr>
  </tbody>
</table>
<p>100 rows × 8 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#population.columns</span>
<span class="n">population</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;county == &quot;Cook County&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>county</th>
      <th>total_population</th>
      <th>pop_one_race</th>
      <th>white</th>
      <th>black</th>
      <th>amarican_indian</th>
      <th>asian</th>
      <th>hawaiian</th>
      <th>other</th>
      <th>sum</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">population</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;county == &quot;Cook&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>code</th>
      <th>county</th>
      <th>total_population</th>
      <th>pop_one_race</th>
      <th>white</th>
      <th>black</th>
      <th>amarican_indian</th>
      <th>asian</th>
      <th>hawaiian</th>
      <th>other</th>
      <th>sum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>23</th>
      <td>MN</td>
      <td>Cook</td>
      <td>5600</td>
      <td>5269</td>
      <td>4686</td>
      <td>25</td>
      <td>458</td>
      <td>49</td>
      <td>1</td>
      <td>50</td>
      <td>5269</td>
    </tr>
    <tr>
      <th>510</th>
      <td>GA</td>
      <td>Cook</td>
      <td>17229</td>
      <td>16470</td>
      <td>10975</td>
      <td>4772</td>
      <td>73</td>
      <td>101</td>
      <td>9</td>
      <td>540</td>
      <td>16470</td>
    </tr>
    <tr>
      <th>2353</th>
      <td>IL</td>
      <td>Cook</td>
      <td>5275541</td>
      <td>4728989</td>
      <td>2345983</td>
      <td>1205824</td>
      <td>56894</td>
      <td>413271</td>
      <td>1864</td>
      <td>705153</td>
      <td>4728989</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;county == &quot;Galax city&quot;&#39;</span><span class="p">)</span>
<span class="c1">#df.columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>county</th>
      <th>state</th>
      <th>fips</th>
      <th>cases</th>
      <th>deaths</th>
      <th>code</th>
      <th>date</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-03-27</th>
      <td>Galax city</td>
      <td>Virginia</td>
      <td>51640.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>VA</td>
      <td>2020-03-27</td>
    </tr>
    <tr>
      <th>2020-03-28</th>
      <td>Galax city</td>
      <td>Virginia</td>
      <td>51640.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>VA</td>
      <td>2020-03-28</td>
    </tr>
    <tr>
      <th>2020-03-29</th>
      <td>Galax city</td>
      <td>Virginia</td>
      <td>51640.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>VA</td>
      <td>2020-03-29</td>
    </tr>
    <tr>
      <th>2020-03-30</th>
      <td>Galax city</td>
      <td>Virginia</td>
      <td>51640.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>VA</td>
      <td>2020-03-30</td>
    </tr>
    <tr>
      <th>2020-03-31</th>
      <td>Galax city</td>
      <td>Virginia</td>
      <td>51640.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>VA</td>
      <td>2020-03-31</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2022-02-21</th>
      <td>Galax city</td>
      <td>Virginia</td>
      <td>51640.0</td>
      <td>2498</td>
      <td>72.0</td>
      <td>VA</td>
      <td>2022-02-21</td>
    </tr>
    <tr>
      <th>2022-02-22</th>
      <td>Galax city</td>
      <td>Virginia</td>
      <td>51640.0</td>
      <td>2499</td>
      <td>72.0</td>
      <td>VA</td>
      <td>2022-02-22</td>
    </tr>
    <tr>
      <th>2022-02-23</th>
      <td>Galax city</td>
      <td>Virginia</td>
      <td>51640.0</td>
      <td>2506</td>
      <td>72.0</td>
      <td>VA</td>
      <td>2022-02-23</td>
    </tr>
    <tr>
      <th>2022-02-24</th>
      <td>Galax city</td>
      <td>Virginia</td>
      <td>51640.0</td>
      <td>2515</td>
      <td>74.0</td>
      <td>VA</td>
      <td>2022-02-24</td>
    </tr>
    <tr>
      <th>2022-02-25</th>
      <td>Galax city</td>
      <td>Virginia</td>
      <td>51640.0</td>
      <td>2518</td>
      <td>75.0</td>
      <td>VA</td>
      <td>2022-02-25</td>
    </tr>
  </tbody>
</table>
<p>701 rows × 7 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_merged</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;state == &quot;Virginia&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">county</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Fairfax&#39;, &#39;Hanover&#39;, &#39;Prince Edward&#39;, &#39;Prince William&#39;,
       &#39;Chesterfield&#39;, &#39;Spotsylvania&#39;, &#39;Stafford&#39;, &#39;York&#39;, &#39;Goochland&#39;,
       &#39;Accomack&#39;, &#39;Gloucester&#39;, &#39;Albemarle&#39;, &#39;Mecklenburg&#39;, &#39;Bedford&#39;,
       &#39;Culpeper&#39;, &#39;Fluvanna&#39;, &#39;Lee&#39;, &#39;Louisa&#39;, &#39;Rockingham&#39;,
       &#39;Rockbridge&#39;, &#39;Halifax&#39;, &#39;Frederick&#39;, &#39;Mathews&#39;, &#39;Orange&#39;,
       &#39;Roanoke&#39;, &#39;Shenandoah&#39;, &#39;Amelia&#39;, &#39;Fauquier&#39;, &#39;Greene&#39;,
       &#39;King George&#39;, &#39;Pittsylvania&#39;, &#39;Prince George&#39;, &#39;Lancaster&#39;,
       &#39;Northumberland&#39;, &#39;Greensville&#39;, &#39;Tazewell&#39;, &#39;Wythe&#39;,
       &#39;King William&#39;, &#39;Smyth&#39;, &#39;Brunswick&#39;, &#39;Buckingham&#39;, &#39;Campbell&#39;,
       &#39;Carroll&#39;, &#39;Clarke&#39;, &#39;Page&#39;, &#39;Augusta&#39;, &#39;Sussex&#39;, &#39;Cumberland&#39;,
       &#39;Caroline&#39;, &#39;Pulaski&#39;, &#39;Richmond&#39;, &#39;Westmoreland&#39;, &#39;Wise&#39;,
       &#39;Charlotte&#39;, &#39;Appomattox&#39;, &#39;Giles&#39;, &#39;Russell&#39;, &#39;Craig&#39;,
       &#39;Dinwiddie&#39;, &#39;Lunenburg&#39;, &#39;Rappahannock&#39;, &#39;Floyd&#39;, &#39;Middlesex&#39;,
       &#39;Essex&#39;, &#39;Patrick&#39;, &#39;Highland&#39;, &#39;Bland&#39;, &#39;Bath&#39;], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_merged</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;code == &quot;CT&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>county</th>
      <th>code</th>
      <th>state</th>
      <th>fips</th>
      <th>cases</th>
      <th>deaths</th>
      <th>total_population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>45909</th>
      <td>2020-03-08</td>
      <td>Fairfield</td>
      <td>CT</td>
      <td>Connecticut</td>
      <td>9001.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>957419</td>
    </tr>
    <tr>
      <th>45910</th>
      <td>2020-03-09</td>
      <td>Fairfield</td>
      <td>CT</td>
      <td>Connecticut</td>
      <td>9001.0</td>
      <td>2</td>
      <td>0.0</td>
      <td>957419</td>
    </tr>
    <tr>
      <th>45911</th>
      <td>2020-03-10</td>
      <td>Fairfield</td>
      <td>CT</td>
      <td>Connecticut</td>
      <td>9001.0</td>
      <td>2</td>
      <td>0.0</td>
      <td>957419</td>
    </tr>
    <tr>
      <th>45912</th>
      <td>2020-03-11</td>
      <td>Fairfield</td>
      <td>CT</td>
      <td>Connecticut</td>
      <td>9001.0</td>
      <td>3</td>
      <td>0.0</td>
      <td>957419</td>
    </tr>
    <tr>
      <th>45913</th>
      <td>2020-03-12</td>
      <td>Fairfield</td>
      <td>CT</td>
      <td>Connecticut</td>
      <td>9001.0</td>
      <td>5</td>
      <td>0.0</td>
      <td>957419</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_merged</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="s1">&#39;/Users/Kaemyuijang/SCMA248/Data/US_covid19_part2.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/Users/Kaemyuijang/SCMA248/Data/US_covid19_part2.csv&#39;</span>

<span class="n">final</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">index_col</span> <span class="o">=</span> <span class="s1">&#39;date&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">final</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Unnamed: 0          0
county              0
code                0
state               0
fips                0
cases               0
deaths              0
total_population    0
dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="working-on-the-merged-dataframe">
<h3>Working on the merged DataFrame<a class="headerlink" href="#working-on-the-merged-dataframe" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">df_merged</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">set_index</span><span class="p">(</span><span class="s1">&#39;date&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>county</th>
      <th>code</th>
      <th>state</th>
      <th>fips</th>
      <th>cases</th>
      <th>deaths</th>
      <th>total_population</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2020-01-21</th>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>2020-01-22</th>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>2020-01-23</th>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>2020-01-24</th>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>2020-01-25</th>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2022-02-21</th>
      <td>Loving</td>
      <td>TX</td>
      <td>Texas</td>
      <td>48301.0</td>
      <td>157</td>
      <td>0.0</td>
      <td>64</td>
    </tr>
    <tr>
      <th>2022-02-22</th>
      <td>Loving</td>
      <td>TX</td>
      <td>Texas</td>
      <td>48301.0</td>
      <td>162</td>
      <td>0.0</td>
      <td>64</td>
    </tr>
    <tr>
      <th>2022-02-23</th>
      <td>Loving</td>
      <td>TX</td>
      <td>Texas</td>
      <td>48301.0</td>
      <td>163</td>
      <td>0.0</td>
      <td>64</td>
    </tr>
    <tr>
      <th>2022-02-24</th>
      <td>Loving</td>
      <td>TX</td>
      <td>Texas</td>
      <td>48301.0</td>
      <td>164</td>
      <td>0.0</td>
      <td>64</td>
    </tr>
    <tr>
      <th>2022-02-25</th>
      <td>Loving</td>
      <td>TX</td>
      <td>Texas</td>
      <td>48301.0</td>
      <td>164</td>
      <td>0.0</td>
      <td>64</td>
    </tr>
  </tbody>
</table>
<p>1312449 rows × 7 columns</p>
</div></div></div>
</div>
<p>Q: Write Python to check for NaN values after adding ‘total_population’ to the Covid-19 dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>date                0
county              0
code                0
state               0
fips                0
cases               0
deaths              0
total_population    0
dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>county</th>
      <th>code</th>
      <th>state</th>
      <th>fips</th>
      <th>cases</th>
      <th>deaths</th>
      <th>total_population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-01-21</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-01-22</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-01-23</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-01-24</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-01-25</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;code == &quot;CA&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">county</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>35
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
Int64Index: 1312449 entries, 0 to 1312448
Data columns (total 8 columns):
 #   Column            Non-Null Count    Dtype         
---  ------            --------------    -----         
 0   date              1312449 non-null  datetime64[ns]
 1   county            1312449 non-null  object        
 2   code              1312449 non-null  object        
 3   state             1312449 non-null  object        
 4   fips              1312449 non-null  float64       
 5   cases             1312449 non-null  int64         
 6   deaths            1312449 non-null  float64       
 7   total_population  1312449 non-null  int64         
dtypes: datetime64[ns](1), float64(2), int64(2), object(3)
memory usage: 90.1+ MB
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Int64Index([      0,       1,       2,       3,       4,       5,       6,
                  7,       8,       9,
            ...
            1312439, 1312440, 1312441, 1312442, 1312443, 1312444, 1312445,
            1312446, 1312447, 1312448],
           dtype=&#39;int64&#39;, length=1312449)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_Snohomish</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;county == &quot;Snohomish&quot;&#39;</span><span class="p">)</span>


<span class="n">df_Snohomish</span><span class="p">[</span><span class="s1">&#39;lag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_Snohomish</span><span class="o">.</span><span class="n">cases</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df_Snohomish</span><span class="p">[</span><span class="s1">&#39;daily_cases&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_Snohomish</span><span class="o">.</span><span class="n">cases</span> <span class="o">-</span> <span class="n">df_Snohomish</span><span class="o">.</span><span class="n">lag</span>

<span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df_Snohomish</span><span class="p">)</span> 
    <span class="o">+</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">df_Snohomish</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;cases&#39;</span><span class="p">)</span> 
    <span class="o">+</span> <span class="n">geom_line</span><span class="p">()</span> 
    <span class="o">+</span> <span class="n">theme</span><span class="p">(</span><span class="n">axis_text_x</span><span class="o">=</span><span class="n">element_text</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">hjust</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> 
    <span class="o">+</span> <span class="n">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Cases&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Total Coronavirus Cases&quot;</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span><span class="s2">&quot;Total Coronavirus Cases in Snohomish&quot;</span><span class="p">)</span>
<span class="p">)</span>

<span class="c1">#print(df_Snohomish.tail(10))</span>

<span class="c1">#df_Snohomish.query(&#39;daily_cases&lt;0&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Midterm_for_Marking-Q11_Using_total_pop_167_0.png" src="../_images/Midterm_for_Marking-Q11_Using_total_pop_167_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (311076877)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df_Snohomish</span><span class="p">)</span> 
    <span class="o">+</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">df_Snohomish</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;cases&#39;</span><span class="p">)</span> 
    <span class="o">+</span> <span class="n">geom_line</span><span class="p">()</span> 
    <span class="o">+</span> <span class="n">theme</span><span class="p">(</span><span class="n">axis_text_x</span><span class="o">=</span><span class="n">element_text</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">hjust</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> 
    <span class="o">+</span> <span class="n">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Cases&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;Total Coronavirus Cases&quot;</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span><span class="s2">&quot;Total Coronavirus Cases in Snohomish </span><span class="se">\n</span><span class="s2"> (logarithmic scale)&quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">scale_y_continuous</span><span class="p">(</span><span class="n">trans</span> <span class="o">=</span> <span class="s2">&quot;log10&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Midterm_for_Marking-Q11_Using_total_pop_168_0.png" src="../_images/Midterm_for_Marking-Q11_Using_total_pop_168_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (298562257)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df_Snohomish</span><span class="p">)</span> 
    <span class="o">+</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">df_Snohomish</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;daily_cases&#39;</span><span class="p">)</span> 
    <span class="o">+</span> <span class="n">geom_line</span><span class="p">()</span> 
    <span class="o">+</span> <span class="n">theme</span><span class="p">(</span><span class="n">axis_text_x</span><span class="o">=</span><span class="n">element_text</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">hjust</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> 
    <span class="o">+</span> <span class="n">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;Cases&quot;</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s2">&quot;New Coronavirus Daily Cases&quot;</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span><span class="s2">&quot;Daily New Cases in Snohomish&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Midterm_for_Marking-Q11_Using_total_pop_169_0.png" src="../_images/Midterm_for_Marking-Q11_Using_total_pop_169_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (311083657)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_Snohomish</span><span class="o">.</span><span class="n">daily_cases</span><span class="p">[</span><span class="n">df_Snohomish</span><span class="o">.</span><span class="n">daily_cases</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>67       -1.0
138      -1.0
755   -1870.0
757    -499.0
759    -159.0
Name: daily_cases, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_Snohomish</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2022-02-01&#39;</span><span class="p">:</span><span class="s1">&#39;2022-02-18&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>county</th>
      <th>code</th>
      <th>state</th>
      <th>fips</th>
      <th>cases</th>
      <th>deaths</th>
      <th>total_population</th>
      <th>lag</th>
      <th>daily_cases</th>
    </tr>
  </thead>
  <tbody>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;state==&quot;Washington&quot;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>county</th>
      <th>code</th>
      <th>state</th>
      <th>fips</th>
      <th>cases</th>
      <th>deaths</th>
      <th>total_population</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-01-21</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-01-22</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-01-23</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2020-01-24</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-01-25</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2020-01-26</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>6</th>
      <td>2020-01-27</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2020-01-28</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>8</th>
      <td>2020-01-29</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>9</th>
      <td>2020-01-30</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>10</th>
      <td>2020-01-31</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2020-02-01</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>12</th>
      <td>2020-02-02</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>13</th>
      <td>2020-02-03</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2020-02-04</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>15</th>
      <td>2020-02-05</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2020-02-06</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>17</th>
      <td>2020-02-07</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>18</th>
      <td>2020-02-08</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
    <tr>
      <th>19</th>
      <td>2020-02-09</td>
      <td>Snohomish</td>
      <td>WA</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>827957</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="s1">&#39;/Users/Kaemyuijang/SCMA248/Data/us-counties.csv&#39;</span>

<span class="c1">#df = pd.read_csv(path, parse_dates=True, index_col = &#39;date&#39;)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_Snohomish</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;county == &quot;Snohomish&quot;&#39;</span><span class="p">)</span>

<span class="n">df_Snohomish</span><span class="p">[</span><span class="s1">&#39;lag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_Snohomish</span><span class="o">.</span><span class="n">cases</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df_Snohomish</span><span class="p">[</span><span class="s1">&#39;daily_cases&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_Snohomish</span><span class="o">.</span><span class="n">cases</span> <span class="o">-</span> <span class="n">df_Snohomish</span><span class="o">.</span><span class="n">lag</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_merge</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">df</span><span class="p">,</span><span class="n">df_Snohomish</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">,</span><span class="s1">&#39;county&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pd_merge</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;county == &quot;Snohomish&quot;&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>county</th>
      <th>state_x</th>
      <th>fips_x</th>
      <th>cases_x</th>
      <th>deaths_x</th>
      <th>state_y</th>
      <th>fips_y</th>
      <th>cases_y</th>
      <th>deaths_y</th>
      <th>lag</th>
      <th>daily_cases</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2020-01-21</td>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2020-01-22</td>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-01-23</td>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2020-01-24</td>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>2020-01-25</td>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1</td>
      <td>0.0</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2239078</th>
      <td>2022-02-21</td>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>145694</td>
      <td>1034.0</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>145694.0</td>
      <td>1034.0</td>
      <td>145694.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2242330</th>
      <td>2022-02-22</td>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>145694</td>
      <td>1034.0</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>145694.0</td>
      <td>1034.0</td>
      <td>145694.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2245582</th>
      <td>2022-02-23</td>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>146253</td>
      <td>1046.0</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>146253.0</td>
      <td>1046.0</td>
      <td>145694.0</td>
      <td>559.0</td>
    </tr>
    <tr>
      <th>2248834</th>
      <td>2022-02-24</td>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>146253</td>
      <td>1046.0</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>146253.0</td>
      <td>1046.0</td>
      <td>146253.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>2252086</th>
      <td>2022-02-25</td>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>146553</td>
      <td>1054.0</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>146553.0</td>
      <td>1054.0</td>
      <td>146253.0</td>
      <td>300.0</td>
    </tr>
  </tbody>
</table>
<p>767 rows × 12 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline 
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span> <span class="n">index_col</span> <span class="o">=</span> <span class="s1">&#39;date&#39;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;county in [&quot;Snohomish&quot;,&quot;Cook&quot;]&#39;</span><span class="p">)</span>
<span class="c1">#df = df.query(&#39;county in [&quot;Snohomish&quot;]&#39;)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="s1">&#39;2022-02-01&#39;</span><span class="p">:</span><span class="s1">&#39;2022-02-18&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>county</th>
      <th>state</th>
      <th>fips</th>
      <th>cases</th>
      <th>deaths</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022-02-01</th>
      <td>Cook</td>
      <td>Georgia</td>
      <td>13075.0</td>
      <td>4744</td>
      <td>66.0</td>
    </tr>
    <tr>
      <th>2022-02-01</th>
      <td>Cook</td>
      <td>Illinois</td>
      <td>17031.0</td>
      <td>1082395</td>
      <td>13970.0</td>
    </tr>
    <tr>
      <th>2022-02-01</th>
      <td>Cook</td>
      <td>Minnesota</td>
      <td>27031.0</td>
      <td>507</td>
      <td>2.0</td>
    </tr>
    <tr>
      <th>2022-02-01</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>139881</td>
      <td>948.0</td>
    </tr>
    <tr>
      <th>2022-02-02</th>
      <td>Cook</td>
      <td>Georgia</td>
      <td>13075.0</td>
      <td>4764</td>
      <td>66.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>2022-02-17</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>145853</td>
      <td>1018.0</td>
    </tr>
    <tr>
      <th>2022-02-18</th>
      <td>Cook</td>
      <td>Georgia</td>
      <td>13075.0</td>
      <td>4855</td>
      <td>68.0</td>
    </tr>
    <tr>
      <th>2022-02-18</th>
      <td>Cook</td>
      <td>Illinois</td>
      <td>17031.0</td>
      <td>1105263</td>
      <td>14439.0</td>
    </tr>
    <tr>
      <th>2022-02-18</th>
      <td>Cook</td>
      <td>Minnesota</td>
      <td>27031.0</td>
      <td>533</td>
      <td>4.0</td>
    </tr>
    <tr>
      <th>2022-02-18</th>
      <td>Snohomish</td>
      <td>Washington</td>
      <td>53061.0</td>
      <td>145694</td>
      <td>1034.0</td>
    </tr>
  </tbody>
</table>
<p>72 rows × 5 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://stackoverflow.com/questions/20625582/how-to-deal-with-settingwithcopywarning-in-pandas</span>

<span class="n">pd</span><span class="o">.</span><span class="n">options</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">chained_assignment</span> <span class="o">=</span> <span class="kc">None</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;fips&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;fips == @id&#39;</span><span class="p">)</span>
    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;lag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">cases</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;daily_cases&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">cases</span> <span class="o">-</span> <span class="n">temp</span><span class="o">.</span><span class="n">lag</span>
    <span class="n">temp</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lag&#39;</span><span class="p">],</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    <span class="c1">#print(temp)</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">temp</span><span class="o">.</span><span class="n">index</span><span class="p">,</span><span class="n">temp</span><span class="o">.</span><span class="n">daily_cases</span><span class="p">)</span>
    <span class="c1">#print(temp.query(&#39;county == @ct&#39;))</span>
    <span class="c1">#df_new = pd.concat([df_new,temp])</span>
    
    <span class="c1">#print(temp)</span>
    <span class="c1">#df = pd.merge(df,temp, how = &#39;left&#39;, on =  [&#39;date&#39;,&#39;county&#39;,&#39;state&#39;,&#39;fips&#39;,&#39;cases&#39;,&#39;deaths&#39;])</span>
    <span class="c1">#df.drop(columns=[&#39;lag&#39;], inplace = True)</span>
    <span class="c1">#print(df.columns)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>53061.0
17031.0
13075.0
27031.0
</pre></div>
</div>
<img alt="../_images/Midterm_for_Marking-Q11_Using_total_pop_185_1.png" src="../_images/Midterm_for_Marking-Q11_Using_total_pop_185_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># subplots_adjust ignores hspace, wspace #185</span>
<span class="c1"># https://github.com/has2k1/plotnine/issues/185</span>

<span class="n">df_new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;fips&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;fips == @id&#39;</span><span class="p">)</span>
    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;lag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">cases</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;daily_cases&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">cases</span> <span class="o">-</span> <span class="n">temp</span><span class="o">.</span><span class="n">lag</span>
    <span class="n">temp</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lag&#39;</span><span class="p">],</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    
    <span class="n">rolling</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">daily_cases</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1">#print(rolling.mean().shape)</span>
    <span class="c1">#print(temp.shape)</span>
    
    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;rolling_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rolling</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="c1">#print(temp)</span>
    
    <span class="n">df_new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_new</span><span class="p">,</span><span class="n">temp</span><span class="p">])</span>
    
    <span class="c1">#print(temp)</span>
    <span class="c1">#df = pd.merge(df,temp, how = &#39;left&#39;, on =  [&#39;date&#39;,&#39;county&#39;,&#39;state&#39;,&#39;fips&#39;,&#39;cases&#39;,&#39;deaths&#39;])</span>
    <span class="c1">#df.drop(columns=[&#39;lag&#39;], inplace = True)</span>
    <span class="c1">#print(df.columns)</span>

<span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df_new</span><span class="p">)</span> <span class="o">+</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">df_new</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;daily_cases&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">geom_line</span><span class="p">()</span> <span class="o">+</span>    
    <span class="n">theme</span><span class="p">(</span><span class="n">axis_text_x</span><span class="o">=</span><span class="n">element_text</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">hjust</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> 
    <span class="c1">#facet_grid(&#39;~fips&#39;, scales = &quot;free_y&quot;)</span>
    <span class="n">facet_wrap</span><span class="p">(</span><span class="s1">&#39;fips&#39;</span><span class="p">,</span> <span class="n">scales</span> <span class="o">=</span> <span class="s2">&quot;free_y&quot;</span><span class="p">)</span> <span class="o">+</span>
    <span class="n">theme</span><span class="p">(</span><span class="n">subplots_adjust</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;wspace&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span><span class="s1">&#39;hspace&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">})</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>53061.0
17031.0
13075.0
27031.0
</pre></div>
</div>
<img alt="../_images/Midterm_for_Marking-Q11_Using_total_pop_186_1.png" src="../_images/Midterm_for_Marking-Q11_Using_total_pop_186_1.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (310984517)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_new</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df_new</span><span class="p">[</span><span class="s1">&#39;fips&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mf">13075.</span><span class="p">][</span><span class="s1">&#39;2022-02-01&#39;</span><span class="p">:</span><span class="s1">&#39;2022-02-18&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>county</th>
      <th>state</th>
      <th>fips</th>
      <th>cases</th>
      <th>deaths</th>
      <th>daily_cases</th>
      <th>rolling_mean</th>
    </tr>
    <tr>
      <th>date</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2022-02-01</th>
      <td>Cook</td>
      <td>Georgia</td>
      <td>13075.0</td>
      <td>4744</td>
      <td>66.0</td>
      <td>25.0</td>
      <td>16.428571</td>
    </tr>
    <tr>
      <th>2022-02-02</th>
      <td>Cook</td>
      <td>Georgia</td>
      <td>13075.0</td>
      <td>4764</td>
      <td>66.0</td>
      <td>20.0</td>
      <td>16.428571</td>
    </tr>
    <tr>
      <th>2022-02-03</th>
      <td>Cook</td>
      <td>Georgia</td>
      <td>13075.0</td>
      <td>4778</td>
      <td>66.0</td>
      <td>14.0</td>
      <td>16.428571</td>
    </tr>
    <tr>
      <th>2022-02-04</th>
      <td>Cook</td>
      <td>Georgia</td>
      <td>13075.0</td>
      <td>4787</td>
      <td>66.0</td>
      <td>9.0</td>
      <td>13.285714</td>
    </tr>
    <tr>
      <th>2022-02-05</th>
      <td>Cook</td>
      <td>Georgia</td>
      <td>13075.0</td>
      <td>4787</td>
      <td>66.0</td>
      <td>0.0</td>
      <td>11.285714</td>
    </tr>
    <tr>
      <th>2022-02-06</th>
      <td>Cook</td>
      <td>Georgia</td>
      <td>13075.0</td>
      <td>4787</td>
      <td>66.0</td>
      <td>0.0</td>
      <td>9.142857</td>
    </tr>
    <tr>
      <th>2022-02-07</th>
      <td>Cook</td>
      <td>Georgia</td>
      <td>13075.0</td>
      <td>4812</td>
      <td>67.0</td>
      <td>25.0</td>
      <td>8.428571</td>
    </tr>
    <tr>
      <th>2022-02-08</th>
      <td>Cook</td>
      <td>Georgia</td>
      <td>13075.0</td>
      <td>4823</td>
      <td>67.0</td>
      <td>11.0</td>
      <td>8.142857</td>
    </tr>
    <tr>
      <th>2022-02-09</th>
      <td>Cook</td>
      <td>Georgia</td>
      <td>13075.0</td>
      <td>4828</td>
      <td>67.0</td>
      <td>5.0</td>
      <td>8.142857</td>
    </tr>
    <tr>
      <th>2022-02-10</th>
      <td>Cook</td>
      <td>Georgia</td>
      <td>13075.0</td>
      <td>4837</td>
      <td>67.0</td>
      <td>9.0</td>
      <td>8.142857</td>
    </tr>
    <tr>
      <th>2022-02-11</th>
      <td>Cook</td>
      <td>Georgia</td>
      <td>13075.0</td>
      <td>4844</td>
      <td>67.0</td>
      <td>7.0</td>
      <td>5.571429</td>
    </tr>
    <tr>
      <th>2022-02-12</th>
      <td>Cook</td>
      <td>Georgia</td>
      <td>13075.0</td>
      <td>4844</td>
      <td>67.0</td>
      <td>0.0</td>
      <td>4.142857</td>
    </tr>
    <tr>
      <th>2022-02-13</th>
      <td>Cook</td>
      <td>Georgia</td>
      <td>13075.0</td>
      <td>4844</td>
      <td>67.0</td>
      <td>0.0</td>
      <td>4.000000</td>
    </tr>
    <tr>
      <th>2022-02-14</th>
      <td>Cook</td>
      <td>Georgia</td>
      <td>13075.0</td>
      <td>4851</td>
      <td>68.0</td>
      <td>7.0</td>
      <td>2.714286</td>
    </tr>
    <tr>
      <th>2022-02-15</th>
      <td>Cook</td>
      <td>Georgia</td>
      <td>13075.0</td>
      <td>4852</td>
      <td>68.0</td>
      <td>1.0</td>
      <td>1.571429</td>
    </tr>
    <tr>
      <th>2022-02-16</th>
      <td>Cook</td>
      <td>Georgia</td>
      <td>13075.0</td>
      <td>4856</td>
      <td>68.0</td>
      <td>4.0</td>
      <td>1.571429</td>
    </tr>
    <tr>
      <th>2022-02-17</th>
      <td>Cook</td>
      <td>Georgia</td>
      <td>13075.0</td>
      <td>4856</td>
      <td>68.0</td>
      <td>0.0</td>
      <td>1.571429</td>
    </tr>
    <tr>
      <th>2022-02-18</th>
      <td>Cook</td>
      <td>Georgia</td>
      <td>13075.0</td>
      <td>4855</td>
      <td>68.0</td>
      <td>-1.0</td>
      <td>1.142857</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#df_new13075 = df_new.loc[df_new[&#39;fips&#39;] == 13075.][&#39;2021-07-01&#39;:&#39;2022-02-18&#39;]</span>

<span class="n">df_new13075</span> <span class="o">=</span> <span class="n">df_new</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;fips == 13075.&#39;</span><span class="p">)</span>
<span class="c1">#print(df_new13075.head(10))</span>
<span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df_new13075</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;fips == 13075.&#39;</span><span class="p">))</span> <span class="o">+</span>
    <span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">df_new13075</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;daily_cases&#39;</span><span class="p">),</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">+</span>
    <span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">df_new13075</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;rolling_mean&#39;</span><span class="p">),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span> <span class="o">+</span>
        <span class="n">theme</span><span class="p">(</span><span class="n">axis_text_x</span><span class="o">=</span><span class="n">element_text</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">hjust</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> 
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/Kaemyuijang/opt/anaconda3/lib/python3.7/site-packages/plotnine/geoms/geom_path.py:75: PlotnineWarning: geom_path: Removed 6 rows containing missing values.
</pre></div>
</div>
<img alt="../_images/Midterm_for_Marking-Q11_Using_total_pop_188_1.png" src="../_images/Midterm_for_Marking-Q11_Using_total_pop_188_1.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (314573565)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_new17031</span> <span class="o">=</span> <span class="n">df_new</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;fips == 17031.&#39;</span><span class="p">)</span>

<span class="n">ggplot</span><span class="p">(</span><span class="n">df_new17031</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;fips == 17031.&#39;</span><span class="p">))</span> <span class="o">+</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">df_new17031</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;daily_cases&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">geom_line</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Midterm_for_Marking-Q11_Using_total_pop_189_0.png" src="../_images/Midterm_for_Marking-Q11_Using_total_pop_189_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (314735525)&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="query-by-state">
<h3>Query by state<a class="headerlink" href="#query-by-state" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;date&#39;</span><span class="p">],</span> <span class="n">index_col</span> <span class="o">=</span> <span class="s1">&#39;date&#39;</span><span class="p">)</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;state in [&quot;Washington&quot;]&#39;</span><span class="p">)</span>
<span class="c1">#df = df.query(&#39;county in [&quot;Snohomish&quot;]&#39;)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">county</span><span class="o">.</span><span class="n">unique</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;Snohomish&#39; &#39;Spokane&#39; &#39;King&#39; &#39;Walla Walla&#39; &#39;Chelan&#39; &#39;Clark&#39; &#39;Jefferson&#39;
 &#39;Pierce&#39; &#39;Kittitas&#39; &#39;Kitsap&#39; &#39;Skagit&#39; &#39;Whatcom&#39; &#39;Island&#39; &#39;Thurston&#39;
 &#39;Columbia&#39; &#39;Grays Harbor&#39; &#39;Yakima&#39; &#39;Grant&#39; &#39;Klickitat&#39; &#39;Lewis&#39; &#39;Lincoln&#39;
 &#39;Franklin&#39; &#39;Mason&#39; &#39;Benton&#39; &#39;Clallam&#39; &#39;Cowlitz&#39; &#39;San Juan&#39; &#39;Stevens&#39;
 &#39;Whitman&#39; &#39;Adams&#39; &#39;Douglas&#39; &#39;Unknown&#39; &#39;Ferry&#39; &#39;Okanogan&#39; &#39;Skamania&#39;
 &#39;Pend Oreille&#39; &#39;Asotin&#39; &#39;Wahkiakum&#39; &#39;Pacific&#39; &#39;Garfield&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

<span class="k">for</span> <span class="nb">id</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;fips&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="nb">id</span><span class="p">)</span>
    <span class="n">temp</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;fips == @id&#39;</span><span class="p">)</span>
    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;lag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">cases</span><span class="o">.</span><span class="n">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;daily_cases&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">cases</span> <span class="o">-</span> <span class="n">temp</span><span class="o">.</span><span class="n">lag</span>
    <span class="n">temp</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;lag&#39;</span><span class="p">],</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
    
    <span class="n">rolling</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">daily_cases</span><span class="o">.</span><span class="n">rolling</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1">#print(rolling.mean().shape)</span>
    <span class="c1">#print(temp.shape)</span>
    
    <span class="n">temp</span><span class="p">[</span><span class="s1">&#39;rolling_mean&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">rolling</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="c1">#print(temp)</span>
    
    <span class="n">df_new</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_new</span><span class="p">,</span><span class="n">temp</span><span class="p">])</span>
    
    <span class="c1">#print(temp)</span>
    <span class="c1">#df = pd.merge(df,temp, how = &#39;left&#39;, on =  [&#39;date&#39;,&#39;county&#39;,&#39;state&#39;,&#39;fips&#39;,&#39;cases&#39;,&#39;deaths&#39;])</span>
    <span class="c1">#df.drop(columns=[&#39;lag&#39;], inplace = True)</span>
    <span class="c1">#print(df.columns)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>53061.0
53063.0
53033.0
53071.0
53007.0
53011.0
53031.0
53053.0
53037.0
53035.0
53057.0
53073.0
53029.0
53067.0
53013.0
53027.0
53077.0
53025.0
53039.0
53041.0
53043.0
53021.0
53045.0
53005.0
53009.0
53015.0
53055.0
53065.0
53075.0
53001.0
53017.0
nan
53019.0
53047.0
53059.0
53051.0
53003.0
53069.0
53049.0
53023.0
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_new</span><span class="o">.</span><span class="n">county</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([&#39;Snohomish&#39;, &#39;Spokane&#39;, &#39;King&#39;, &#39;Walla Walla&#39;, &#39;Chelan&#39;, &#39;Clark&#39;,
       &#39;Jefferson&#39;, &#39;Pierce&#39;, &#39;Kittitas&#39;, &#39;Kitsap&#39;, &#39;Skagit&#39;, &#39;Whatcom&#39;,
       &#39;Island&#39;, &#39;Thurston&#39;, &#39;Columbia&#39;, &#39;Grays Harbor&#39;, &#39;Yakima&#39;,
       &#39;Grant&#39;, &#39;Klickitat&#39;, &#39;Lewis&#39;, &#39;Lincoln&#39;, &#39;Franklin&#39;, &#39;Mason&#39;,
       &#39;Benton&#39;, &#39;Clallam&#39;, &#39;Cowlitz&#39;, &#39;San Juan&#39;, &#39;Stevens&#39;, &#39;Whitman&#39;,
       &#39;Adams&#39;, &#39;Douglas&#39;, &#39;Ferry&#39;, &#39;Okanogan&#39;, &#39;Skamania&#39;,
       &#39;Pend Oreille&#39;, &#39;Asotin&#39;, &#39;Wahkiakum&#39;, &#39;Pacific&#39;, &#39;Garfield&#39;],
      dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fips_list</span> <span class="o">=</span> <span class="p">[</span><span class="mf">53001.</span><span class="p">,</span> <span class="mf">53003.</span><span class="p">]</span>

<span class="n">df_subset</span> <span class="o">=</span> <span class="n">df_new</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;fips in @fips_list&#39;</span><span class="p">)</span>

<span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df_subset</span><span class="p">)</span> <span class="o">+</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">df_subset</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;daily_cases&#39;</span><span class="p">)</span> <span class="o">+</span> 
    <span class="n">geom_line</span><span class="p">()</span> <span class="o">+</span>    
    <span class="n">theme</span><span class="p">(</span><span class="n">axis_text_x</span><span class="o">=</span><span class="n">element_text</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">hjust</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span> 
    <span class="n">facet_wrap</span><span class="p">(</span><span class="s1">&#39;fips&#39;</span><span class="p">,</span> <span class="n">nrow</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span>
    <span class="n">theme</span><span class="p">(</span><span class="n">subplots_adjust</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;wspace&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span><span class="s1">&#39;hspace&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">})</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Midterm_for_Marking-Q11_Using_total_pop_195_0.png" src="../_images/Midterm_for_Marking-Q11_Using_total_pop_195_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (328691209)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#(</span>
<span class="c1">#    ggplot(df_new) + aes(x = df_new.index, y = &#39;daily_cases&#39;) + geom_line() +    </span>
<span class="c1">#    theme(axis_text_x=element_text(rotation=90, hjust=1)) + </span>
<span class="c1">#    facet_wrap(&#39;fips&#39;, nrow = 15, ncol = 3) +</span>
<span class="c1">#    theme(subplots_adjust={&#39;wspace&#39;: 0.5,&#39;hspace&#39;: 0.2})</span>
<span class="c1">#)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_subset</span> <span class="o">=</span> <span class="n">df_new</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;fips in @fips_list&#39;</span><span class="p">)</span>

<span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df_subset</span><span class="p">)</span> <span class="o">+</span> <span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">df_subset</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;daily_cases&#39;</span><span class="p">),</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span> <span class="o">+</span>    
    <span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">df_subset</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;rolling_mean&#39;</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span> <span class="o">+</span>    
    <span class="n">theme</span><span class="p">(</span><span class="n">axis_text_x</span><span class="o">=</span><span class="n">element_text</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">hjust</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> <span class="o">+</span>  
        <span class="n">facet_wrap</span><span class="p">(</span><span class="s1">&#39;fips&#39;</span><span class="p">,</span> <span class="n">nrow</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ncol</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span>
    <span class="n">theme</span><span class="p">(</span><span class="n">subplots_adjust</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;wspace&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span><span class="s1">&#39;hspace&#39;</span><span class="p">:</span> <span class="mf">0.2</span><span class="p">})</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/Kaemyuijang/opt/anaconda3/lib/python3.7/site-packages/plotnine/geoms/geom_path.py:75: PlotnineWarning: geom_path: Removed 6 rows containing missing values.
</pre></div>
</div>
<img alt="../_images/Midterm_for_Marking-Q11_Using_total_pop_197_1.png" src="../_images/Midterm_for_Marking-Q11_Using_total_pop_197_1.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (298563541)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fips_id</span> <span class="o">=</span> <span class="mf">53023.0</span>

<span class="n">df_subset</span> <span class="o">=</span> <span class="n">df_new</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;fips==@fips_id&#39;</span><span class="p">)</span>

<span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df_subset</span><span class="p">)</span> <span class="o">+</span> <span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">df_subset</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;daily_cases&#39;</span><span class="p">),</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">)</span> <span class="o">+</span>    
    <span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="n">df_subset</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;rolling_mean&#39;</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span> <span class="o">+</span>    
    <span class="n">theme</span><span class="p">(</span><span class="n">axis_text_x</span><span class="o">=</span><span class="n">element_text</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> <span class="n">hjust</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span> 
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/Kaemyuijang/opt/anaconda3/lib/python3.7/site-packages/plotnine/geoms/geom_path.py:75: PlotnineWarning: geom_path: Removed 6 rows containing missing values.
</pre></div>
</div>
<img alt="../_images/Midterm_for_Marking-Q11_Using_total_pop_198_1.png" src="../_images/Midterm_for_Marking-Q11_Using_total_pop_198_1.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (309523373)&gt;
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Exercises"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Pairote Satiracoo<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>