
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Exercise for Chapter 3 &#8212; SCMA248 Introduction to Data Science</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">SCMA248 Introduction to Data Science</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to SCMA248 Introduction to Data Science
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1_Introduction_to_Data_Science.html">
   1. Introduction to Data Science
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter2_Python_Basics.html">
   2. Python Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3_Data_Preparation.html">
   3. Data Selection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter4_Data_Visualization.html">
   6. Data Visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter5_Practical_Statistics.html">
   7. Practical Statistics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter6_Regression.html">
   8. Regression Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter7_Introduction_Machine_Learning.html">
   9. Machine learning: Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter8_Unsupervised_Learning.html">
   10. Unsupervised Machine Learning: K-means Clustering
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/Demo/ClaimsData_part2.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FDemo/ClaimsData_part2.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/Demo/ClaimsData_part2.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Exercise for Chapter 3
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#description-of-rating-variables">
   Description of Rating Variables
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hard-cording">
   Hard cording
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#part-2">
     Part 2
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#next-attempt">
     Next attempt
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pivot">
     Pivot
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#groupby">
     Groupby
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#last-attempt">
     Last Attempt:
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#conclusion">
     Conclusion
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <section id="exercise-for-chapter-3">
<h1>Exercise for Chapter 3<a class="headerlink" href="#exercise-for-chapter-3" title="Permalink to this headline">¶</a></h1>
<p>This exercises is design to assist you how to use the pandas package to import, preprocess data and perform basic statistical analysis. Later we should see how data generating events can produce data of interest to insurance analysts.</p>
<p>We will look at the Local Government Property Insurance Fund in this chapter. The fund insures property owned by municipal governments, such as schools and libraries.</p>
<ul class="simple">
<li><p>government buildings,</p></li>
<li><p>educational institutions,</p></li>
<li><p>public libraries, and</p></li>
<li><p>motor vehicles.</p></li>
</ul>
<p>Over a thousand local government units are covered by the fund, which charges about $25 million in annual premiums and provides insurance coverage of about $75 billion.</p>
<p><strong>Example 1</strong> Import the claim dataset namely ClaimsExperienceData.csv from my Github repository. Then write Python commands to answer the following questions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">claims</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/Users/Kaemyuijang/SCMA248/Data/ClaimsExperienceData.csv&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>How many claims observations are there in this dataset?</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">claims</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>5639
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>How many variables (features) are there in this dataset? List (print out) all the features.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">claims</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">claims</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;PolicyNum&#39;, &#39;Year&#39;, &#39;LnCoverage&#39;, &#39;BCcov&#39;, &#39;Premium&#39;, &#39;Freq&#39;, &#39;Deduct&#39;,
       &#39;y&#39;, &#39;lny&#39;, &#39;yAvg&#39;, &#39;lnDeduct&#39;, &#39;Fire5&#39;, &#39;NoClaimCredit&#39;, &#39;TypeCity&#39;,
       &#39;TypeCounty&#39;, &#39;TypeMisc&#39;, &#39;TypeSchool&#39;, &#39;TypeTown&#39;, &#39;TypeVillage&#39;,
       &#39;AC00&#39;, &#39;AC05&#39;, &#39;AC10&#39;, &#39;AC15&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
</section>
<section id="description-of-rating-variables">
<h1>Description of Rating Variables<a class="headerlink" href="#description-of-rating-variables" title="Permalink to this headline">¶</a></h1>
<p>One of the important tasks of insurance analysts is to develop models to represent and manage the two outcome variables, <strong>frequency</strong> and <strong>severity</strong>.</p>
<p>However, when actuaries and other financial analysts use those models, they do so in the context of external variables.</p>
<p>In general statistical terminology, one might call these explanatory or predictor variables.</p>
<p>Because of our insurance focus, we call them <strong>rating variables</strong> as they are useful in setting insurance rates and premiums.</p>
<p>The following table describes the rating variables considered.</p>
<p>These are variables that you think might naturally be related to claims outcomes.</p>
<!-- To handle the skewness, we henceforth focus on logarithmic transformations of coverage and deductibles. -->
<!-- For our immediate purposes, the coverage is our first rating variable. Other things being equal, we would expect that policyholders with larger coverage have larger claims. We will make this vague idea much more precise as we proceed, and also justify this expectation with data. -->
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Variable</strong></p></th>
<th class="head"><p><strong>Description</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>EntityType</p></td>
<td><p>Categorical variable that is one of six types: (Village, City, County, Misc, School, or Town)</p></td>
</tr>
<tr class="row-odd"><td><p>LnCoverage</p></td>
<td><p>Total building and content coverage, in logarithmic millions of dollars</p></td>
</tr>
<tr class="row-even"><td><p>LnDeduct</p></td>
<td><p>Deductible, in logarithmic dollars</p></td>
</tr>
<tr class="row-odd"><td><p>AlarmCredit</p></td>
<td><p>Categorical variable that is one of four types: (0, 5, 10, or 15) for automatic smoke alarms in main rooms</p></td>
</tr>
<tr class="row-even"><td><p>NoClaimCredit</p></td>
<td><p>Binary variable to indicate no claims in the past two years</p></td>
</tr>
<tr class="row-odd"><td><p>Fire5</p></td>
<td><p>Binary variable to indicate the fire class is below 5 (The range of fire class is 0 to 10)</p></td>
</tr>
</tbody>
</table>
<p><strong>In what follows, for illustrate, we will consider claims data in year 2010.</strong></p>
<ol class="simple">
<li><p>How many policies are there in 2010?</p></li>
</ol>
<p>Name the answer with the variable name <strong>num_policies</strong>.</p>
<p>Hint: one may use <code class="docutils literal notranslate"><span class="pre">.value_counts</span></code> method that return a Series containing counts of unique values. Alternatively, you want to count False and True separately you can use <code class="docutils literal notranslate"><span class="pre">pd.Series.sum()</span></code> + <code class="docutils literal notranslate"><span class="pre">~</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">temp</span> <span class="o">=</span> <span class="n">claims</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span>  <span class="o">==</span> <span class="mi">2010</span>
<span class="n">temp</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>False    4529
True     1110
Name: Year, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_policies</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="o">~</span><span class="n">temp</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4529
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>How many claims are there in 2010? Assign the result to the variable <strong>num_claims</strong>.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">claims2010</span> <span class="o">=</span> <span class="n">claims</span><span class="p">[</span><span class="n">temp</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">claims2010</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;PolicyNum&#39;, &#39;Year&#39;, &#39;LnCoverage&#39;, &#39;BCcov&#39;, &#39;Premium&#39;, &#39;Freq&#39;, &#39;Deduct&#39;,
       &#39;y&#39;, &#39;lny&#39;, &#39;yAvg&#39;, &#39;lnDeduct&#39;, &#39;Fire5&#39;, &#39;NoClaimCredit&#39;, &#39;TypeCity&#39;,
       &#39;TypeCounty&#39;, &#39;TypeMisc&#39;, &#39;TypeSchool&#39;, &#39;TypeTown&#39;, &#39;TypeVillage&#39;,
       &#39;AC00&#39;, &#39;AC05&#39;, &#39;AC10&#39;, &#39;AC15&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">claims2010</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PolicyNum        1.652057e+08
Year             2.231100e+06
LnCoverage       2.488480e+03
BCcov            4.577870e+10
Premium          1.590532e+07
Freq             1.377000e+03
Deduct           3.994500e+06
y                3.665931e+07
lny              3.736787e+03
yAvg             2.270177e+07
lnDeduct         8.013576e+03
Fire5            6.220000e+02
NoClaimCredit    6.270000e+02
TypeCity         1.560000e+02
TypeCounty       7.100000e+01
TypeMisc         1.230000e+02
TypeSchool       3.110000e+02
TypeTown         1.850000e+02
TypeVillage      2.640000e+02
AC00             3.460000e+02
AC05             8.200000e+01
AC10             9.000000e+01
AC15             5.920000e+02
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_claims</span> <span class="o">=</span> <span class="n">claims2010</span><span class="p">[</span><span class="s1">&#39;Freq&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">num_claims</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1377
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Which policy number has the maximum number of claims and what is this claims number?</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">claims2010</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;Freq&#39;</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PolicyNum</th>
      <th>Year</th>
      <th>LnCoverage</th>
      <th>BCcov</th>
      <th>Premium</th>
      <th>Freq</th>
      <th>Deduct</th>
      <th>y</th>
      <th>lny</th>
      <th>yAvg</th>
      <th>...</th>
      <th>TypeCity</th>
      <th>TypeCounty</th>
      <th>TypeMisc</th>
      <th>TypeSchool</th>
      <th>TypeTown</th>
      <th>TypeVillage</th>
      <th>AC00</th>
      <th>AC05</th>
      <th>AC10</th>
      <th>AC15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1406</th>
      <td>138109</td>
      <td>2010</td>
      <td>6.338472</td>
      <td>5.659308e+08</td>
      <td>124504</td>
      <td>239</td>
      <td>25000.0</td>
      <td>223784.65</td>
      <td>12.318439</td>
      <td>936.337448</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>100</th>
      <td>120030</td>
      <td>2010</td>
      <td>7.801717</td>
      <td>2.444797e+09</td>
      <td>391168</td>
      <td>103</td>
      <td>50000.0</td>
      <td>4920530.65</td>
      <td>15.408927</td>
      <td>47772.142230</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>2 rows × 23 columns</p>
</div></div></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="hard-cording">
<h1>Hard cording<a class="headerlink" href="#hard-cording" title="Permalink to this headline">¶</a></h1>
<p>claims2010.loc[1406,’Freq’]</p>
<p>With <code class="docutils literal notranslate"><span class="pre">.idxmax()</span></code>, we can return the index at which maximum weight value is present.</p>
<p>See <a class="reference external" href="https://www.geeksforgeeks.org/get-the-index-of-maximum-value-in-dataframe-column/">https://www.geeksforgeeks.org/get-the-index-of-maximum-value-in-dataframe-column/</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">claims2010</span><span class="p">[</span><span class="s1">&#39;Freq&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">())</span>

<span class="n">ind_freq_max</span> <span class="o">=</span> <span class="n">claims2010</span><span class="p">[</span><span class="s1">&#39;Freq&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">idxmax</span><span class="p">()</span>

<span class="n">max_claims</span> <span class="o">=</span> <span class="n">claims2010</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind_freq_max</span><span class="p">,</span><span class="s1">&#39;Freq&#39;</span><span class="p">]</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1406
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Calculate the proportion of policyholders who did not have any claims (use the name <strong>num_policies_no_claims</strong> for your output).</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using value_count() and .sort_index to obtain the number of </span>
<span class="c1"># policies by claim numbers.</span>

<span class="p">(</span><span class="n">claims2010</span><span class="p">[</span><span class="s1">&#39;Freq&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>

<span class="n">num_policies_no_claims</span> <span class="o">=</span> <span class="p">(</span><span class="n">claims2010</span><span class="p">[</span><span class="s1">&#39;Freq&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate the proportion of policyholders who did not have any claims.</span>

<span class="nb">round</span><span class="p">(</span><span class="n">num_policies_no_claims</span> <span class="o">/</span> <span class="n">num_policies</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.6369
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">claims2010</span><span class="p">[</span><span class="s1">&#39;Freq&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">claims2010</span><span class="p">[</span><span class="s1">&#39;Freq&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.5134350036310821
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Calculate the proportion of policyholders who had only one claim.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_policies_one_claims</span> <span class="o">=</span> <span class="p">(</span><span class="n">claims2010</span><span class="p">[</span><span class="s1">&#39;Freq&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">round</span><span class="p">(</span><span class="n">num_policies_one_claims</span> <span class="o">/</span> <span class="n">num_policies</span><span class="p">,</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.1883
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Calculate the average number of claims for this sample.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_claims</span><span class="o">/</span><span class="n">num_policies</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.2405405405405405
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">describe()</span></code> method is used for calculating some statistical data like percentile, mean and std of the numerical values of the Series or DataFrame.</p></li>
</ol>
<p>Applying to year 2010, what do we get when we run the command claims.describe()?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">claims2010</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PolicyNum</th>
      <th>Year</th>
      <th>LnCoverage</th>
      <th>BCcov</th>
      <th>Premium</th>
      <th>Freq</th>
      <th>Deduct</th>
      <th>y</th>
      <th>lny</th>
      <th>yAvg</th>
      <th>...</th>
      <th>TypeCity</th>
      <th>TypeCounty</th>
      <th>TypeMisc</th>
      <th>TypeSchool</th>
      <th>TypeTown</th>
      <th>TypeVillage</th>
      <th>AC00</th>
      <th>AC05</th>
      <th>AC10</th>
      <th>AC15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1110.000000</td>
      <td>1110.0</td>
      <td>1110.000000</td>
      <td>1.110000e+03</td>
      <td>1110.000000</td>
      <td>1110.000000</td>
      <td>1110.000000</td>
      <td>1.110000e+03</td>
      <td>1110.000000</td>
      <td>1.110000e+03</td>
      <td>...</td>
      <td>1110.000000</td>
      <td>1110.000000</td>
      <td>1110.000000</td>
      <td>1110.00000</td>
      <td>1110.000000</td>
      <td>1110.000000</td>
      <td>1110.000000</td>
      <td>1110.000000</td>
      <td>1110.000000</td>
      <td>1110.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>148833.995495</td>
      <td>2010.0</td>
      <td>2.241874</td>
      <td>4.124207e+07</td>
      <td>14329.113514</td>
      <td>1.240541</td>
      <td>3598.648649</td>
      <td>3.302640e+04</td>
      <td>3.366475</td>
      <td>2.045205e+04</td>
      <td>...</td>
      <td>0.140541</td>
      <td>0.063964</td>
      <td>0.110811</td>
      <td>0.28018</td>
      <td>0.166667</td>
      <td>0.237838</td>
      <td>0.311712</td>
      <td>0.073874</td>
      <td>0.081081</td>
      <td>0.533333</td>
    </tr>
    <tr>
      <th>std</th>
      <td>16131.790893</td>
      <td>0.0</td>
      <td>1.962844</td>
      <td>1.142432e+08</td>
      <td>24663.572338</td>
      <td>8.154437</td>
      <td>8787.925562</td>
      <td>4.287782e+05</td>
      <td>4.573141</td>
      <td>3.927241e+05</td>
      <td>...</td>
      <td>0.347704</td>
      <td>0.244799</td>
      <td>0.314039</td>
      <td>0.44929</td>
      <td>0.372846</td>
      <td>0.425951</td>
      <td>0.463402</td>
      <td>0.261683</td>
      <td>0.273083</td>
      <td>0.499113</td>
    </tr>
    <tr>
      <th>min</th>
      <td>120002.000000</td>
      <td>2010.0</td>
      <td>-4.575223</td>
      <td>1.030400e+04</td>
      <td>9.000000</td>
      <td>0.000000</td>
      <td>500.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>138104.250000</td>
      <td>2010.0</td>
      <td>0.900512</td>
      <td>2.460876e+06</td>
      <td>1633.500000</td>
      <td>0.000000</td>
      <td>500.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>150302.000000</td>
      <td>2010.0</td>
      <td>2.523816</td>
      <td>1.247615e+07</td>
      <td>6365.000000</td>
      <td>0.000000</td>
      <td>1000.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.00000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>160628.750000</td>
      <td>2010.0</td>
      <td>3.705105</td>
      <td>4.065431e+07</td>
      <td>17923.750000</td>
      <td>1.000000</td>
      <td>2500.000000</td>
      <td>4.139750e+03</td>
      <td>8.328310</td>
      <td>2.818750e+03</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.00000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>180791.000000</td>
      <td>2010.0</td>
      <td>7.801717</td>
      <td>2.444797e+09</td>
      <td>391168.000000</td>
      <td>239.000000</td>
      <td>100000.000000</td>
      <td>1.292222e+07</td>
      <td>16.374459</td>
      <td>1.292222e+07</td>
      <td>...</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.00000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 23 columns</p>
</div></div></div>
</div>
<ol class="simple">
<li><p>A common method for determining the severity distribution is to look at the distribution of the sample of 1,377 claims. Another typical strategy is to look at the <strong>distribution of average claims among policyholders who have made claims</strong>.</p></li>
</ol>
<p>In our 2010 sample, how many such policyholders who have made claims?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_policies</span> <span class="o">-</span> <span class="n">num_policies_no_claims</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>403
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>The average claim for the 209 policyholders who had only one claim is the same as the single claim they had.</p></li>
</ol>
<p>Write the command(s) to list the average claim of such 209 policyholders.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_index</span> <span class="o">=</span> <span class="p">(</span><span class="n">claims2010</span><span class="p">[</span><span class="s1">&#39;Freq&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">claims2010</span><span class="p">[</span><span class="n">selected_index</span><span class="p">][[</span><span class="s1">&#39;Freq&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Freq</th>
      <th>y</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>6838.87</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>9711.28</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1</td>
      <td>10323.50</td>
    </tr>
    <tr>
      <th>24</th>
      <td>1</td>
      <td>3469.79</td>
    </tr>
    <tr>
      <th>31</th>
      <td>1</td>
      <td>35000.00</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5534</th>
      <td>1</td>
      <td>1851.48</td>
    </tr>
    <tr>
      <th>5568</th>
      <td>1</td>
      <td>3405.00</td>
    </tr>
    <tr>
      <th>5603</th>
      <td>1</td>
      <td>20679.58</td>
    </tr>
    <tr>
      <th>5635</th>
      <td>1</td>
      <td>168304.05</td>
    </tr>
    <tr>
      <th>5636</th>
      <td>1</td>
      <td>1034.33</td>
    </tr>
  </tbody>
</table>
<p>209 rows × 2 columns</p>
</div></div></div>
</div>
<ol class="simple">
<li><p>Calculate the average claim of the policyholder with the maximum number of claims.</p></li>
</ol>
<p>ind_freq_max = claims2010[‘Freq’].idxmax()</p>
<p>max_claims = claims2010.loc[ind_freq_max,’Freq’]</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">claims2010</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind_freq_max</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">claims2010</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">ind_freq_max</span><span class="p">,</span><span class="s1">&#39;Freq&#39;</span><span class="p">]</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>936.3374476987448
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">claims</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PolicyNum</th>
      <th>Year</th>
      <th>LnCoverage</th>
      <th>BCcov</th>
      <th>Premium</th>
      <th>Freq</th>
      <th>Deduct</th>
      <th>y</th>
      <th>lny</th>
      <th>yAvg</th>
      <th>...</th>
      <th>TypeCity</th>
      <th>TypeCounty</th>
      <th>TypeMisc</th>
      <th>TypeSchool</th>
      <th>TypeTown</th>
      <th>TypeVillage</th>
      <th>AC00</th>
      <th>AC05</th>
      <th>AC10</th>
      <th>AC15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>5639.000000</td>
      <td>5639.000000</td>
      <td>5639.000000</td>
      <td>5.639000e+03</td>
      <td>5639.000000</td>
      <td>5639.000000</td>
      <td>5639.000000</td>
      <td>5.639000e+03</td>
      <td>5639.000000</td>
      <td>5.639000e+03</td>
      <td>...</td>
      <td>5639.000000</td>
      <td>5639.000000</td>
      <td>5639.000000</td>
      <td>5639.000000</td>
      <td>5639.000000</td>
      <td>5639.000000</td>
      <td>5639.000000</td>
      <td>5639.000000</td>
      <td>5639.000000</td>
      <td>5639.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>148880.491222</td>
      <td>2007.979784</td>
      <td>2.132881</td>
      <td>3.728085e+07</td>
      <td>14796.029793</td>
      <td>1.109239</td>
      <td>3364.869658</td>
      <td>1.728730e+04</td>
      <td>2.753088</td>
      <td>9.291565e+03</td>
      <td>...</td>
      <td>0.140628</td>
      <td>0.058166</td>
      <td>0.107998</td>
      <td>0.283206</td>
      <td>0.172194</td>
      <td>0.237808</td>
      <td>0.463025</td>
      <td>0.042383</td>
      <td>0.057989</td>
      <td>0.436602</td>
    </tr>
    <tr>
      <th>std</th>
      <td>15911.165649</td>
      <td>1.415949</td>
      <td>1.977179</td>
      <td>1.034020e+08</td>
      <td>25520.718048</td>
      <td>8.549179</td>
      <td>8273.670512</td>
      <td>2.304627e+05</td>
      <td>4.311270</td>
      <td>1.975141e+05</td>
      <td>...</td>
      <td>0.347668</td>
      <td>0.234078</td>
      <td>0.310405</td>
      <td>0.450596</td>
      <td>0.377582</td>
      <td>0.425779</td>
      <td>0.498675</td>
      <td>0.201480</td>
      <td>0.233743</td>
      <td>0.496008</td>
    </tr>
    <tr>
      <th>min</th>
      <td>120002.000000</td>
      <td>2006.000000</td>
      <td>-4.717555</td>
      <td>8.937000e+03</td>
      <td>9.000000</td>
      <td>0.000000</td>
      <td>500.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>138112.000000</td>
      <td>2007.000000</td>
      <td>0.785066</td>
      <td>2.192556e+06</td>
      <td>1612.500000</td>
      <td>0.000000</td>
      <td>500.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>150350.000000</td>
      <td>2008.000000</td>
      <td>2.429532</td>
      <td>1.135357e+07</td>
      <td>6578.000000</td>
      <td>0.000000</td>
      <td>1000.000000</td>
      <td>0.000000e+00</td>
      <td>0.000000</td>
      <td>0.000000e+00</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>160619.000000</td>
      <td>2009.000000</td>
      <td>3.606218</td>
      <td>3.682654e+07</td>
      <td>18184.000000</td>
      <td>1.000000</td>
      <td>2500.000000</td>
      <td>2.181825e+03</td>
      <td>7.687917</td>
      <td>1.519706e+03</td>
      <td>...</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>1.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>180791.000000</td>
      <td>2010.000000</td>
      <td>7.801717</td>
      <td>2.444797e+09</td>
      <td>412328.000000</td>
      <td>263.000000</td>
      <td>100000.000000</td>
      <td>1.292222e+07</td>
      <td>16.374459</td>
      <td>1.292222e+07</td>
      <td>...</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 23 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">claims</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>PolicyNum        1.488805e+05
Year             2.007980e+03
LnCoverage       2.132881e+00
BCcov            3.728085e+07
Premium          1.479603e+04
Freq             1.109239e+00
Deduct           3.364870e+03
y                1.728730e+04
lny              2.753088e+00
yAvg             9.291565e+03
lnDeduct         7.157236e+00
Fire5            5.552403e-01
NoClaimCredit    3.286044e-01
TypeCity         1.406278e-01
TypeCounty       5.816634e-02
TypeMisc         1.079979e-01
TypeSchool       2.832062e-01
TypeTown         1.721937e-01
TypeVillage      2.378081e-01
AC00             4.630254e-01
AC05             4.238340e-02
AC10             5.798901e-02
AC15             4.366022e-01
dtype: float64
</pre></div>
</div>
</div>
</div>
<section id="part-2">
<h2>Part 2<a class="headerlink" href="#part-2" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Write Python code to generage a table that shows the 2010 claims frequency distribution. The table should contain the number of policies, the number of claims and the proportion (broken down by the number of claims).</p></li>
</ol>
<p>Goal: the table should tell us how many poicyholders and the (percentage) proportion of policyholders who did not have any claims, only one claim and so on.</p>
<p>1.1. How many policyholders in the 2010 claims data have 9 or more claims?</p>
<p>1.2. What is the percentage proportion of policyholders having exactly 3 claims?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="c1">#claims = pd.read_csv(&#39;/Users/Kaemyuijang/SCMA248/Data/ClaimsExperienceData.csv&#39;)</span>
<span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/pairote-sat/SCMA248/main/Data/ClaimsExperienceData.csv&#39;</span>
<span class="n">claims</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">SSLCertVerificationError</span><span class="g g-Whitespace">                  </span>Traceback (most recent call last)
<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/urllib/request.py</span> in <span class="ni">do_open</span><span class="nt">(self, http_class, req, **http_conn_args)</span>
<span class="g g-Whitespace">   </span><span class="mi">1349</span>                 <span class="n">h</span><span class="o">.</span><span class="n">request</span><span class="p">(</span><span class="n">req</span><span class="o">.</span><span class="n">get_method</span><span class="p">(),</span> <span class="n">req</span><span class="o">.</span><span class="n">selector</span><span class="p">,</span> <span class="n">req</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span>
<span class="ne">-&gt; </span><span class="mi">1350</span>                           <span class="n">encode_chunked</span><span class="o">=</span><span class="n">req</span><span class="o">.</span><span class="n">has_header</span><span class="p">(</span><span class="s1">&#39;Transfer-encoding&#39;</span><span class="p">))</span>
<span class="g g-Whitespace">   </span><span class="mi">1351</span>             <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span> <span class="c1"># timeout error</span>

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/http/client.py</span> in <span class="ni">request</span><span class="nt">(self, method, url, body, headers, encode_chunked)</span>
<span class="g g-Whitespace">   </span><span class="mi">1261</span>         <span class="sd">&quot;&quot;&quot;Send a complete request to the server.&quot;&quot;&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1262</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_send_request</span><span class="p">(</span><span class="n">method</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="n">body</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="n">encode_chunked</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1263</span> 

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/http/client.py</span> in <span class="ni">_send_request</span><span class="nt">(self, method, url, body, headers, encode_chunked)</span>
<span class="g g-Whitespace">   </span><span class="mi">1307</span>             <span class="n">body</span> <span class="o">=</span> <span class="n">_encode</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="s1">&#39;body&#39;</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1308</span>         <span class="bp">self</span><span class="o">.</span><span class="n">endheaders</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">encode_chunked</span><span class="o">=</span><span class="n">encode_chunked</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1309</span> 

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/http/client.py</span> in <span class="ni">endheaders</span><span class="nt">(self, message_body, encode_chunked)</span>
<span class="g g-Whitespace">   </span><span class="mi">1256</span>             <span class="k">raise</span> <span class="n">CannotSendHeader</span><span class="p">()</span>
<span class="ne">-&gt; </span><span class="mi">1257</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_send_output</span><span class="p">(</span><span class="n">message_body</span><span class="p">,</span> <span class="n">encode_chunked</span><span class="o">=</span><span class="n">encode_chunked</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1258</span> 

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/http/client.py</span> in <span class="ni">_send_output</span><span class="nt">(self, message_body, encode_chunked)</span>
<span class="g g-Whitespace">   </span><span class="mi">1027</span>         <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">_buffer</span><span class="p">[:]</span>
<span class="ne">-&gt; </span><span class="mi">1028</span>         <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1029</span> 

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/http/client.py</span> in <span class="ni">send</span><span class="nt">(self, data)</span>
<span class="g g-Whitespace">    </span><span class="mi">967</span>             <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">auto_open</span><span class="p">:</span>
<span class="ne">--&gt; </span><span class="mi">968</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">969</span>             <span class="k">else</span><span class="p">:</span>

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/http/client.py</span> in <span class="ni">connect</span><span class="nt">(self)</span>
<span class="g g-Whitespace">   </span><span class="mi">1431</span>             <span class="bp">self</span><span class="o">.</span><span class="n">sock</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="o">.</span><span class="n">wrap_socket</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sock</span><span class="p">,</span>
<span class="ne">-&gt; </span><span class="mi">1432</span>                                                   <span class="n">server_hostname</span><span class="o">=</span><span class="n">server_hostname</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1433</span> 

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/ssl.py</span> in <span class="ni">wrap_socket</span><span class="nt">(self, sock, server_side, do_handshake_on_connect, suppress_ragged_eofs, server_hostname, session)</span>
<span class="g g-Whitespace">    </span><span class="mi">422</span>             <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">423</span>             <span class="n">session</span><span class="o">=</span><span class="n">session</span>
<span class="g g-Whitespace">    </span><span class="mi">424</span>         <span class="p">)</span>

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/ssl.py</span> in <span class="ni">_create</span><span class="nt">(cls, sock, server_side, do_handshake_on_connect, suppress_ragged_eofs, server_hostname, context, session)</span>
<span class="g g-Whitespace">    </span><span class="mi">869</span>                         <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;do_handshake_on_connect should not be specified for non-blocking sockets&quot;</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">870</span>                     <span class="bp">self</span><span class="o">.</span><span class="n">do_handshake</span><span class="p">()</span>
<span class="g g-Whitespace">    </span><span class="mi">871</span>             <span class="k">except</span> <span class="p">(</span><span class="ne">OSError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">):</span>

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/ssl.py</span> in <span class="ni">do_handshake</span><span class="nt">(self, block)</span>
<span class="g g-Whitespace">   </span><span class="mi">1138</span>                 <span class="bp">self</span><span class="o">.</span><span class="n">settimeout</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="ne">-&gt; </span><span class="mi">1139</span>             <span class="bp">self</span><span class="o">.</span><span class="n">_sslobj</span><span class="o">.</span><span class="n">do_handshake</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1140</span>         <span class="k">finally</span><span class="p">:</span>

<span class="ne">SSLCertVerificationError</span>: [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1091)

<span class="n">During</span> <span class="n">handling</span> <span class="n">of</span> <span class="n">the</span> <span class="n">above</span> <span class="n">exception</span><span class="p">,</span> <span class="n">another</span> <span class="n">exception</span> <span class="n">occurred</span><span class="p">:</span>

<span class="ne">URLError</span><span class="g g-Whitespace">                                  </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">kl</span><span class="o">/</span><span class="n">h_r05n_j76n32kt0dwy7kynw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_5571</span><span class="o">/</span><span class="mf">3980151752.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> <span class="c1">#claims = pd.read_csv(&#39;/Users/Kaemyuijang/SCMA248/Data/ClaimsExperienceData.csv&#39;)</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/pairote-sat/SCMA248/main/Data/ClaimsExperienceData.csv&#39;</span>
<span class="ne">----&gt; </span><span class="mi">5</span> <span class="n">claims</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/pandas/util/_decorators.py</span> in <span class="ni">wrapper</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">309</span>                     <span class="n">stacklevel</span><span class="o">=</span><span class="n">stacklevel</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">310</span>                 <span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">311</span>             <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">312</span> 
<span class="g g-Whitespace">    </span><span class="mi">313</span>         <span class="k">return</span> <span class="n">wrapper</span>

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/pandas/io/parsers/readers.py</span> in <span class="ni">read_csv</span><span class="nt">(filepath_or_buffer, sep, delimiter, header, names, index_col, usecols, squeeze, prefix, mangle_dupe_cols, dtype, engine, converters, true_values, false_values, skipinitialspace, skiprows, skipfooter, nrows, na_values, keep_default_na, na_filter, verbose, skip_blank_lines, parse_dates, infer_datetime_format, keep_date_col, date_parser, dayfirst, cache_dates, iterator, chunksize, compression, thousands, decimal, lineterminator, quotechar, quoting, doublequote, escapechar, comment, encoding, encoding_errors, dialect, error_bad_lines, warn_bad_lines, on_bad_lines, delim_whitespace, low_memory, memory_map, float_precision, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">584</span>     <span class="n">kwds</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">kwds_defaults</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">585</span> 
<span class="ne">--&gt; </span><span class="mi">586</span>     <span class="k">return</span> <span class="n">_read</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">587</span> 
<span class="g g-Whitespace">    </span><span class="mi">588</span> 

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/pandas/io/parsers/readers.py</span> in <span class="ni">_read</span><span class="nt">(filepath_or_buffer, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">480</span> 
<span class="g g-Whitespace">    </span><span class="mi">481</span>     <span class="c1"># Create the parser.</span>
<span class="ne">--&gt; </span><span class="mi">482</span>     <span class="n">parser</span> <span class="o">=</span> <span class="n">TextFileReader</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">483</span> 
<span class="g g-Whitespace">    </span><span class="mi">484</span>     <span class="k">if</span> <span class="n">chunksize</span> <span class="ow">or</span> <span class="n">iterator</span><span class="p">:</span>

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/pandas/io/parsers/readers.py</span> in <span class="ni">__init__</span><span class="nt">(self, f, engine, **kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">809</span>             <span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwds</span><span class="p">[</span><span class="s2">&quot;has_index_names&quot;</span><span class="p">]</span>
<span class="g g-Whitespace">    </span><span class="mi">810</span> 
<span class="ne">--&gt; </span><span class="mi">811</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_engine</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_engine</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">engine</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">812</span> 
<span class="g g-Whitespace">    </span><span class="mi">813</span>     <span class="k">def</span> <span class="nf">close</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/pandas/io/parsers/readers.py</span> in <span class="ni">_make_engine</span><span class="nt">(self, engine)</span>
<span class="g g-Whitespace">   </span><span class="mi">1038</span>             <span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1039</span>         <span class="c1"># error: Too many arguments for &quot;ParserBase&quot;</span>
<span class="ne">-&gt; </span><span class="mi">1040</span>         <span class="k">return</span> <span class="n">mapping</span><span class="p">[</span><span class="n">engine</span><span class="p">](</span><span class="bp">self</span><span class="o">.</span><span class="n">f</span><span class="p">,</span> <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span>  <span class="c1"># type: ignore[call-arg]</span>
<span class="g g-Whitespace">   </span><span class="mi">1041</span> 
<span class="g g-Whitespace">   </span><span class="mi">1042</span>     <span class="k">def</span> <span class="nf">_failover_to_python</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/pandas/io/parsers/c_parser_wrapper.py</span> in <span class="ni">__init__</span><span class="nt">(self, src, **kwds)</span>
<span class="g g-Whitespace">     </span><span class="mi">49</span> 
<span class="g g-Whitespace">     </span><span class="mi">50</span>         <span class="c1"># open handles</span>
<span class="ne">---&gt; </span><span class="mi">51</span>         <span class="bp">self</span><span class="o">.</span><span class="n">_open_handles</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">kwds</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">52</span>         <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">handles</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
<span class="g g-Whitespace">     </span><span class="mi">53</span> 

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/pandas/io/parsers/base_parser.py</span> in <span class="ni">_open_handles</span><span class="nt">(self, src, kwds)</span>
<span class="g g-Whitespace">    </span><span class="mi">227</span>             <span class="n">memory_map</span><span class="o">=</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;memory_map&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">228</span>             <span class="n">storage_options</span><span class="o">=</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;storage_options&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">),</span>
<span class="ne">--&gt; </span><span class="mi">229</span>             <span class="n">errors</span><span class="o">=</span><span class="n">kwds</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;encoding_errors&quot;</span><span class="p">,</span> <span class="s2">&quot;strict&quot;</span><span class="p">),</span>
<span class="g g-Whitespace">    </span><span class="mi">230</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">231</span> 

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/pandas/io/common.py</span> in <span class="ni">get_handle</span><span class="nt">(path_or_buf, mode, encoding, compression, memory_map, is_text, errors, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">612</span>         <span class="n">compression</span><span class="o">=</span><span class="n">compression</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">613</span>         <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">,</span>
<span class="ne">--&gt; </span><span class="mi">614</span>         <span class="n">storage_options</span><span class="o">=</span><span class="n">storage_options</span><span class="p">,</span>
<span class="g g-Whitespace">    </span><span class="mi">615</span>     <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">616</span> 

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/pandas/io/common.py</span> in <span class="ni">_get_filepath_or_buffer</span><span class="nt">(filepath_or_buffer, encoding, compression, mode, storage_options)</span>
<span class="g g-Whitespace">    </span><span class="mi">310</span>         <span class="c1"># assuming storage_options is to be interpreted as headers</span>
<span class="g g-Whitespace">    </span><span class="mi">311</span>         <span class="n">req_info</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">Request</span><span class="p">(</span><span class="n">filepath_or_buffer</span><span class="p">,</span> <span class="n">headers</span><span class="o">=</span><span class="n">storage_options</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">312</span>         <span class="k">with</span> <span class="n">urlopen</span><span class="p">(</span><span class="n">req_info</span><span class="p">)</span> <span class="k">as</span> <span class="n">req</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">313</span>             <span class="n">content_encoding</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;Content-Encoding&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">314</span>             <span class="k">if</span> <span class="n">content_encoding</span> <span class="o">==</span> <span class="s2">&quot;gzip&quot;</span><span class="p">:</span>

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/site-packages/pandas/io/common.py</span> in <span class="ni">urlopen</span><span class="nt">(*args, **kwargs)</span>
<span class="g g-Whitespace">    </span><span class="mi">210</span>     <span class="kn">import</span> <span class="nn">urllib.request</span>
<span class="g g-Whitespace">    </span><span class="mi">211</span> 
<span class="ne">--&gt; </span><span class="mi">212</span>     <span class="k">return</span> <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">213</span> 
<span class="g g-Whitespace">    </span><span class="mi">214</span> 

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/urllib/request.py</span> in <span class="ni">urlopen</span><span class="nt">(url, data, timeout, cafile, capath, cadefault, context)</span>
<span class="g g-Whitespace">    </span><span class="mi">220</span>     <span class="k">else</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">221</span>         <span class="n">opener</span> <span class="o">=</span> <span class="n">_opener</span>
<span class="ne">--&gt; </span><span class="mi">222</span>     <span class="k">return</span> <span class="n">opener</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">223</span> 
<span class="g g-Whitespace">    </span><span class="mi">224</span> <span class="k">def</span> <span class="nf">install_opener</span><span class="p">(</span><span class="n">opener</span><span class="p">):</span>

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/urllib/request.py</span> in <span class="ni">open</span><span class="nt">(self, fullurl, data, timeout)</span>
<span class="g g-Whitespace">    </span><span class="mi">523</span>             <span class="n">req</span> <span class="o">=</span> <span class="n">meth</span><span class="p">(</span><span class="n">req</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">524</span> 
<span class="ne">--&gt; </span><span class="mi">525</span>         <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_open</span><span class="p">(</span><span class="n">req</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">526</span> 
<span class="g g-Whitespace">    </span><span class="mi">527</span>         <span class="c1"># post-process response</span>

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/urllib/request.py</span> in <span class="ni">_open</span><span class="nt">(self, req, data)</span>
<span class="g g-Whitespace">    </span><span class="mi">541</span>         <span class="n">protocol</span> <span class="o">=</span> <span class="n">req</span><span class="o">.</span><span class="n">type</span>
<span class="g g-Whitespace">    </span><span class="mi">542</span>         <span class="n">result</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_call_chain</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handle_open</span><span class="p">,</span> <span class="n">protocol</span><span class="p">,</span> <span class="n">protocol</span> <span class="o">+</span>
<span class="ne">--&gt; </span><span class="mi">543</span>                                   <span class="s1">&#39;_open&#39;</span><span class="p">,</span> <span class="n">req</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">544</span>         <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">545</span>             <span class="k">return</span> <span class="n">result</span>

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/urllib/request.py</span> in <span class="ni">_call_chain</span><span class="nt">(self, chain, kind, meth_name, *args)</span>
<span class="g g-Whitespace">    </span><span class="mi">501</span>         <span class="k">for</span> <span class="n">handler</span> <span class="ow">in</span> <span class="n">handlers</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">502</span>             <span class="n">func</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">handler</span><span class="p">,</span> <span class="n">meth_name</span><span class="p">)</span>
<span class="ne">--&gt; </span><span class="mi">503</span>             <span class="n">result</span> <span class="o">=</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">504</span>             <span class="k">if</span> <span class="n">result</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<span class="g g-Whitespace">    </span><span class="mi">505</span>                 <span class="k">return</span> <span class="n">result</span>

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/urllib/request.py</span> in <span class="ni">https_open</span><span class="nt">(self, req)</span>
<span class="g g-Whitespace">   </span><span class="mi">1391</span>         <span class="k">def</span> <span class="nf">https_open</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">req</span><span class="p">):</span>
<span class="g g-Whitespace">   </span><span class="mi">1392</span>             <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">do_open</span><span class="p">(</span><span class="n">http</span><span class="o">.</span><span class="n">client</span><span class="o">.</span><span class="n">HTTPSConnection</span><span class="p">,</span> <span class="n">req</span><span class="p">,</span>
<span class="ne">-&gt; </span><span class="mi">1393</span>                 <span class="n">context</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_context</span><span class="p">,</span> <span class="n">check_hostname</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">_check_hostname</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1394</span> 
<span class="g g-Whitespace">   </span><span class="mi">1395</span>         <span class="n">https_request</span> <span class="o">=</span> <span class="n">AbstractHTTPHandler</span><span class="o">.</span><span class="n">do_request_</span>

<span class="nn">/Library/Frameworks/Python.framework/Versions/3.7/lib/python3.7/urllib/request.py</span> in <span class="ni">do_open</span><span class="nt">(self, http_class, req, **http_conn_args)</span>
<span class="g g-Whitespace">   </span><span class="mi">1350</span>                           <span class="n">encode_chunked</span><span class="o">=</span><span class="n">req</span><span class="o">.</span><span class="n">has_header</span><span class="p">(</span><span class="s1">&#39;Transfer-encoding&#39;</span><span class="p">))</span>
<span class="g g-Whitespace">   </span><span class="mi">1351</span>             <span class="k">except</span> <span class="ne">OSError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span> <span class="c1"># timeout error</span>
<span class="ne">-&gt; </span><span class="mi">1352</span>                 <span class="k">raise</span> <span class="n">URLError</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
<span class="g g-Whitespace">   </span><span class="mi">1353</span>             <span class="n">r</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="n">getresponse</span><span class="p">()</span>
<span class="g g-Whitespace">   </span><span class="mi">1354</span>         <span class="k">except</span><span class="p">:</span>

<span class="ne">URLError</span>: &lt;urlopen error [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed: unable to get local issuer certificate (_ssl.c:1091)&gt;
</pre></div>
</div>
</div>
</div>
<p>To obtain the number of policies and number of claims categorized by claim frequency (and by year), we first group <code class="docutils literal notranslate"><span class="pre">claims</span></code> dataset by <code class="docutils literal notranslate"><span class="pre">Year</span></code> and <code class="docutils literal notranslate"><span class="pre">Freq</span></code> and apply <code class="docutils literal notranslate"><span class="pre">agg</span></code> (aggregate) function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">claimsFreqDist</span> <span class="o">=</span> <span class="n">claims</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span><span class="s1">&#39;Freq&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;PolicyNum&#39;</span> <span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="s1">&#39;Freq&#39;</span> <span class="p">:</span> <span class="s1">&#39;sum&#39;</span><span class="p">})</span>
<span class="n">claimsFreqDist</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;PolicyNum&#39;</span><span class="p">:</span><span class="s1">&#39;NumPolicies&#39;</span><span class="p">,</span> <span class="s1">&#39;Freq&#39;</span><span class="p">:</span><span class="s1">&#39;NumClaims&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">claimsFreqDist</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>NumPolicies</th>
      <th>NumClaims</th>
    </tr>
    <tr>
      <th>Year</th>
      <th>Freq</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">2006</th>
      <th>0</th>
      <td>845</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>153</td>
      <td>153</td>
    </tr>
    <tr>
      <th>2</th>
      <td>67</td>
      <td>134</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40</td>
      <td>120</td>
    </tr>
    <tr>
      <th>4</th>
      <td>13</td>
      <td>52</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">2010</th>
      <th>19</th>
      <td>1</td>
      <td>19</td>
    </tr>
    <tr>
      <th>30</th>
      <td>1</td>
      <td>30</td>
    </tr>
    <tr>
      <th>39</th>
      <td>1</td>
      <td>39</td>
    </tr>
    <tr>
      <th>103</th>
      <td>1</td>
      <td>103</td>
    </tr>
    <tr>
      <th>239</th>
      <td>1</td>
      <td>239</td>
    </tr>
  </tbody>
</table>
<p>103 rows × 2 columns</p>
</div></div></div>
</div>
<p>To determine the (percentage) proportion of policies for each claim frequency, we will first group the “Year” and “Freq”.   To calculate the percentage <strong>within each “Year” group</strong>, the following command can be used groupby(level=0).apply(lambda x: 100*x/x.sum())</p>
<p><strong>Note:</strong> Because the original dataframe becomes a multiple index dataframe after grouping, the level = 0 refers to the top level index, which in our case is ‘Year’.</p>
<p>You can see the results below, which have already been sorted by percent of policies for each claim frequency by year.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Table1 = claims.groupby([&#39;Year&#39;,&#39;Freq&#39;]).agg({&#39;PolicyNum&#39; : &#39;count&#39;}).groupby(level=&#39;Year&#39;).apply(lambda x: 100*x/x.sum())</span>
<span class="n">Table1</span> <span class="o">=</span> <span class="n">claims</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span><span class="s1">&#39;Freq&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;PolicyNum&#39;</span> <span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">100</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">Table1</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;PolicyNum&#39;</span><span class="p">:</span><span class="s1">&#39;Percentage&#39;</span><span class="p">},</span> <span class="n">inplace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

<span class="c1">#Table1.loc[(2010,slice(None))]</span>
<span class="n">Table1</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))]</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Percentage</th>
    </tr>
    <tr>
      <th>Year</th>
      <th>Freq</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="7" valign="top">2009</th>
      <th>16</th>
      <td>0.089928</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0.089928</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.089928</td>
    </tr>
    <tr>
      <th>21</th>
      <td>0.089928</td>
    </tr>
    <tr>
      <th>143</th>
      <td>0.089928</td>
    </tr>
    <tr>
      <th>228</th>
      <td>0.089928</td>
    </tr>
    <tr>
      <th>263</th>
      <td>0.089928</td>
    </tr>
    <tr>
      <th rowspan="23" valign="top">2010</th>
      <th>0</th>
      <td>63.693694</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18.828829</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.747748</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.603604</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.621622</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.081081</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.810811</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.360360</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.540541</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.270270</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.180180</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.180180</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.180180</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>30</th>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>39</th>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>103</th>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>239</th>
      <td>0.090090</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The final is to merged the above two resulting tables using <code class="docutils literal notranslate"><span class="pre">pd.merge</span></code> function.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">claimsFreqDist</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">Table1</span><span class="p">,</span><span class="n">claimsFreqDist</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="n">on</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span><span class="s1">&#39;Freq&#39;</span><span class="p">])</span>

<span class="c1">#claimsFreqDist</span>

<span class="n">claimsFreqDist</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="mi">2010</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))]</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>NumClaims</th>
      <th>NumPolicies</th>
      <th>Percentage</th>
    </tr>
    <tr>
      <th>Freq</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>707</td>
      <td>63.693694</td>
    </tr>
    <tr>
      <th>1</th>
      <td>209</td>
      <td>209</td>
      <td>18.828829</td>
    </tr>
    <tr>
      <th>2</th>
      <td>172</td>
      <td>86</td>
      <td>7.747748</td>
    </tr>
    <tr>
      <th>3</th>
      <td>120</td>
      <td>40</td>
      <td>3.603604</td>
    </tr>
    <tr>
      <th>4</th>
      <td>72</td>
      <td>18</td>
      <td>1.621622</td>
    </tr>
    <tr>
      <th>5</th>
      <td>60</td>
      <td>12</td>
      <td>1.081081</td>
    </tr>
    <tr>
      <th>6</th>
      <td>54</td>
      <td>9</td>
      <td>0.810811</td>
    </tr>
    <tr>
      <th>7</th>
      <td>28</td>
      <td>4</td>
      <td>0.360360</td>
    </tr>
    <tr>
      <th>8</th>
      <td>48</td>
      <td>6</td>
      <td>0.540541</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>10</th>
      <td>30</td>
      <td>3</td>
      <td>0.270270</td>
    </tr>
    <tr>
      <th>11</th>
      <td>22</td>
      <td>2</td>
      <td>0.180180</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>14</th>
      <td>28</td>
      <td>2</td>
      <td>0.180180</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>16</th>
      <td>32</td>
      <td>2</td>
      <td>0.180180</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>30</th>
      <td>30</td>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>39</th>
      <td>39</td>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>103</th>
      <td>103</td>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>239</th>
      <td>239</td>
      <td>1</td>
      <td>0.090090</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#claimsFreqDist.loc[(2010,slice(None))].sort_index(axis=1)</span>

<span class="n">claimsFreqDist</span><span class="o">.</span><span class="n">index</span>
<span class="n">claimsFreqDist</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">),[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">]),[</span><span class="s1">&#39;Percentage&#39;</span><span class="p">,</span><span class="s1">&#39;NumClaims&#39;</span><span class="p">]</span> <span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>Percentage</th>
      <th>NumClaims</th>
    </tr>
    <tr>
      <th>Year</th>
      <th>Freq</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="3" valign="top">2006</th>
      <th>1</th>
      <td>13.258232</td>
      <td>153</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5.805893</td>
      <td>134</td>
    </tr>
    <tr>
      <th>5</th>
      <td>0.779896</td>
      <td>45</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">2007</th>
      <th>1</th>
      <td>12.829525</td>
      <td>146</td>
    </tr>
    <tr>
      <th>2</th>
      <td>8.084359</td>
      <td>184</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>1.1. How many policyholders in the 2010 claims data have 9 or more claims?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># see for more detail: https://stackoverflow.com/questions/50608749/slicing-a-multiindex-dataframe-with-a-condition-based-on-the-index</span>

<span class="c1">#l0 and l1 are Year and Freq levels, respectively.</span>
<span class="n">l0</span> <span class="o">=</span> <span class="n">claimsFreqDist</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">l1</span> <span class="o">=</span> <span class="n">claimsFreqDist</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">cond</span> <span class="o">=</span> <span class="p">(</span><span class="n">l0</span> <span class="o">==</span> <span class="mi">2010</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">l1</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="p">)</span>

<span class="n">claimsFreqDist</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span><span class="s1">&#39;NumPolicies&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">ans1_1</span> <span class="o">=</span> <span class="n">claimsFreqDist</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">cond</span><span class="p">,</span><span class="s1">&#39;NumPolicies&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ans: The number of policyholders in the 2010 claims data having 9 or more claims is&#39;</span>
      <span class="p">,</span> <span class="n">ans1_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ans: The number of policyholders in the 2010 claims data having 9 or more claims is 19
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://stackoverflow.com/questions/53927460/select-rows-in-pandas-multiindex-dataframe</span>

<span class="n">claimsFreqDist</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Year == 2010 &amp; Freq &gt;= 9&#39;</span><span class="p">)[</span><span class="s1">&#39;NumPolicies&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>19
</pre></div>
</div>
</div>
</div>
<p>1.2. What is the percentage proportion of policyholders having exactly 3 claims?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">claimsFreqDist</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Year == 2010 &amp; Freq == 3&#39;</span><span class="p">)[</span><span class="s1">&#39;Percentage&#39;</span><span class="p">]</span>

<span class="n">ans1_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">claimsFreqDist</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;Year == 2010 &amp; Freq == 3&#39;</span><span class="p">)[</span><span class="s1">&#39;Percentage&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>


<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ans: The percentage proportion of policyholders having exactly 3 claims:&#39;</span><span class="p">,</span> <span class="n">ans1_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ans: The percentage proportion of policyholders having exactly 3 claims: 3.6036036036036037
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">claims2010</span> <span class="o">=</span> <span class="n">claims</span><span class="p">[</span><span class="n">claims</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span>  <span class="o">==</span> <span class="mi">2010</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">claims2010</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PolicyNum</th>
      <th>Year</th>
      <th>LnCoverage</th>
      <th>BCcov</th>
      <th>Premium</th>
      <th>Freq</th>
      <th>Deduct</th>
      <th>y</th>
      <th>lny</th>
      <th>yAvg</th>
      <th>...</th>
      <th>TypeCity</th>
      <th>TypeCounty</th>
      <th>TypeMisc</th>
      <th>TypeSchool</th>
      <th>TypeTown</th>
      <th>TypeVillage</th>
      <th>AC00</th>
      <th>AC05</th>
      <th>AC10</th>
      <th>AC15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4</th>
      <td>120002</td>
      <td>2010</td>
      <td>3.157489</td>
      <td>23511493.0</td>
      <td>7994</td>
      <td>1</td>
      <td>1000.0</td>
      <td>6838.87</td>
      <td>8.830378</td>
      <td>6838.87</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>120003</td>
      <td>2010</td>
      <td>4.741850</td>
      <td>114646079.0</td>
      <td>36687</td>
      <td>1</td>
      <td>5000.0</td>
      <td>9711.28</td>
      <td>9.181043</td>
      <td>9711.28</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>14</th>
      <td>120004</td>
      <td>2010</td>
      <td>3.461150</td>
      <td>31853574.0</td>
      <td>17839</td>
      <td>1</td>
      <td>1000.0</td>
      <td>10323.50</td>
      <td>9.242178</td>
      <td>10323.50</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>19</th>
      <td>120005</td>
      <td>2010</td>
      <td>3.487794</td>
      <td>32713698.0</td>
      <td>12431</td>
      <td>0</td>
      <td>5000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>24</th>
      <td>120008</td>
      <td>2010</td>
      <td>3.856969</td>
      <td>47321724.0</td>
      <td>16090</td>
      <td>1</td>
      <td>500.0</td>
      <td>3469.79</td>
      <td>8.151849</td>
      <td>3469.79</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 23 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">claims</span><span class="o">.</span><span class="n">columns</span>

<span class="n">claims</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FrozenList([None])
</pre></div>
</div>
</div>
</div>
<p>This outputs a “FrozenList”, which is just a Pandas specific construct used to show the index label(s) of a DataFrame. Here, we see the value is “None”, as this is the default value of a DataFrame’s index.</p>
<p>To create a MultiIndex with our original DataFrame, all we need to do is pass a list of columns into the .set_index() Pandas function like this:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multi</span> <span class="o">=</span> <span class="n">claims</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span><span class="s1">&#39;Freq&#39;</span><span class="p">])</span>

<span class="n">multi</span><span class="o">.</span><span class="n">tail</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>PolicyNum</th>
      <th>LnCoverage</th>
      <th>BCcov</th>
      <th>Premium</th>
      <th>Deduct</th>
      <th>y</th>
      <th>lny</th>
      <th>yAvg</th>
      <th>lnDeduct</th>
      <th>Fire5</th>
      <th>...</th>
      <th>TypeCity</th>
      <th>TypeCounty</th>
      <th>TypeMisc</th>
      <th>TypeSchool</th>
      <th>TypeTown</th>
      <th>TypeVillage</th>
      <th>AC00</th>
      <th>AC05</th>
      <th>AC10</th>
      <th>AC15</th>
    </tr>
    <tr>
      <th>Year</th>
      <th>Freq</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2006</th>
      <th>0</th>
      <td>180775</td>
      <td>-0.088613</td>
      <td>915200.0</td>
      <td>943</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2007</th>
      <th>0</th>
      <td>180775</td>
      <td>-0.021734</td>
      <td>978500.0</td>
      <td>753</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2008</th>
      <th>0</th>
      <td>180775</td>
      <td>0.011596</td>
      <td>1011664.0</td>
      <td>769</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2009</th>
      <th>0</th>
      <td>180775</td>
      <td>0.049213</td>
      <td>1050444.0</td>
      <td>799</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2010</th>
      <th>0</th>
      <td>180775</td>
      <td>0.022723</td>
      <td>1022983.0</td>
      <td>717</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2006</th>
      <th>0</th>
      <td>180776</td>
      <td>-2.571773</td>
      <td>76400.0</td>
      <td>101</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2007</th>
      <th>0</th>
      <td>180776</td>
      <td>-2.511616</td>
      <td>81137.0</td>
      <td>72</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2008</th>
      <th>0</th>
      <td>180776</td>
      <td>-2.451468</td>
      <td>86167.0</td>
      <td>68</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2009</th>
      <th>0</th>
      <td>180776</td>
      <td>-2.436574</td>
      <td>87460.0</td>
      <td>69</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2010</th>
      <th>0</th>
      <td>180776</td>
      <td>-2.420704</td>
      <td>88859.0</td>
      <td>64</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2006</th>
      <th>0</th>
      <td>180777</td>
      <td>0.973993</td>
      <td>2648500.0</td>
      <td>3152</td>
      <td>1000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.907755</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2007</th>
      <th>0</th>
      <td>180777</td>
      <td>1.119558</td>
      <td>3063500.0</td>
      <td>1807</td>
      <td>1000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.907755</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2008</th>
      <th>0</th>
      <td>180777</td>
      <td>2.114208</td>
      <td>8283020.0</td>
      <td>5384</td>
      <td>1000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.907755</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2009</th>
      <th>0</th>
      <td>180777</td>
      <td>2.157580</td>
      <td>8650181.0</td>
      <td>5277</td>
      <td>1000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.907755</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2010</th>
      <th>1</th>
      <td>180777</td>
      <td>2.145404</td>
      <td>8545496.0</td>
      <td>5554</td>
      <td>1000.0</td>
      <td>20679.58</td>
      <td>9.936902</td>
      <td>20679.58</td>
      <td>6.907755</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2006</th>
      <th>0</th>
      <td>180778</td>
      <td>1.715362</td>
      <td>5558687.0</td>
      <td>5448</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2007</th>
      <th>0</th>
      <td>180778</td>
      <td>1.407991</td>
      <td>4087735.0</td>
      <td>2903</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2008</th>
      <th>0</th>
      <td>180778</td>
      <td>2.047009</td>
      <td>7744705.0</td>
      <td>3872</td>
      <td>5000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>8.517193</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2009</th>
      <th>0</th>
      <td>180778</td>
      <td>2.110863</td>
      <td>8255364.0</td>
      <td>3219</td>
      <td>5000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>8.517193</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2010</th>
      <th>0</th>
      <td>180778</td>
      <td>2.082594</td>
      <td>8025258.0</td>
      <td>3210</td>
      <td>5000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>8.517193</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2007</th>
      <th>1</th>
      <td>180779</td>
      <td>-1.107149</td>
      <td>330500.0</td>
      <td>427</td>
      <td>500.0</td>
      <td>1708.00</td>
      <td>7.443078</td>
      <td>1708.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2008</th>
      <th>0</th>
      <td>180779</td>
      <td>0.901121</td>
      <td>2462363.0</td>
      <td>2118</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2009</th>
      <th>0</th>
      <td>180779</td>
      <td>0.933579</td>
      <td>2543596.0</td>
      <td>2035</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2010</th>
      <th>0</th>
      <td>180779</td>
      <td>0.839066</td>
      <td>2314204.0</td>
      <td>1829</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2007</th>
      <th>0</th>
      <td>180780</td>
      <td>2.768237</td>
      <td>15930517.0</td>
      <td>8921</td>
      <td>5000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>8.517193</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">2008</th>
      <th>0</th>
      <td>180780</td>
      <td>2.768237</td>
      <td>15930517.0</td>
      <td>11629</td>
      <td>5000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>8.517193</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>180781</td>
      <td>-1.386294</td>
      <td>250000.0</td>
      <td>196</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2009</th>
      <th>0</th>
      <td>180781</td>
      <td>-1.363864</td>
      <td>255671.0</td>
      <td>199</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2010</th>
      <th>0</th>
      <td>180781</td>
      <td>-1.316026</td>
      <td>268199.0</td>
      <td>187</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2008</th>
      <th>0</th>
      <td>180782</td>
      <td>-0.517565</td>
      <td>595970.0</td>
      <td>429</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2009</th>
      <th>0</th>
      <td>180782</td>
      <td>-0.504327</td>
      <td>603912.0</td>
      <td>326</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2010</th>
      <th>0</th>
      <td>180782</td>
      <td>-0.542029</td>
      <td>581567.0</td>
      <td>337</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2008</th>
      <th>0</th>
      <td>180783</td>
      <td>-1.722629</td>
      <td>178596.0</td>
      <td>191</td>
      <td>1000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.907755</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2009</th>
      <th>1</th>
      <td>180783</td>
      <td>-1.684199</td>
      <td>185593.0</td>
      <td>143</td>
      <td>1000.0</td>
      <td>11905.40</td>
      <td>9.384747</td>
      <td>11905.40</td>
      <td>6.907755</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2010</th>
      <th>0</th>
      <td>180783</td>
      <td>-1.713239</td>
      <td>180281.0</td>
      <td>147</td>
      <td>1000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.907755</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2008</th>
      <th>0</th>
      <td>180784</td>
      <td>-0.693147</td>
      <td>500000.0</td>
      <td>160</td>
      <td>1000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.907755</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2009</th>
      <th>0</th>
      <td>180784</td>
      <td>-0.088831</td>
      <td>915000.0</td>
      <td>320</td>
      <td>1000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.907755</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2010</th>
      <th>0</th>
      <td>180784</td>
      <td>-0.049608</td>
      <td>951602.0</td>
      <td>362</td>
      <td>1000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.907755</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2008</th>
      <th>0</th>
      <td>180785</td>
      <td>0.000000</td>
      <td>1000000.0</td>
      <td>1120</td>
      <td>1000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.907755</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2009</th>
      <th>0</th>
      <td>180785</td>
      <td>0.893987</td>
      <td>2444859.0</td>
      <td>1076</td>
      <td>1000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.907755</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2010</th>
      <th>0</th>
      <td>180785</td>
      <td>0.844678</td>
      <td>2327228.0</td>
      <td>1094</td>
      <td>1000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.907755</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2009</th>
      <th>0</th>
      <td>180786</td>
      <td>1.963733</td>
      <td>7125879.0</td>
      <td>9192</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2010</th>
      <th>0</th>
      <td>180786</td>
      <td>1.999797</td>
      <td>7387558.0</td>
      <td>5245</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2008</th>
      <th>0</th>
      <td>180787</td>
      <td>-1.609438</td>
      <td>200000.0</td>
      <td>200</td>
      <td>1000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.907755</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2009</th>
      <th>0</th>
      <td>180787</td>
      <td>-2.001133</td>
      <td>135182.0</td>
      <td>92</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">2010</th>
      <th>0</th>
      <td>180787</td>
      <td>-1.255266</td>
      <td>285000.0</td>
      <td>199</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>180788</td>
      <td>6.032462</td>
      <td>416739800.0</td>
      <td>58344</td>
      <td>100000.0</td>
      <td>168304.05</td>
      <td>12.033527</td>
      <td>168304.05</td>
      <td>11.512925</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>180789</td>
      <td>-0.691173</td>
      <td>500988.0</td>
      <td>295</td>
      <td>500.0</td>
      <td>1034.33</td>
      <td>6.941509</td>
      <td>1034.33</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>180790</td>
      <td>1.275549</td>
      <td>3580665.0</td>
      <td>2077</td>
      <td>1000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.907755</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>180791</td>
      <td>-2.130314</td>
      <td>118800.0</td>
      <td>81</td>
      <td>500.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.00</td>
      <td>6.214608</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>50 rows × 21 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multi</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FrozenList([&#39;Year&#39;, &#39;Freq&#39;])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multi</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([(2006, 0), (2007, 0), (2008, 0), ..., (2010, 1), (2010, 0),
       (2010, 0)], dtype=object)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multi</span> <span class="o">=</span> <span class="n">claims</span><span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span><span class="s1">&#39;Freq&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>

<span class="n">multi</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>PolicyNum</th>
      <th>LnCoverage</th>
      <th>BCcov</th>
      <th>Premium</th>
      <th>Deduct</th>
      <th>y</th>
      <th>lny</th>
      <th>yAvg</th>
      <th>lnDeduct</th>
      <th>Fire5</th>
      <th>...</th>
      <th>TypeCity</th>
      <th>TypeCounty</th>
      <th>TypeMisc</th>
      <th>TypeSchool</th>
      <th>TypeTown</th>
      <th>TypeVillage</th>
      <th>AC00</th>
      <th>AC05</th>
      <th>AC10</th>
      <th>AC15</th>
    </tr>
    <tr>
      <th>Year</th>
      <th>Freq</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">2006</th>
      <th>0</th>
      <td>120002</td>
      <td>3.123002</td>
      <td>22714456.0</td>
      <td>9313</td>
      <td>1000.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>6.907755</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>120003</td>
      <td>4.598683</td>
      <td>99353377.0</td>
      <td>40735</td>
      <td>5000.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.517193</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>120005</td>
      <td>3.448799</td>
      <td>31462584.0</td>
      <td>19192</td>
      <td>1000.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>6.907755</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>120009</td>
      <td>4.198984</td>
      <td>66618639.0</td>
      <td>15988</td>
      <td>25000.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.126631</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>0</th>
      <td>120018</td>
      <td>4.621174</td>
      <td>101613238.0</td>
      <td>51823</td>
      <td>5000.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>8.517193</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multi</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Year</th>
      <th>Freq</th>
      <th>PolicyNum</th>
      <th>LnCoverage</th>
      <th>BCcov</th>
      <th>Premium</th>
      <th>Deduct</th>
      <th>y</th>
      <th>lny</th>
      <th>yAvg</th>
      <th>...</th>
      <th>TypeCity</th>
      <th>TypeCounty</th>
      <th>TypeMisc</th>
      <th>TypeSchool</th>
      <th>TypeTown</th>
      <th>TypeVillage</th>
      <th>AC00</th>
      <th>AC05</th>
      <th>AC10</th>
      <th>AC15</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2006</td>
      <td>0</td>
      <td>120002</td>
      <td>3.123002</td>
      <td>2.271446e+07</td>
      <td>9313</td>
      <td>1000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2006</td>
      <td>0</td>
      <td>120003</td>
      <td>4.598683</td>
      <td>9.935338e+07</td>
      <td>40735</td>
      <td>5000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2006</td>
      <td>0</td>
      <td>120005</td>
      <td>3.448799</td>
      <td>3.146258e+07</td>
      <td>19192</td>
      <td>1000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2006</td>
      <td>0</td>
      <td>120009</td>
      <td>4.198984</td>
      <td>6.661864e+07</td>
      <td>15988</td>
      <td>25000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2006</td>
      <td>0</td>
      <td>120018</td>
      <td>4.621174</td>
      <td>1.016132e+08</td>
      <td>51823</td>
      <td>5000.0</td>
      <td>0.00</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>5634</th>
      <td>2010</td>
      <td>19</td>
      <td>120012</td>
      <td>6.344524</td>
      <td>5.693661e+08</td>
      <td>222052</td>
      <td>500.0</td>
      <td>83934.70</td>
      <td>11.337794</td>
      <td>4417.615789</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5635</th>
      <td>2010</td>
      <td>30</td>
      <td>140337</td>
      <td>6.336490</td>
      <td>5.648104e+08</td>
      <td>129907</td>
      <td>25000.0</td>
      <td>759020.97</td>
      <td>13.539785</td>
      <td>25300.699000</td>
      <td>...</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5636</th>
      <td>2010</td>
      <td>39</td>
      <td>120073</td>
      <td>5.492783</td>
      <td>2.429324e+08</td>
      <td>34010</td>
      <td>50000.0</td>
      <td>69943.80</td>
      <td>11.155447</td>
      <td>1793.430769</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5637</th>
      <td>2010</td>
      <td>103</td>
      <td>120030</td>
      <td>7.801717</td>
      <td>2.444797e+09</td>
      <td>391168</td>
      <td>50000.0</td>
      <td>4920530.65</td>
      <td>15.408927</td>
      <td>47772.142230</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>5638</th>
      <td>2010</td>
      <td>239</td>
      <td>138109</td>
      <td>6.338472</td>
      <td>5.659308e+08</td>
      <td>124504</td>
      <td>25000.0</td>
      <td>223784.65</td>
      <td>12.318439</td>
      <td>936.337448</td>
      <td>...</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5639 rows × 23 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multi</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="mi">2010</span><span class="p">,</span><span class="mi">0</span><span class="p">),[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;Deduct&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>y</th>
      <th>Deduct</th>
    </tr>
    <tr>
      <th>Year</th>
      <th>Freq</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="11" valign="top">2010</th>
      <th>0</th>
      <td>0.0</td>
      <td>5000.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>25000.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>500.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>5000.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>5000.0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>500.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>500.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.0</td>
      <td>500.0</td>
    </tr>
  </tbody>
</table>
<p>707 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multi</span><span class="o">.</span><span class="n">loc</span><span class="p">[([</span><span class="mi">2008</span><span class="p">,</span><span class="mi">2010</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]),[</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;Deduct&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>y</th>
      <th>Deduct</th>
    </tr>
    <tr>
      <th>Year</th>
      <th>Freq</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">2008</th>
      <th>0</th>
      <td>0.00</td>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.00</td>
      <td>500.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.00</td>
      <td>5000.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.00</td>
      <td>25000.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0.00</td>
      <td>2500.0</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">2010</th>
      <th>1</th>
      <td>1851.48</td>
      <td>500.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3405.00</td>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>20679.58</td>
      <td>1000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>168304.05</td>
      <td>100000.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1034.33</td>
      <td>500.0</td>
    </tr>
  </tbody>
</table>
<p>1887 rows × 2 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out</span> <span class="o">=</span> <span class="n">claims</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span><span class="s1">&#39;Freq&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">out</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>PolicyNum</th>
      <th>LnCoverage</th>
      <th>BCcov</th>
      <th>Premium</th>
      <th>Deduct</th>
      <th>y</th>
      <th>lny</th>
      <th>yAvg</th>
      <th>lnDeduct</th>
      <th>Fire5</th>
      <th>...</th>
      <th>TypeCity</th>
      <th>TypeCounty</th>
      <th>TypeMisc</th>
      <th>TypeSchool</th>
      <th>TypeTown</th>
      <th>TypeVillage</th>
      <th>AC00</th>
      <th>AC05</th>
      <th>AC10</th>
      <th>AC15</th>
    </tr>
    <tr>
      <th>Year</th>
      <th>Freq</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="5" valign="top">2006</th>
      <th>0</th>
      <td>845</td>
      <td>845</td>
      <td>845</td>
      <td>845</td>
      <td>845</td>
      <td>845</td>
      <td>845</td>
      <td>845</td>
      <td>845</td>
      <td>845</td>
      <td>...</td>
      <td>845</td>
      <td>845</td>
      <td>845</td>
      <td>845</td>
      <td>845</td>
      <td>845</td>
      <td>845</td>
      <td>845</td>
      <td>845</td>
      <td>845</td>
    </tr>
    <tr>
      <th>1</th>
      <td>153</td>
      <td>153</td>
      <td>153</td>
      <td>153</td>
      <td>153</td>
      <td>153</td>
      <td>153</td>
      <td>153</td>
      <td>153</td>
      <td>153</td>
      <td>...</td>
      <td>153</td>
      <td>153</td>
      <td>153</td>
      <td>153</td>
      <td>153</td>
      <td>153</td>
      <td>153</td>
      <td>153</td>
      <td>153</td>
      <td>153</td>
    </tr>
    <tr>
      <th>2</th>
      <td>67</td>
      <td>67</td>
      <td>67</td>
      <td>67</td>
      <td>67</td>
      <td>67</td>
      <td>67</td>
      <td>67</td>
      <td>67</td>
      <td>67</td>
      <td>...</td>
      <td>67</td>
      <td>67</td>
      <td>67</td>
      <td>67</td>
      <td>67</td>
      <td>67</td>
      <td>67</td>
      <td>67</td>
      <td>67</td>
      <td>67</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40</td>
      <td>40</td>
      <td>40</td>
      <td>40</td>
      <td>40</td>
      <td>40</td>
      <td>40</td>
      <td>40</td>
      <td>40</td>
      <td>40</td>
      <td>...</td>
      <td>40</td>
      <td>40</td>
      <td>40</td>
      <td>40</td>
      <td>40</td>
      <td>40</td>
      <td>40</td>
      <td>40</td>
      <td>40</td>
      <td>40</td>
    </tr>
    <tr>
      <th>4</th>
      <td>13</td>
      <td>13</td>
      <td>13</td>
      <td>13</td>
      <td>13</td>
      <td>13</td>
      <td>13</td>
      <td>13</td>
      <td>13</td>
      <td>13</td>
      <td>...</td>
      <td>13</td>
      <td>13</td>
      <td>13</td>
      <td>13</td>
      <td>13</td>
      <td>13</td>
      <td>13</td>
      <td>13</td>
      <td>13</td>
      <td>13</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 21 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MultiIndex([(2006,   0),
            (2006,   1),
            (2006,   2),
            (2006,   3),
            (2006,   4),
            (2006,   5),
            (2006,   6),
            (2006,   7),
            (2006,   8),
            (2006,   9),
            ...
            (2010,  14),
            (2010,  15),
            (2010,  16),
            (2010,  17),
            (2010,  18),
            (2010,  19),
            (2010,  30),
            (2010,  39),
            (2010, 103),
            (2010, 239)],
           names=[&#39;Year&#39;, &#39;Freq&#39;], length=103)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">2006</span><span class="p">,],</span> <span class="s1">&#39;y&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Year  Freq
2006  0       845
      1       153
      2        67
      3        40
      4        13
      5         9
      6         6
      7         1
      8         6
      9         3
      10        3
      11        2
      14        1
      20        1
      24        1
      58        1
      100       1
      208       1
Name: y, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mi">2010</span><span class="p">,],</span> <span class="s1">&#39;y&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Year  Freq
2010  0       707
      1       209
      2        86
      3        40
      4        18
      5        12
      6         9
      7         4
      8         6
      9         1
      10        3
      11        2
      13        1
      14        2
      15        1
      16        2
      17        1
      18        1
      19        1
      30        1
      39        1
      103       1
      239       1
Name: y, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">names</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>FrozenList([&#39;Year&#39;, &#39;Freq&#39;])
</pre></div>
</div>
</div>
</div>
<p>Start here!!!</p>
<p>Again, we pass a tuple in with our desired index values, but instead of adding values for “freq”, we pass <code class="docutils literal notranslate"><span class="pre">slice(None)</span></code>. This is the default <code class="docutils literal notranslate"><span class="pre">slice</span></code> command in Pandas to select all the contents of the MultiIndex level.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out2010</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="mi">2010</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)),:]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out2010</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;PolicyNum&#39;, &#39;LnCoverage&#39;, &#39;BCcov&#39;, &#39;Premium&#39;, &#39;Deduct&#39;, &#39;y&#39;, &#39;lny&#39;,
       &#39;yAvg&#39;, &#39;lnDeduct&#39;, &#39;Fire5&#39;, &#39;NoClaimCredit&#39;, &#39;TypeCity&#39;, &#39;TypeCounty&#39;,
       &#39;TypeMisc&#39;, &#39;TypeSchool&#39;, &#39;TypeTown&#39;, &#39;TypeVillage&#39;, &#39;AC00&#39;, &#39;AC05&#39;,
       &#39;AC10&#39;, &#39;AC15&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="mi">100</span><span class="o">*</span><span class="n">out2010</span><span class="p">[</span><span class="s1">&#39;PolicyNum&#39;</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">out2010</span><span class="p">[</span><span class="s1">&#39;PolicyNum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Year  Freq
2010  0       63.693694
      1       18.828829
      2        7.747748
      3        3.603604
      4        1.621622
      5        1.081081
      6        0.810811
      7        0.360360
      8        0.540541
      9        0.090090
      10       0.270270
      11       0.180180
      13       0.090090
      14       0.180180
      15       0.090090
      16       0.180180
      17       0.090090
      18       0.090090
      19       0.090090
      30       0.090090
      39       0.090090
      103      0.090090
      239      0.090090
Name: PolicyNum, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out2010</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(23, 21)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out2010</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MultiIndex([(2010,   0),
            (2010,   1),
            (2010,   2),
            (2010,   3),
            (2010,   4),
            (2010,   5),
            (2010,   6),
            (2010,   7),
            (2010,   8),
            (2010,   9),
            (2010,  10),
            (2010,  11),
            (2010,  13),
            (2010,  14),
            (2010,  15),
            (2010,  16),
            (2010,  17),
            (2010,  18),
            (2010,  19),
            (2010,  30),
            (2010,  39),
            (2010, 103),
            (2010, 239)],
           names=[&#39;Year&#39;, &#39;Freq&#39;])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">out2010</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="mi">2010</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)),:])[</span><span class="s1">&#39;Proportion&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Year  Freq
2010  0       63.693694
      1       18.828829
      2        7.747748
      3        3.603604
      4        1.621622
      5        1.081081
      6        0.810811
      7        0.360360
      8        0.540541
      9        0.090090
      10       0.270270
      11       0.180180
      13       0.090090
      14       0.180180
      15       0.090090
      16       0.180180
      17       0.090090
      18       0.090090
      19       0.090090
      30       0.090090
      39       0.090090
      103      0.090090
      239      0.090090
Name: Proportion, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">out2010</span><span class="p">[</span><span class="s1">&#39;PolicyNum&#39;</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">out2010</span><span class="p">[</span><span class="s1">&#39;PolicyNum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">()))</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(23,)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out2010</span><span class="p">[</span><span class="s1">&#39;Proportion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="n">out2010</span><span class="p">[</span><span class="s1">&#39;PolicyNum&#39;</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">out2010</span><span class="p">[</span><span class="s1">&#39;PolicyNum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/Kaemyuijang/opt/anaconda3/lib/python3.7/site-packages/ipykernel_launcher.py:1: SettingWithCopyWarning: 
A value is trying to be set on a copy of a slice from a DataFrame.
Try using .loc[row_indexer,col_indexer] = value instead

See the caveats in the documentation: https://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
  &quot;&quot;&quot;Entry point for launching an IPython kernel.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out2010</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;PolicyNum&#39;</span><span class="p">,</span><span class="s1">&#39;Proportion&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>PolicyNum</th>
      <th>Proportion</th>
    </tr>
    <tr>
      <th>Year</th>
      <th>Freq</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="23" valign="top">2010</th>
      <th>0</th>
      <td>707</td>
      <td>63.693694</td>
    </tr>
    <tr>
      <th>1</th>
      <td>209</td>
      <td>18.828829</td>
    </tr>
    <tr>
      <th>2</th>
      <td>86</td>
      <td>7.747748</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40</td>
      <td>3.603604</td>
    </tr>
    <tr>
      <th>4</th>
      <td>18</td>
      <td>1.621622</td>
    </tr>
    <tr>
      <th>5</th>
      <td>12</td>
      <td>1.081081</td>
    </tr>
    <tr>
      <th>6</th>
      <td>9</td>
      <td>0.810811</td>
    </tr>
    <tr>
      <th>7</th>
      <td>4</td>
      <td>0.360360</td>
    </tr>
    <tr>
      <th>8</th>
      <td>6</td>
      <td>0.540541</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>10</th>
      <td>3</td>
      <td>0.270270</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2</td>
      <td>0.180180</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2</td>
      <td>0.180180</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2</td>
      <td>0.180180</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>30</th>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>39</th>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>103</th>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>239</th>
      <td>1</td>
      <td>0.090090</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out2010</span> <span class="o">=</span> <span class="n">out</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="mi">2010</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">)),:]</span>

<span class="n">out2010</span><span class="o">.</span><span class="n">index</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>MultiIndex([(2010,   0),
            (2010,   1),
            (2010,   2),
            (2010,   3),
            (2010,   4),
            (2010,   5),
            (2010,   6),
            (2010,   7),
            (2010,   8),
            (2010,   9),
            (2010,  10),
            (2010,  11),
            (2010,  13),
            (2010,  14),
            (2010,  15),
            (2010,  16),
            (2010,  17),
            (2010,  18),
            (2010,  19),
            (2010,  30),
            (2010,  39),
            (2010, 103),
            (2010, 239)],
           names=[&#39;Year&#39;, &#39;Freq&#39;])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This works pretty simply, but the resulting DataFrames no longer have the multi-index. Also .xs() is not the most powerful way to subset a DataFrame.</span>
<span class="c1"># https://www.somebits.com/~nelson/pandas-multiindex-slice-demo.html</span>


<span class="n">out2010</span> <span class="o">=</span> <span class="p">(</span><span class="n">out</span><span class="o">.</span><span class="n">xs</span><span class="p">(</span><span class="mi">2010</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">out2010</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
<span class="n">out2010</span><span class="p">[</span><span class="s1">&#39;Proportion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="n">out2010</span><span class="p">[</span><span class="s1">&#39;PolicyNum&#39;</span><span class="p">]</span><span class="o">/</span><span class="p">(</span><span class="n">out2010</span><span class="p">[</span><span class="s1">&#39;PolicyNum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="n">out2010</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;PolicyNum&#39;</span><span class="p">,</span><span class="s1">&#39;Proportion&#39;</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Int64Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,  10,  11,  13,
             14,  15,  16,  17,  18,  19,  30,  39, 103, 239],
           dtype=&#39;int64&#39;, name=&#39;Freq&#39;)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PolicyNum</th>
      <th>Proportion</th>
    </tr>
    <tr>
      <th>Freq</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>707</td>
      <td>63.693694</td>
    </tr>
    <tr>
      <th>1</th>
      <td>209</td>
      <td>18.828829</td>
    </tr>
    <tr>
      <th>2</th>
      <td>86</td>
      <td>7.747748</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40</td>
      <td>3.603604</td>
    </tr>
    <tr>
      <th>4</th>
      <td>18</td>
      <td>1.621622</td>
    </tr>
    <tr>
      <th>5</th>
      <td>12</td>
      <td>1.081081</td>
    </tr>
    <tr>
      <th>6</th>
      <td>9</td>
      <td>0.810811</td>
    </tr>
    <tr>
      <th>7</th>
      <td>4</td>
      <td>0.360360</td>
    </tr>
    <tr>
      <th>8</th>
      <td>6</td>
      <td>0.540541</td>
    </tr>
    <tr>
      <th>9</th>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>10</th>
      <td>3</td>
      <td>0.270270</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2</td>
      <td>0.180180</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2</td>
      <td>0.180180</td>
    </tr>
    <tr>
      <th>15</th>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>16</th>
      <td>2</td>
      <td>0.180180</td>
    </tr>
    <tr>
      <th>17</th>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>18</th>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>19</th>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>30</th>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>39</th>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>103</th>
      <td>1</td>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>239</th>
      <td>1</td>
      <td>0.090090</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="next-attempt">
<h2>Next attempt<a class="headerlink" href="#next-attempt" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">table1</span> <span class="o">=</span> <span class="n">claims</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span><span class="s1">&#39;Freq&#39;</span><span class="p">,</span><span class="s1">&#39;PolicyNum&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">by</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span><span class="s1">&#39;Freq&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="c1">#table1[&#39;PolicyNum&#39;]</span>

<span class="c1">#print(table1.loc[(2006,),:])</span>

<span class="c1">#print(table1.head())</span>

<span class="n">table1</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>

<span class="n">table1</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="mi">2006</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">kl</span><span class="o">/</span><span class="n">h_r05n_j76n32kt0dwy7kynw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_758</span><span class="o">/</span><span class="mf">1025270685.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">     </span><span class="mi">10</span> <span class="n">table1</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="mi">2006</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))]</span>
<span class="g g-Whitespace">     </span><span class="mi">11</span> 
<span class="ne">---&gt; </span><span class="mi">12</span> <span class="n">table1</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">names</span>

<span class="nn">~/opt/anaconda3/lib/python3.7/site-packages/pandas/core/groupby/groupby.py</span> in <span class="ni">__getattr__</span><span class="nt">(self, attr)</span>
<span class="g g-Whitespace">    </span><span class="mi">910</span> 
<span class="g g-Whitespace">    </span><span class="mi">911</span>         <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span>
<span class="ne">--&gt; </span><span class="mi">912</span>             <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">&#39; object has no attribute &#39;</span><span class="si">{</span><span class="n">attr</span><span class="si">}</span><span class="s2">&#39;&quot;</span>
<span class="g g-Whitespace">    </span><span class="mi">913</span>         <span class="p">)</span>
<span class="g g-Whitespace">    </span><span class="mi">914</span> 

<span class="ne">AttributeError</span>: &#39;DataFrameGroupBy&#39; object has no attribute &#39;names&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="pivot">
<h2>Pivot<a class="headerlink" href="#pivot" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">claims</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">100</span><span class="o">*</span><span class="n">x</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">/</span><span class="mi">1110</span>
<span class="n">claims</span><span class="o">.</span><span class="n">pivot_table</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="s1">&#39;Freq&#39;</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="s1">&#39;Year&#39;</span><span class="p">,</span> <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;PolicyNum&#39;</span><span class="p">,</span><span class="s1">&#39;PolicyNum&#39;</span><span class="p">],</span> <span class="n">aggfunc</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;count&#39;</span><span class="p">,</span><span class="s1">&#39;sum&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;PolicyNum&#39;, &#39;Year&#39;, &#39;LnCoverage&#39;, &#39;BCcov&#39;, &#39;Premium&#39;, &#39;Freq&#39;, &#39;Deduct&#39;,
       &#39;y&#39;, &#39;lny&#39;, &#39;yAvg&#39;, &#39;lnDeduct&#39;, &#39;Fire5&#39;, &#39;NoClaimCredit&#39;, &#39;TypeCity&#39;,
       &#39;TypeCounty&#39;, &#39;TypeMisc&#39;, &#39;TypeSchool&#39;, &#39;TypeTown&#39;, &#39;TypeVillage&#39;,
       &#39;AC00&#39;, &#39;AC05&#39;, &#39;AC10&#39;, &#39;AC15&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="10" halign="left">count</th>
      <th colspan="10" halign="left">sum</th>
    </tr>
    <tr>
      <th></th>
      <th colspan="10" halign="left">PolicyNum</th>
      <th colspan="10" halign="left">PolicyNum</th>
    </tr>
    <tr>
      <th>Year</th>
      <th>2006</th>
      <th>2007</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2006</th>
      <th>2007</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2006</th>
      <th>2007</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2006</th>
      <th>2007</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
    </tr>
    <tr>
      <th>Freq</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>845.0</td>
      <td>781.0</td>
      <td>816.0</td>
      <td>811.0</td>
      <td>707.0</td>
      <td>845.0</td>
      <td>781.0</td>
      <td>816.0</td>
      <td>811.0</td>
      <td>707.0</td>
      <td>128120929.0</td>
      <td>118356957.0</td>
      <td>123683769.0</td>
      <td>122515551.0</td>
      <td>107578625.0</td>
      <td>128120929.0</td>
      <td>118356957.0</td>
      <td>123683769.0</td>
      <td>122515551.0</td>
      <td>107578625.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>153.0</td>
      <td>146.0</td>
      <td>155.0</td>
      <td>155.0</td>
      <td>209.0</td>
      <td>153.0</td>
      <td>146.0</td>
      <td>155.0</td>
      <td>155.0</td>
      <td>209.0</td>
      <td>22363064.0</td>
      <td>21543573.0</td>
      <td>22463355.0</td>
      <td>22570967.0</td>
      <td>30622820.0</td>
      <td>22363064.0</td>
      <td>21543573.0</td>
      <td>22463355.0</td>
      <td>22570967.0</td>
      <td>30622820.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>67.0</td>
      <td>92.0</td>
      <td>56.0</td>
      <td>69.0</td>
      <td>86.0</td>
      <td>67.0</td>
      <td>92.0</td>
      <td>56.0</td>
      <td>69.0</td>
      <td>86.0</td>
      <td>9323165.0</td>
      <td>13129860.0</td>
      <td>7887718.0</td>
      <td>9704785.0</td>
      <td>12327094.0</td>
      <td>9323165.0</td>
      <td>13129860.0</td>
      <td>7887718.0</td>
      <td>9704785.0</td>
      <td>12327094.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>40.0</td>
      <td>47.0</td>
      <td>41.0</td>
      <td>26.0</td>
      <td>40.0</td>
      <td>40.0</td>
      <td>47.0</td>
      <td>41.0</td>
      <td>26.0</td>
      <td>40.0</td>
      <td>5555410.0</td>
      <td>6640726.0</td>
      <td>5846984.0</td>
      <td>3649431.0</td>
      <td>5491245.0</td>
      <td>5555410.0</td>
      <td>6640726.0</td>
      <td>5846984.0</td>
      <td>3649431.0</td>
      <td>5491245.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>13.0</td>
      <td>27.0</td>
      <td>24.0</td>
      <td>17.0</td>
      <td>18.0</td>
      <td>13.0</td>
      <td>27.0</td>
      <td>24.0</td>
      <td>17.0</td>
      <td>18.0</td>
      <td>1777283.0</td>
      <td>3686829.0</td>
      <td>3314391.0</td>
      <td>2294512.0</td>
      <td>2429317.0</td>
      <td>1777283.0</td>
      <td>3686829.0</td>
      <td>3314391.0</td>
      <td>2294512.0</td>
      <td>2429317.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>9.0</td>
      <td>15.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>12.0</td>
      <td>9.0</td>
      <td>15.0</td>
      <td>6.0</td>
      <td>11.0</td>
      <td>12.0</td>
      <td>1177345.0</td>
      <td>2076403.0</td>
      <td>814762.0</td>
      <td>1498678.0</td>
      <td>1635226.0</td>
      <td>1177345.0</td>
      <td>2076403.0</td>
      <td>814762.0</td>
      <td>1498678.0</td>
      <td>1635226.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6.0</td>
      <td>6.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>9.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>9.0</td>
      <td>801638.0</td>
      <td>838125.0</td>
      <td>683054.0</td>
      <td>120015.0</td>
      <td>1199608.0</td>
      <td>801638.0</td>
      <td>838125.0</td>
      <td>683054.0</td>
      <td>120015.0</td>
      <td>1199608.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1.0</td>
      <td>8.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>8.0</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>138124.0</td>
      <td>1080528.0</td>
      <td>699238.0</td>
      <td>561538.0</td>
      <td>498474.0</td>
      <td>138124.0</td>
      <td>1080528.0</td>
      <td>699238.0</td>
      <td>561538.0</td>
      <td>498474.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>6.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>4.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>6.0</td>
      <td>800723.0</td>
      <td>500163.0</td>
      <td>240116.0</td>
      <td>280571.0</td>
      <td>922786.0</td>
      <td>800723.0</td>
      <td>500163.0</td>
      <td>240116.0</td>
      <td>280571.0</td>
      <td>922786.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>3.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>418587.0</td>
      <td>140249.0</td>
      <td>260095.0</td>
      <td>280145.0</td>
      <td>120070.0</td>
      <td>418587.0</td>
      <td>140249.0</td>
      <td>260095.0</td>
      <td>280145.0</td>
      <td>120070.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>3.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>NaN</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>398471.0</td>
      <td>NaN</td>
      <td>400703.0</td>
      <td>280380.0</td>
      <td>411036.0</td>
      <td>398471.0</td>
      <td>NaN</td>
      <td>400703.0</td>
      <td>280380.0</td>
      <td>411036.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>2.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>280790.0</td>
      <td>NaN</td>
      <td>120012.0</td>
      <td>120058.0</td>
      <td>258173.0</td>
      <td>280790.0</td>
      <td>NaN</td>
      <td>120012.0</td>
      <td>120058.0</td>
      <td>258173.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>140631.0</td>
      <td>140073.0</td>
      <td>120070.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>140631.0</td>
      <td>140073.0</td>
      <td>120070.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>13</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>140249.0</td>
      <td>140249.0</td>
      <td>140770.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>140249.0</td>
      <td>140249.0</td>
      <td>140770.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>120067.0</td>
      <td>140590.0</td>
      <td>120067.0</td>
      <td>NaN</td>
      <td>258255.0</td>
      <td>120067.0</td>
      <td>140590.0</td>
      <td>120067.0</td>
      <td>NaN</td>
      <td>258255.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>120012.0</td>
      <td>NaN</td>
      <td>281107.0</td>
      <td>140430.0</td>
      <td>NaN</td>
      <td>120012.0</td>
      <td>NaN</td>
      <td>281107.0</td>
      <td>140430.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>NaN</td>
      <td>281070.0</td>
      <td>NaN</td>
      <td>132798.0</td>
      <td>272878.0</td>
      <td>NaN</td>
      <td>281070.0</td>
      <td>NaN</td>
      <td>132798.0</td>
      <td>272878.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>140337.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>120067.0</td>
      <td>NaN</td>
      <td>140337.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>120067.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>120067.0</td>
      <td>280637.0</td>
      <td>120067.0</td>
      <td>140300.0</td>
      <td>NaN</td>
      <td>120067.0</td>
      <td>280637.0</td>
      <td>120067.0</td>
      <td>140300.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>120012.0</td>
      <td>120012.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>120012.0</td>
      <td>120012.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>120012.0</td>
      <td>NaN</td>
      <td>140770.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>120012.0</td>
      <td>NaN</td>
      <td>140770.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>21</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>120073.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>120073.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>24</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>140770.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>140770.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>26</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>140080.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>140080.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>30</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>140337.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>140337.0</td>
    </tr>
    <tr>
      <th>38</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>132798.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>132798.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>39</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>120073.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>120073.0</td>
    </tr>
    <tr>
      <th>55</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>132798.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>132798.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>58</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>132798.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>132798.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>67</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>120030.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>120030.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>100</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>120030.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>120030.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>103</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>120030.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>120030.0</td>
    </tr>
    <tr>
      <th>143</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>140827.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>140827.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>157</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>120030.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>120030.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>208</th>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>138109.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>138109.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>212</th>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>138109.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>138109.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>223</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>138109.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>138109.0</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>228</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>120030.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>120030.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>239</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>138109.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>138109.0</td>
    </tr>
    <tr>
      <th>263</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>138109.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>138109.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="groupby">
<h2>Groupby<a class="headerlink" href="#groupby" title="Permalink to this headline">¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">claims</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span><span class="s1">&#39;Freq&#39;</span><span class="p">])[</span><span class="s1">&#39;PolicyNum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="n">claims</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span><span class="s1">&#39;Freq&#39;</span><span class="p">])[</span><span class="s1">&#39;PolicyNum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="n">claims</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span><span class="s1">&#39;Freq&#39;</span><span class="p">])[</span><span class="s1">&#39;PolicyNum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="mi">2010</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))]</span><span class="o">/</span><span class="n">claims</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span><span class="s1">&#39;Freq&#39;</span><span class="p">])[</span><span class="s1">&#39;PolicyNum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()[</span><span class="mi">2010</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Year  Freq
2006  0       845
      1       153
      2        67
      3        40
      4        13
             ... 
2010  19        1
      30        1
      39        1
      103       1
      239       1
Name: PolicyNum, Length: 103, dtype: int64
Year
2006    1154
2007    1138
2008    1125
2009    1112
2010    1110
Name: PolicyNum, dtype: int64
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Year  Freq
2010  0       63.693694
      1       18.828829
      2        7.747748
      3        3.603604
      4        1.621622
      5        1.081081
      6        0.810811
      7        0.360360
      8        0.540541
      9        0.090090
      10       0.270270
      11       0.180180
      13       0.090090
      14       0.180180
      15       0.090090
      16       0.180180
      17       0.090090
      18       0.090090
      19       0.090090
      30       0.090090
      39       0.090090
      103      0.090090
      239      0.090090
Name: PolicyNum, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># not working</span>

<span class="n">output</span> <span class="o">=</span> <span class="n">claims</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span><span class="s1">&#39;Freq&#39;</span><span class="p">])[</span><span class="s1">&#39;PolicyNum&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">()</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;Percentage&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
<span class="n">output</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Year  Freq
2006  0       0.149849
      1       0.027132
      2       0.011882
      3       0.007093
      4       0.002305
                ...   
2010  19      0.000177
      30      0.000177
      39      0.000177
      103     0.000177
      239     0.000177
Name: Percentage, Length: 103, dtype: float64
</pre></div>
</div>
</div>
</div>
</section>
<section id="last-attempt">
<h2>Last Attempt:<a class="headerlink" href="#last-attempt" title="Permalink to this headline">¶</a></h2>
<p>To determine the (percentage) proportion of policies for each claim frequency, we will first group the “Year” and “Freq”.   To calculate the percentage <strong>within each “Year” group</strong>, the following command can be used groupby(level=0).apply(lambda x: 100*x/x.sum())</p>
<p><strong>Note:</strong> Because the original dataframe becomes a multiple index dataframe after grouping, the level = 0 refers to the top level index, which in our case is ‘Year’.</p>
<p>You can see the results below, which have already been sorted by percent of sales contribution for each sales person.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Table1 = claims.groupby([&#39;Year&#39;,&#39;Freq&#39;]).agg({&#39;PolicyNum&#39; : &#39;count&#39;}).groupby(level=&#39;Year&#39;).apply(lambda x: 100*x/x.sum())</span>

<span class="n">Table1</span> <span class="o">=</span> <span class="n">claims</span><span class="o">.</span><span class="n">groupby</span><span class="p">([</span><span class="s1">&#39;Year&#39;</span><span class="p">,</span><span class="s1">&#39;Freq&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;PolicyNum&#39;</span> <span class="p">:</span> <span class="s1">&#39;count&#39;</span><span class="p">})</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="mi">100</span><span class="o">*</span><span class="n">x</span><span class="o">/</span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="n">Table1</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;PolicyNum&#39;</span><span class="p">:</span><span class="s1">&#39;Percentage&#39;</span><span class="p">})</span>

<span class="n">Table1</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="mi">2010</span><span class="p">,</span><span class="nb">slice</span><span class="p">(</span><span class="kc">None</span><span class="p">))]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>PolicyNum</th>
    </tr>
    <tr>
      <th>Freq</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>63.693694</td>
    </tr>
    <tr>
      <th>1</th>
      <td>18.828829</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.747748</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.603604</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.621622</td>
    </tr>
    <tr>
      <th>5</th>
      <td>1.081081</td>
    </tr>
    <tr>
      <th>6</th>
      <td>0.810811</td>
    </tr>
    <tr>
      <th>7</th>
      <td>0.360360</td>
    </tr>
    <tr>
      <th>8</th>
      <td>0.540541</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>10</th>
      <td>0.270270</td>
    </tr>
    <tr>
      <th>11</th>
      <td>0.180180</td>
    </tr>
    <tr>
      <th>13</th>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>14</th>
      <td>0.180180</td>
    </tr>
    <tr>
      <th>15</th>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>16</th>
      <td>0.180180</td>
    </tr>
    <tr>
      <th>17</th>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>18</th>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>19</th>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>30</th>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>39</th>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>103</th>
      <td>0.090090</td>
    </tr>
    <tr>
      <th>239</th>
      <td>0.090090</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<ol class="simple">
<li><p>From those 403 policyholders who made at least one claim, create a table that provides information about the distribution of average claim amounts in year 2010.</p></li>
</ol>
<p>2.1. What is the mean of the average claim amounts?</p>
<p>2.2. What is the third quartile of the average claim amounts?</p>
<p>First, we add the column, namely <code class="docutils literal notranslate"><span class="pre">ClaimsAvg</span></code> representing the average cost per claim for each observation. The average cost per claim (or claim average) amount is calculated by dividing the number of claims  by the total claim amount.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">claims</span><span class="p">[</span><span class="s1">&#39;ClaimsAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">claims</span><span class="p">[</span><span class="s1">&#39;y&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">claims</span><span class="p">[</span><span class="s1">&#39;Freq&#39;</span><span class="p">]</span>
<span class="n">claims</span><span class="p">[</span><span class="s1">&#39;ClaimsAvg&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">claims</span><span class="p">[</span><span class="s1">&#39;ClaimsAvg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">claims</span><span class="p">[</span><span class="s1">&#39;ClaimsAvg&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0            0.00
1            0.00
2            0.00
3            0.00
4         6838.87
          ...    
5634         0.00
5635    168304.05
5636      1034.33
5637         0.00
5638         0.00
Name: ClaimsAvg, Length: 5639, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>The information about the distribution of average claim amounts in year 2010 is given in the table below including count, mean, std, min, 25, 50, 75% percentiles and max.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#claimsFreqDist.query(&#39;Year == 2010 &amp; Freq &gt;= 1&#39;)</span>



<span class="c1">#claims[[&#39;Year&#39;,&#39;y&#39;,&#39;Freq&#39;]][0:10]</span>
<span class="c1">#claims[(claims[&#39;Year&#39;]==2010) &amp;  (claims[&#39;Freq&#39;] &gt;= 1)][&#39;y&#39;].describe()</span>
<span class="n">claims</span><span class="p">[(</span><span class="n">claims</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2010</span><span class="p">)</span> <span class="o">&amp;</span>  <span class="p">(</span><span class="n">claims</span><span class="p">[</span><span class="s1">&#39;Freq&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)][</span><span class="s1">&#39;ClaimsAvg&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>count    4.030000e+02
mean     5.633195e+04
std      6.507344e+05
min      1.666667e+02
25%      2.225760e+03
50%      4.951000e+03
75%      1.190050e+04
max      1.292222e+07
Name: ClaimsAvg, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>2.1. What is the mean of the average claim amounts?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the mean of the average claim amounts</span>

<span class="p">(</span><span class="n">claims</span><span class="p">[(</span><span class="n">claims</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2010</span><span class="p">)</span> <span class="o">&amp;</span>  <span class="p">(</span><span class="n">claims</span><span class="p">[</span><span class="s1">&#39;Freq&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)][</span><span class="s1">&#39;ClaimsAvg&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="n">ans2_1</span> <span class="o">=</span> <span class="p">(</span><span class="n">claims</span><span class="p">[(</span><span class="n">claims</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2010</span><span class="p">)</span> <span class="o">&amp;</span>  <span class="p">(</span><span class="n">claims</span><span class="p">[</span><span class="s1">&#39;Freq&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)][</span><span class="s1">&#39;ClaimsAvg&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ans: The mean of the average claim amounts: &#39;</span><span class="p">,</span> <span class="n">ans2_1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ans: The mean of the average claim amounts:  56331.94660006498
</pre></div>
</div>
</div>
</div>
<p>2.2 What is the third quartile of the average claim amounts?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the third quartile of the average claim amounts</span>
<span class="p">(</span><span class="n">claims</span><span class="p">[(</span><span class="n">claims</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2010</span><span class="p">)</span> <span class="o">&amp;</span>  <span class="p">(</span><span class="n">claims</span><span class="p">[</span><span class="s1">&#39;Freq&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)][</span><span class="s1">&#39;ClaimsAvg&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span>

<span class="n">ans2_2</span> <span class="o">=</span> <span class="p">(</span><span class="n">claims</span><span class="p">[(</span><span class="n">claims</span><span class="p">[</span><span class="s1">&#39;Year&#39;</span><span class="p">]</span><span class="o">==</span><span class="mi">2010</span><span class="p">)</span> <span class="o">&amp;</span>  <span class="p">(</span><span class="n">claims</span><span class="p">[</span><span class="s1">&#39;Freq&#39;</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="mi">1</span><span class="p">)][</span><span class="s1">&#39;ClaimsAvg&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">quantile</span><span class="p">(</span><span class="n">q</span> <span class="o">=</span> <span class="mf">0.75</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Ans: the third quartile of the average claim amounts:&#39;</span><span class="p">,</span> <span class="n">ans2_2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Ans: the third quartile of the average claim amounts: 11900.5
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the mean of the average claim amounts</span>

<span class="c1"># (claims[(claims[&#39;Year&#39;]==2010) &amp;  (claims[&#39;Freq&#39;] &gt;= 1)][&#39;yAvg&#39;]).mean()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the third quartile of the average claim amounts</span>
<span class="c1"># (claims[(claims[&#39;Year&#39;]==2010) &amp;  (claims[&#39;Freq&#39;] &gt;= 1)][&#39;yAvg&#39;]).quantile(q = 0.75)</span>
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Consider the claims data over the 5 years between 2006-2010 inclusive. Create a table that show the average claim varies over time, average frequency, average coverage and the number of policyholders.</p></li>
</ol>
<p>3.1 What can you say about the number of policyholders over this period?</p>
<p>3.2 How does the average coverage change over this period?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">claims</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;PolicyNum&#39;, &#39;Year&#39;, &#39;LnCoverage&#39;, &#39;BCcov&#39;, &#39;Premium&#39;, &#39;Freq&#39;, &#39;Deduct&#39;,
       &#39;y&#39;, &#39;lny&#39;, &#39;yAvg&#39;, &#39;lnDeduct&#39;, &#39;Fire5&#39;, &#39;NoClaimCredit&#39;, &#39;TypeCity&#39;,
       &#39;TypeCounty&#39;, &#39;TypeMisc&#39;, &#39;TypeSchool&#39;, &#39;TypeTown&#39;, &#39;TypeVillage&#39;,
       &#39;AC00&#39;, &#39;AC05&#39;, &#39;AC10&#39;, &#39;AC15&#39;, &#39;ClaimsAvg&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">claims</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">agg</span><span class="p">({</span><span class="s1">&#39;Freq&#39;</span><span class="p">:</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;ClaimsAvg&#39;</span><span class="p">:</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;BCcov&#39;</span><span class="p">:</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;PolicyNum&#39;</span><span class="p">:</span><span class="s1">&#39;count&#39;</span> <span class="p">})</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Freq</th>
      <th>ClaimsAvg</th>
      <th>BCcov</th>
      <th>PolicyNum</th>
    </tr>
    <tr>
      <th>Year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2006</th>
      <td>0.951473</td>
      <td>9694.992379</td>
      <td>3.249819e+07</td>
      <td>1154</td>
    </tr>
    <tr>
      <th>2007</th>
      <td>1.166960</td>
      <td>6543.947626</td>
      <td>3.527595e+07</td>
      <td>1138</td>
    </tr>
    <tr>
      <th>2008</th>
      <td>0.974222</td>
      <td>5310.505387</td>
      <td>3.726748e+07</td>
      <td>1125</td>
    </tr>
    <tr>
      <th>2009</th>
      <td>1.219424</td>
      <td>4571.949986</td>
      <td>4.035538e+07</td>
      <td>1112</td>
    </tr>
    <tr>
      <th>2010</th>
      <td>1.240541</td>
      <td>20452.049081</td>
      <td>4.124207e+07</td>
      <td>1110</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># claims.groupby(&#39;Year&#39;).agg({&#39;Freq&#39;:&#39;mean&#39;, &#39;yAvg&#39;:&#39;mean&#39;, &#39;BCcov&#39;:&#39;mean&#39;, &#39;PolicyNum&#39;:&#39;count&#39; })</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>The table shows that the average claim varies over time, especially with the high 2010 value (that we saw was due to a single large claim).</p></li>
<li><p>The total number of policyholders is steadily declining and, conversely, the coverage is steadily increasing (<strong>Answers of Questions 3.1 and 3.2</strong>).</p></li>
<li><p>The coverage variable is the amount of coverage of the property and contents. Roughly, you can think of it as the maximum possible payout of the insurer.</p></li>
</ol>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Demo"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Pairote Satiracoo<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>