
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Exercise Chapter 6 &#8212; SCMA248 Introduction to Data Science</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">SCMA248 Introduction to Data Science</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Welcome to SCMA248 Introduction to Data Science
  </a>
 </li>
</ul>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter1_Introduction_to_Data_Science.html">
   1. Introduction to Data Science
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter2_Python_Basics.html">
   2. Python Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter3_Data_Preparation.html">
   3. Data Selection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter4_Data_Visualization.html">
   6. Data Visualization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter5_Practical_Statistics.html">
   7. Practical Statistics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter6_Regression.html">
   8. Regression Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter7_Introduction_Machine_Learning.html">
   9. Machine learning: Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../Chapter8_Unsupervised_Learning.html">
   10. Unsupervised Machine Learning: K-means Clustering
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/Exercises/Exercise_Chapter6_Solution-Copy1.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FExercises/Exercise_Chapter6_Solution-Copy1.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/Exercises/Exercise_Chapter6_Solution-Copy1.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Exercise Chapter 6
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#problem-statement">
     Problem Statement
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#regression-problems">
     Regression problems
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-1-import-the-packages">
       Step 1: Import the packages
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-2-provide-data-to-work-with-and-possibly-perform-appropriate-transformations">
       Step 2: Provide data to work with and possibly perform appropriate transformations.
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#data-preprocessing-and-feature-engineering">
         2.1 Data Preprocessing and Feature Engineering
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#missing-values">
         2.2 Missing values
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#handling-outliers">
         2.3 Handling Outliers
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#scaling">
         2.4 Scaling
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#correlation-analysis">
         2.5 Correlation Analysis
        </a>
       </li>
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#exploratory-data-analysis">
         2.6 Exploratory data analysis
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-3-create-a-regression-model-and-fit-it-with-the-available-data">
       Step 3: Create a regression model and fit it with the available data.
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h4 nav-item toc-entry">
        <a class="reference internal nav-link" href="#split-the-data-into-training-and-test-subset">
         3.1 Split the data into training and test subset
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-4-get-results">
       Step 4: Get results
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#step-5-predict-response">
       Step 5: Predict response
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#let-s-visualise-the-data-with-a-scatter-plot-and-the-fitted-regression-line">
   Let’s visualise the data with a scatter plot and the fitted regression line
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id1">
   Let’s visualise the data with a scatter plot and the fitted regression line
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="exercise-chapter-6">
<h1>Exercise Chapter 6<a class="headerlink" href="#exercise-chapter-6" title="Permalink to this headline">¶</a></h1>
<section id="problem-statement">
<h2>Problem Statement<a class="headerlink" href="#problem-statement" title="Permalink to this headline">¶</a></h2>
<p>An automobile company wants to enter the U.S. market by setting up a manufacturing plant there and producing cars locally to compete with its American and European competitors.</p>
<p>The company has hired an automotive consulting firm to understand the factors on which car pricing depends. Specifically, the company wants to understand the factors that affect car pricing in the U.S. market, as these can be very different from those in the Chinese market. The company wants to know:</p>
<p>What variables are important in predicting the price of a car.
How well these variables describe the price of a car
Based on various market surveys, the consulting firm has gathered a large data set on different types of cars in the American market.</p>
</section>
<section id="regression-problems">
<h2>Regression problems<a class="headerlink" href="#regression-problems" title="Permalink to this headline">¶</a></h2>
<p>There are five basic steps when you implement linear regression:</p>
<ol class="simple">
<li><p>Import the packages and classes you need.</p></li>
<li><p>Provide data to work with and possibly perform appropriate transformations.</p></li>
<li><p>Create a regression model and fit it with the available data.</p></li>
<li><p>Review the results of the model fit to know if the model is satisfactory.</p></li>
<li><p>Apply the model for predictions.</p></li>
</ol>
<p>These steps are more or less general to most regression approaches and implementations.</p>
<section id="step-1-import-the-packages">
<h3>Step 1: Import the packages<a class="headerlink" href="#step-1-import-the-packages" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>

<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">math</span> <span class="k">as</span> <span class="nn">m</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">mean_squared_error</span><span class="p">,</span><span class="n">mean_absolute_error</span><span class="p">,</span><span class="n">r2_score</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">pearsonr</span><span class="p">,</span><span class="n">spearmanr</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">MinMaxScaler</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">preprocessing</span>
<span class="kn">from</span> <span class="nn">sklearn.base</span> <span class="kn">import</span> <span class="n">TransformerMixin</span>

<span class="kn">from</span> <span class="nn">plotnine</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">kl</span><span class="o">/</span><span class="n">h_r05n_j76n32kt0dwy7kynw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_5937</span><span class="o">/</span><span class="mf">1890615696.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">3</span> 
<span class="ne">----&gt; </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> 
<span class="g g-Whitespace">      </span><span class="mi">6</span> <span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="o">*</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;statsmodels&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="step-2-provide-data-to-work-with-and-possibly-perform-appropriate-transformations">
<h3>Step 2: Provide data to work with and possibly perform appropriate transformations.<a class="headerlink" href="#step-2-provide-data-to-work-with-and-possibly-perform-appropriate-transformations" title="Permalink to this headline">¶</a></h3>
<ol class="simple">
<li><p>Download the following dataset, CarPrice_Assignment.csv, from this Kaggle link (save this data frame as Pandas DataFrame):</p></li>
</ol>
<p><a class="reference external" href="https://www.kaggle.com/datasets/hellbuoy/car-price-prediction">https://www.kaggle.com/datasets/hellbuoy/car-price-prediction</a></p>
<p>or from my personal Github page.</p>
<p><a class="reference external" href="https://raw.githubusercontent.com/pairote-sat/SCMA248/main/Data/CarPrice_Assignment.csv">https://raw.githubusercontent.com/pairote-sat/SCMA248/main/Data/CarPrice_Assignment.csv</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">url</span> <span class="o">=</span> <span class="s1">&#39;https://raw.githubusercontent.com/pairote-sat/SCMA248/main/Data/CarPrice_Assignment.csv&#39;</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df.info()</span>
</pre></div>
</div>
</div>
</div>
<section id="data-preprocessing-and-feature-engineering">
<h4>2.1 Data Preprocessing and Feature Engineering<a class="headerlink" href="#data-preprocessing-and-feature-engineering" title="Permalink to this headline">¶</a></h4>
<p><strong>What is data preprocessing?</strong></p>
<p>It is a technique used to transform raw data into more meaningful data, or data that can be understood by a machine learning model. Real-world data is often incomplete, inconsistent, and/or lacks certain behaviors or trends and is likely to contain many errors. To address this problem, data preprocessing techniques are introduced. We will talk about some of the data preprocessing techniques, namely :
Vectorization
Normalization
Treatment of missing values</p>
<p><strong>What is Feature engineering?</strong></p>
<p>Feature engineering is the process of selecting, manipulating, and transforming raw data into features that can be used in supervised learning.</p>
<p>In order for machine learning to work well on new tasks, it may be necessary to develop and train better features.</p>
<p>Feature engineering, in simple terms, is the transformation of raw data into desired features using statistical or machine learning techniques.</p>
</section>
<section id="missing-values">
<h4>2.2 Missing values<a class="headerlink" href="#missing-values" title="Permalink to this headline">¶</a></h4>
<p>When it comes to preparing your data for machine learning, missing values are one of the most typical problems. Human error, data flow interruptions, privacy concerns, and other factors can lead to missing values. Missing values, for whatever reason, affect the performance of machine learning models.</p>
<ol class="simple">
<li><p>Write python code to check whether any missing values are there in the dataset.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>car_ID              0
symboling           0
CarName             0
fueltype            0
aspiration          0
doornumber          0
carbody             0
drivewheel          0
enginelocation      0
wheelbase           0
carlength           0
carwidth            0
carheight           0
curbweight          0
enginetype          0
cylindernumber      0
enginesize          0
fuelsystem          0
boreratio           0
stroke              0
compressionratio    0
horsepower          0
peakrpm             0
citympg             0
highwaympg          0
price               0
dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="handling-outliers">
<h4>2.3 Handling Outliers<a class="headerlink" href="#handling-outliers" title="Permalink to this headline">¶</a></h4>
<p>Outlier treatment is a technique for removing outliers from a data set. This method can be used on a variety of scales to obtain a more accurate representation of data. This has an impact on the performance of the model. Depending on the model, the impact can be large or minimal. For example, linear regression is particularly susceptible to outliers. This procedure should be completed prior to model training.</p>
<ol class="simple">
<li><p>Write Python code to plot the distribution of the car prices.</p></li>
</ol>
<ol class="simple">
<li><p>Complete the following tasks:</p></li>
</ol>
<p>4.1 Identify (or list) all values that are outliers.</p>
<p>4.2 How many outliers are there?</p>
<p>4.3 What can you say about the shape of this distribution?</p>
<ol class="simple">
<li><p>We will use the log transformation to convert a skewed distribution to a normal or less skewed distribution. Write Python code to add a new column called ‘log_price’ that contains the logarithmic base 10 of the car prices.</p></li>
</ol>
<ol class="simple">
<li><p>Write Python code to plot the distribution of the values of the <code class="docutils literal notranslate"><span class="pre">log_</span> <span class="pre">price</span></code> variable.</p></li>
</ol>
<p>6.1 After log transformation, identify (or list) all values that are outliers the values of the <code class="docutils literal notranslate"><span class="pre">log_</span> <span class="pre">price</span></code> variable.</p>
</section>
<section id="scaling">
<h4>2.4 Scaling<a class="headerlink" href="#scaling" title="Permalink to this headline">¶</a></h4>
<p><strong>Feature scaling</strong> is one of the most common and difficult problems in machine learning, but also one of the most important if you want to do it right.</p>
<p>To train a predictive model, we need data with a known set of features that must be scaled up or down as appropriate.</p>
<p>If we do not have comparable scales, some of the coefficients obtained by fitting the regression model could be very large or very small compared to the other coefficients. There are two common methods of rescaling:</p>
<ul class="simple">
<li><p>Min-Max scaling</p></li>
<li><p>Standardisation (mean-0, sigma-1).</p></li>
</ul>
<p>After scaling, continuous features become similar in terms of range. Although this step is not required for many algorithms, it is still a good idea to perform it.</p>
<p>Distance-based algorithms such as k-NN and k-Means, on the other hand, require scaled continuous features as model input.</p>
<p>Here we will use the standardisation scaling.</p>
<p>See the following link for more details:
<a class="reference external" href="https://hersanyagci.medium.com/feature-scaling-with-scikit-learn-for-data-science-8c4cbcf2daff">https://hersanyagci.medium.com/feature-scaling-with-scikit-learn-for-data-science-8c4cbcf2daff</a></p>
<ol class="simple">
<li><p>Perform the standardisation scaling to all numeric feature variables (not the target (or response) variable, namely <code class="docutils literal notranslate"><span class="pre">price</span></code> and <code class="docutils literal notranslate"><span class="pre">log_price</span></code>.</p></li>
</ol>
</section>
<section id="correlation-analysis">
<h4>2.5 Correlation Analysis<a class="headerlink" href="#correlation-analysis" title="Permalink to this headline">¶</a></h4>
<p>The linear correlation between variable pairs is investigated using correlation analysis. This may be accomplished by combining the <code class="docutils literal notranslate"><span class="pre">corr()</span></code> and <code class="docutils literal notranslate"><span class="pre">sns.heatmap()</span></code> functions.</p>
<ol class="simple">
<li><p>Write Python code to create the correlation matrix of the dataset which has been completely preprocessed.</p></li>
</ol>
<ol class="simple">
<li><p>Identify (list) which numeric variables have a significant positive correlation with <code class="docutils literal notranslate"><span class="pre">log_price</span></code>.</p></li>
</ol>
<ol class="simple">
<li><p>Identify (list) which numeric variables have a significant negative correlation with <code class="docutils literal notranslate"><span class="pre">log_price</span></code>.</p></li>
</ol>
</section>
<section id="exploratory-data-analysis">
<h4>2.6 Exploratory data analysis<a class="headerlink" href="#exploratory-data-analysis" title="Permalink to this headline">¶</a></h4>
<p>It is now time to experiment with the data and make some visualizations.</p>
<p>In our dataset, a <strong>pairplot</strong> plots pairwise relationships. The pairplot function creates a grid of Axes in which each variable in the data is shared across a single row and a single column on the y-axis.</p>
<p>A pairs plot shows the distribution of single variables as well as the relationships between them. Pair plots are a great way to detect trends for further study, and they’re simple to create in Python!</p>
<ol class="simple">
<li><p>Write Python code to create pair plots of the feature and target variables (you may choose to include only features which have a significant correlation (as obtained from questions 9 and 10).</p></li>
</ol>
<ol class="simple">
<li><p>Explain the results you obtained.</p></li>
</ol>
</section>
</section>
<section id="step-3-create-a-regression-model-and-fit-it-with-the-available-data">
<h3>Step 3: Create a regression model and fit it with the available data.<a class="headerlink" href="#step-3-create-a-regression-model-and-fit-it-with-the-available-data" title="Permalink to this headline">¶</a></h3>
<p>Let us start with the simplest case, simple linear regression. We will use <code class="docutils literal notranslate"><span class="pre">log_price</span></code> as the dependent variable and the feature variable with highest correlation to the output <code class="docutils literal notranslate"><span class="pre">log_price</span></code> as an independent variable.</p>
<ol class="simple">
<li><p>What is the variable with the highest correlation to the output <code class="docutils literal notranslate"><span class="pre">log_price</span></code>?</p></li>
</ol>
<section id="split-the-data-into-training-and-test-subset">
<h4>3.1 Split the data into training and test subset<a class="headerlink" href="#split-the-data-into-training-and-test-subset" title="Permalink to this headline">¶</a></h4>
<p>To check the performance of a model, you should test it with new (test) data, that is with observations not used to fit (train) the model.</p>
<ol class="simple">
<li><p>Use scikit-learn’s <code class="docutils literal notranslate"><span class="pre">train_test_split()</span></code> to split your dataset into the training and test subsets. You must specifiy the arguements <code class="docutils literal notranslate"><span class="pre">random_state=id1</span></code> and <code class="docutils literal notranslate"><span class="pre">test_size=</span> <span class="pre">0.3</span></code> for the <code class="docutils literal notranslate"><span class="pre">train_test_split()</span></code> function.</p></li>
</ol>
<ol class="simple">
<li><p>Use either <code class="docutils literal notranslate"><span class="pre">statsmodel</span></code> or <code class="docutils literal notranslate"><span class="pre">scikit-learn</span></code> libraries to create the simple linear regression model and fit it with the <strong>training data</strong>.</p></li>
</ol>
</section>
</section>
<section id="step-4-get-results">
<h3>Step 4: Get results<a class="headerlink" href="#step-4-get-results" title="Permalink to this headline">¶</a></h3>
<p>Once you have fitted your model, you can get the results to verify that the model is working satisfactorily and interpret it.</p>
<p>We will obtain the following properties of the model.</p>
<ol class="simple">
<li><p>Write Python to print out the coefficient of determination (R-squared).</p></li>
</ol>
<ol class="simple">
<li><p>Write Python to print out the intercept of the model.</p></li>
</ol>
<ol class="simple">
<li><p>Write Python to print out the slope (coefficient of the chosen feature) of the model.</p></li>
</ol>
</section>
<section id="step-5-predict-response">
<h3>Step 5: Predict response<a class="headerlink" href="#step-5-predict-response" title="Permalink to this headline">¶</a></h3>
<p>Once you have a satisfactory model, you can use it for predictions with new data.</p>
<ol class="simple">
<li><p>Make predictions for the test set. Add a new column of prediction values to the test set. Show the first five rows of the test set of the following columns:</p></li>
</ol>
<ul class="simple">
<li><p>the feature column that used for the model,</p></li>
<li><p>the <code class="docutils literal notranslate"><span class="pre">log_price</span></code>, and</p></li>
<li><p>the predictions.</p></li>
</ul>
<ol class="simple">
<li><p>For model evaluation, write Python to calculate the following quantitative measurements on <strong>the test set</strong></p></li>
</ol>
<p>20.1 MAE,</p>
<p>20.2 MSE, and</p>
<p>20.3 R squared.</p>
<ol class="simple">
<li><p>(5 extra points) Write Python code to visualize the predictions of the linear regression. These may include:</p></li>
</ol>
<ul class="simple">
<li><p>Scatter plot of actual vs predicted Values</p></li>
<li><p>Density plot of actual vs Predicted Values</p></li>
<li><p>Residual plot (prediction Error)</p></li>
</ul>
<p>Give the graphs appropriate labels and titles.</p>
<p>Segregation of Numerical and Categorical Variables/Columns</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Segregation of Numerical and Categorical Variables/Columns</span>

<span class="n">cat_col</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
<span class="n">num_col</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
<span class="c1">#df_cat = df[cat_col]</span>
<span class="c1">#df_num = df[num_col]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">num_col</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;car_ID&#39;, &#39;symboling&#39;, &#39;wheelbase&#39;, &#39;carlength&#39;, &#39;carwidth&#39;,
       &#39;carheight&#39;, &#39;curbweight&#39;, &#39;enginesize&#39;, &#39;boreratio&#39;, &#39;stroke&#39;,
       &#39;compressionratio&#39;, &#39;horsepower&#39;, &#39;peakrpm&#39;, &#39;citympg&#39;, &#39;highwaympg&#39;,
       &#39;price&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x12b1a8f50&gt;
</pre></div>
</div>
<img alt="../_images/Exercise_Chapter6_Solution-Copy1_64_1.png" src="../_images/Exercise_Chapter6_Solution-Copy1_64_1.png" />
</div>
</div>
<p>Write python code to check whether any missing values are there in the dataset.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">isna</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>car_ID              0
symboling           0
CarName             0
fueltype            0
aspiration          0
doornumber          0
carbody             0
drivewheel          0
enginelocation      0
wheelbase           0
carlength           0
carwidth            0
carheight           0
curbweight          0
enginetype          0
cylindernumber      0
enginesize          0
fuelsystem          0
boreratio           0
stroke              0
compressionratio    0
horsepower          0
peakrpm             0
citympg             0
highwaympg          0
price               0
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Outlier analysis of the target variable</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">+</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;&quot;&quot;&#39;</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;price&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">geom_boxplot</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Exercise_Chapter6_Solution-Copy1_68_0.png" src="../_images/Exercise_Chapter6_Solution-Copy1_68_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (338768225)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">+</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;price&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">geom_histogram</span><span class="p">(</span><span class="n">bins</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="p">)</span>    
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Exercise_Chapter6_Solution-Copy1_69_0.png" src="../_images/Exercise_Chapter6_Solution-Copy1_69_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (338977197)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">+</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;price&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">geom_histogram</span><span class="p">(</span><span class="n">bins</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="p">)</span>   
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Exercise_Chapter6_Solution-Copy1_70_0.png" src="../_images/Exercise_Chapter6_Solution-Copy1_70_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (338775693)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;log_price&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s1">&#39;price&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">+</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;log_price&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">geom_histogram</span><span class="p">(</span><span class="n">bins</span> <span class="o">=</span> <span class="mi">20</span><span class="p">)</span>
<span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Exercise_Chapter6_Solution-Copy1_72_0.png" src="../_images/Exercise_Chapter6_Solution-Copy1_72_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (338949061)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">+</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;&quot;&quot;&#39;</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="s1">&#39;log_price&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">geom_boxplot</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Exercise_Chapter6_Solution-Copy1_73_0.png" src="../_images/Exercise_Chapter6_Solution-Copy1_73_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (337567781)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hm</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">annot</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
<span class="n">hm</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Correlation matrix of insurance data</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Exercise_Chapter6_Solution-Copy1_74_0.png" src="../_images/Exercise_Chapter6_Solution-Copy1_74_0.png" />
</div>
</div>
<p>Identify which numeric variables have a significant positive correlation with price.</p>
<ol class="simple">
<li><p>carwidth , carlength, curbweight ,enginesize ,horsepower seems to have a poitive correlation with price.</p></li>
<li><p>carheight doesn’t show any significant trend with price.</p></li>
</ol>
<p>Identify which numeric variables have a significant negative correlation with price.</p>
<ol class="simple">
<li><p>citympg , highwaympg - seem to have a significant negative correlation with price.</p></li>
</ol>
<p>Standarization scaling</p>
<p>Segregation of Numerical and Categorical Variables/Columns</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Segregation of Numerical and Categorical Variables/Columns</span>

<span class="n">cat_col</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
<span class="n">num_col</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">exclude</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;object&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">columns</span>
<span class="c1">#df_cat = df[cat_col]</span>
<span class="c1">#df_num = df[num_col]</span>

<span class="nb">print</span><span class="p">(</span><span class="n">num_col</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;car_ID&#39;, &#39;symboling&#39;, &#39;wheelbase&#39;, &#39;carlength&#39;, &#39;carwidth&#39;,
       &#39;carheight&#39;, &#39;curbweight&#39;, &#39;enginesize&#39;, &#39;boreratio&#39;, &#39;stroke&#39;,
       &#39;compressionratio&#39;, &#39;horsepower&#39;, &#39;peakrpm&#39;, &#39;citympg&#39;, &#39;highwaympg&#39;,
       &#39;price&#39;, &#39;log_price&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">num_col</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;car_ID&#39;, &#39;symboling&#39;, &#39;wheelbase&#39;, &#39;carlength&#39;, &#39;carwidth&#39;,
       &#39;carheight&#39;, &#39;curbweight&#39;, &#39;enginesize&#39;, &#39;boreratio&#39;, &#39;stroke&#39;,
       &#39;compressionratio&#39;, &#39;horsepower&#39;, &#39;peakrpm&#39;, &#39;citympg&#39;, &#39;highwaympg&#39;,
       &#39;price&#39;, &#39;log_price&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hm</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df</span><span class="p">[[</span><span class="s1">&#39;log_price&#39;</span><span class="p">,</span><span class="s1">&#39;carwidth&#39;</span> <span class="p">,</span> <span class="s1">&#39;carlength&#39;</span><span class="p">,</span> <span class="s1">&#39;curbweight&#39;</span> <span class="p">,</span><span class="s1">&#39;enginesize&#39;</span> <span class="p">,</span><span class="s1">&#39;horsepower&#39;</span><span class="p">,</span><span class="s1">&#39;citympg&#39;</span> <span class="p">,</span> <span class="s1">&#39;highwaympg&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">annot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">hm</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Correlation matrix of insurance data</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

<span class="c1">#df[[&#39;carwidth&#39; , &#39;carlength&#39;, &#39;curbweight&#39; ,&#39;enginesize&#39; ,&#39;horsepower&#39;]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Exercise_Chapter6_Solution-Copy1_86_0.png" src="../_images/Exercise_Chapter6_Solution-Copy1_86_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_var</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;enginesize&#39;</span><span class="p">,</span><span class="s1">&#39;curbweight&#39;</span> <span class="p">,</span><span class="s1">&#39;citympg&#39;</span> <span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Splitting the Data into Training and Testing Sets¶</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We specify this so that the train and test data set always have the same rows, respectively</span>
<span class="c1"># We divide the df into 70/30 ratio</span>
<span class="nb">id</span> <span class="o">=</span> <span class="mi">888</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df_train</span><span class="p">,</span> <span class="n">df_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">train_size</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span> <span class="n">random_state</span> <span class="o">=</span> <span class="nb">id</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Rescaling the Features¶</p>
<p>For Simple Linear Regression, scaling doesn’t impact model. So it is extremely important to rescale the variables so that they have a comparable scale. If we don’t have comparable scales, then some of the coefficients as obtained by fitting the regression model might be very large or very small as compared to the other coefficients. There are two common ways of rescaling:</p>
<ul class="simple">
<li><p>Min-Max scaling</p></li>
<li><p>Standardisation (mean-0, sigma-1).</p></li>
</ul>
<p>Here we will use the standardisation scaling.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scaler</span> <span class="o">=</span> <span class="n">preprocessing</span><span class="o">.</span><span class="n">StandardScaler</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Apply scaler() to all the columns except the &#39;dummy&#39; variables</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>

<span class="n">df_train</span><span class="p">[</span><span class="n">selected_var</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_train</span><span class="p">[</span><span class="n">selected_var</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train</span><span class="p">[</span><span class="n">selected_var</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>enginesize</th>
      <th>curbweight</th>
      <th>citympg</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>1.430000e+02</td>
      <td>1.430000e+02</td>
      <td>1.430000e+02</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>-3.058936e-16</td>
      <td>3.680040e-16</td>
      <td>1.564405e-16</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.003515e+00</td>
      <td>1.003515e+00</td>
      <td>1.003515e+00</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-1.345276e+00</td>
      <td>-1.630690e+00</td>
      <td>-1.907109e+00</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>-7.199452e-01</td>
      <td>-8.197158e-01</td>
      <td>-9.607240e-01</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>-2.083110e-01</td>
      <td>-2.239940e-01</td>
      <td>-1.720700e-01</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>3.829107e-01</td>
      <td>7.531408e-01</td>
      <td>7.743148e-01</td>
    </tr>
    <tr>
      <th>max</th>
      <td>4.475984e+00</td>
      <td>2.812205e+00</td>
      <td>3.771200e+00</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s check the correlation coefficients to see which variables are highly correlated</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df_train</span><span class="p">[</span><span class="n">selected_var</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;log_price&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">cmap</span><span class="o">=</span><span class="s2">&quot;RdYlGn&quot;</span><span class="p">,</span> <span class="n">annot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Exercise_Chapter6_Solution-Copy1_94_0.png" src="../_images/Exercise_Chapter6_Solution-Copy1_94_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">df_train</span><span class="p">[</span><span class="n">selected_var</span> <span class="o">+</span> <span class="p">[</span><span class="s1">&#39;log_price&#39;</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;seaborn.axisgrid.PairGrid at 0x1382b1890&gt;
</pre></div>
</div>
<img alt="../_images/Exercise_Chapter6_Solution-Copy1_95_1.png" src="../_images/Exercise_Chapter6_Solution-Copy1_95_1.png" />
</div>
</div>
<p>Dividing into X and Y sets for the model building¶</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_train</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;log_price&#39;</span><span class="p">]</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="n">selected_var</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model1</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;log_price ~ enginesize&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_train</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model1</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>        <td>log_price</td>    <th>  R-squared:         </th> <td>   0.708</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.706</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   341.5</td>
</tr>
<tr>
  <th>Date:</th>             <td>Fri, 25 Mar 2022</td> <th>  Prob (F-statistic):</th> <td>1.71e-39</td>
</tr>
<tr>
  <th>Time:</th>                 <td>14:56:56</td>     <th>  Log-Likelihood:    </th> <td>  99.824</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   143</td>      <th>  AIC:               </th> <td>  -195.6</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   141</td>      <th>  BIC:               </th> <td>  -189.7</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>  <td>    4.0737</td> <td>    0.010</td> <td>  401.792</td> <td> 0.000</td> <td>    4.054</td> <td>    4.094</td>
</tr>
<tr>
  <th>enginesize</th> <td>    0.1874</td> <td>    0.010</td> <td>   18.480</td> <td> 0.000</td> <td>    0.167</td> <td>    0.207</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 2.510</td> <th>  Durbin-Watson:     </th> <td>   2.133</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.285</td> <th>  Jarque-Bera (JB):  </th> <td>   2.477</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.267</td> <th>  Prob(JB):          </th> <td>   0.290</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.638</td> <th>  Cond. No.          </th> <td>    1.00</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="let-s-visualise-the-data-with-a-scatter-plot-and-the-fitted-regression-line">
<h1>Let’s visualise the data with a scatter plot and the fitted regression line<a class="headerlink" href="#let-s-visualise-the-data-with-a-scatter-plot-and-the-fitted-regression-line" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;model1_prediction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;model1_residual&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_train</span> <span class="o">-</span> <span class="n">model1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="n">df_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>car_ID</th>
      <th>symboling</th>
      <th>CarName</th>
      <th>fueltype</th>
      <th>aspiration</th>
      <th>doornumber</th>
      <th>carbody</th>
      <th>drivewheel</th>
      <th>enginelocation</th>
      <th>wheelbase</th>
      <th>...</th>
      <th>stroke</th>
      <th>compressionratio</th>
      <th>horsepower</th>
      <th>peakrpm</th>
      <th>citympg</th>
      <th>highwaympg</th>
      <th>price</th>
      <th>log_price</th>
      <th>model1_prediction</th>
      <th>model1_residual</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>99</th>
      <td>100</td>
      <td>0</td>
      <td>nissan rogue</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>hatchback</td>
      <td>fwd</td>
      <td>front</td>
      <td>97.2</td>
      <td>...</td>
      <td>3.47</td>
      <td>8.5</td>
      <td>97</td>
      <td>5200</td>
      <td>0.301122</td>
      <td>34</td>
      <td>8949.0</td>
      <td>3.951775</td>
      <td>4.034630</td>
      <td>-0.082855</td>
    </tr>
    <tr>
      <th>158</th>
      <td>159</td>
      <td>0</td>
      <td>toyota corona</td>
      <td>diesel</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>fwd</td>
      <td>front</td>
      <td>95.7</td>
      <td>...</td>
      <td>3.35</td>
      <td>22.5</td>
      <td>56</td>
      <td>4500</td>
      <td>1.405238</td>
      <td>36</td>
      <td>7898.0</td>
      <td>3.897517</td>
      <td>3.992024</td>
      <td>-0.094506</td>
    </tr>
    <tr>
      <th>85</th>
      <td>86</td>
      <td>1</td>
      <td>mitsubishi montero</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>fwd</td>
      <td>front</td>
      <td>96.3</td>
      <td>...</td>
      <td>3.46</td>
      <td>8.5</td>
      <td>88</td>
      <td>5000</td>
      <td>-0.014339</td>
      <td>32</td>
      <td>6989.0</td>
      <td>3.844415</td>
      <td>4.043151</td>
      <td>-0.198736</td>
    </tr>
    <tr>
      <th>131</th>
      <td>132</td>
      <td>2</td>
      <td>renault 5 gtl</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>hatchback</td>
      <td>fwd</td>
      <td>front</td>
      <td>96.1</td>
      <td>...</td>
      <td>3.90</td>
      <td>8.7</td>
      <td>90</td>
      <td>5100</td>
      <td>-0.329801</td>
      <td>31</td>
      <td>9895.0</td>
      <td>3.995416</td>
      <td>4.085757</td>
      <td>-0.090341</td>
    </tr>
    <tr>
      <th>171</th>
      <td>172</td>
      <td>2</td>
      <td>toyota corolla</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>hatchback</td>
      <td>rwd</td>
      <td>front</td>
      <td>98.4</td>
      <td>...</td>
      <td>3.50</td>
      <td>9.3</td>
      <td>116</td>
      <td>4800</td>
      <td>-0.172070</td>
      <td>30</td>
      <td>11549.0</td>
      <td>4.062544</td>
      <td>4.145405</td>
      <td>-0.082861</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 29 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df_train</span><span class="p">)</span> <span class="o">+</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;enginesize&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;log_price&#39;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;&quot;Actual value&quot;&#39;</span><span class="p">))</span> 
    <span class="o">+</span> <span class="n">geom_smooth</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;&quot;Predicted value&quot;&#39;</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;lm&#39;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">scale_color_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">],</span> <span class="c1"># Colors</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Exercise_Chapter6_Solution-Copy1_103_0.png" src="../_images/Exercise_Chapter6_Solution-Copy1_103_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (330999921)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;model1_prediction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;model1_residual&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_train</span> <span class="o">-</span> <span class="n">model1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="n">df_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>car_ID</th>
      <th>symboling</th>
      <th>CarName</th>
      <th>fueltype</th>
      <th>aspiration</th>
      <th>doornumber</th>
      <th>carbody</th>
      <th>drivewheel</th>
      <th>enginelocation</th>
      <th>wheelbase</th>
      <th>...</th>
      <th>stroke</th>
      <th>compressionratio</th>
      <th>horsepower</th>
      <th>peakrpm</th>
      <th>citympg</th>
      <th>highwaympg</th>
      <th>price</th>
      <th>log_price</th>
      <th>model1_prediction</th>
      <th>model1_residual</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>99</th>
      <td>100</td>
      <td>0</td>
      <td>nissan rogue</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>hatchback</td>
      <td>fwd</td>
      <td>front</td>
      <td>97.2</td>
      <td>...</td>
      <td>3.47</td>
      <td>8.5</td>
      <td>97</td>
      <td>5200</td>
      <td>0.301122</td>
      <td>34</td>
      <td>8949.0</td>
      <td>3.951775</td>
      <td>4.034630</td>
      <td>-0.082855</td>
    </tr>
    <tr>
      <th>158</th>
      <td>159</td>
      <td>0</td>
      <td>toyota corona</td>
      <td>diesel</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>fwd</td>
      <td>front</td>
      <td>95.7</td>
      <td>...</td>
      <td>3.35</td>
      <td>22.5</td>
      <td>56</td>
      <td>4500</td>
      <td>1.405238</td>
      <td>36</td>
      <td>7898.0</td>
      <td>3.897517</td>
      <td>3.992024</td>
      <td>-0.094506</td>
    </tr>
    <tr>
      <th>85</th>
      <td>86</td>
      <td>1</td>
      <td>mitsubishi montero</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>fwd</td>
      <td>front</td>
      <td>96.3</td>
      <td>...</td>
      <td>3.46</td>
      <td>8.5</td>
      <td>88</td>
      <td>5000</td>
      <td>-0.014339</td>
      <td>32</td>
      <td>6989.0</td>
      <td>3.844415</td>
      <td>4.043151</td>
      <td>-0.198736</td>
    </tr>
    <tr>
      <th>131</th>
      <td>132</td>
      <td>2</td>
      <td>renault 5 gtl</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>hatchback</td>
      <td>fwd</td>
      <td>front</td>
      <td>96.1</td>
      <td>...</td>
      <td>3.90</td>
      <td>8.7</td>
      <td>90</td>
      <td>5100</td>
      <td>-0.329801</td>
      <td>31</td>
      <td>9895.0</td>
      <td>3.995416</td>
      <td>4.085757</td>
      <td>-0.090341</td>
    </tr>
    <tr>
      <th>171</th>
      <td>172</td>
      <td>2</td>
      <td>toyota corolla</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>hatchback</td>
      <td>rwd</td>
      <td>front</td>
      <td>98.4</td>
      <td>...</td>
      <td>3.50</td>
      <td>9.3</td>
      <td>116</td>
      <td>4800</td>
      <td>-0.172070</td>
      <td>30</td>
      <td>11549.0</td>
      <td>4.062544</td>
      <td>4.145405</td>
      <td>-0.082861</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 29 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;enginesize&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;log_price&#39;</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">geom_point</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">geom_smooth</span><span class="p">(</span><span class="n">method</span><span class="o">=</span><span class="s1">&#39;lm&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">labs</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;Charges&#39;</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Simple Linear Regression: Actual vs Predicted Values&#39;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">scale_fill_manual</span><span class="p">(</span>
    <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Actual values&#39;</span><span class="p">,</span><span class="s1">&#39;Predicted values&#39;</span><span class="p">],</span>
    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="p">,</span> <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Actualvalues&#39;</span><span class="p">,</span><span class="s1">&#39;Predicted values&#39;</span><span class="p">]</span> <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Exercise_Chapter6_Solution-Copy1_105_0.png" src="../_images/Exercise_Chapter6_Solution-Copy1_105_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (332764857)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df_train</span><span class="p">)</span> 
    <span class="o">+</span> <span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;enginesize&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;log_price&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;&quot;Actual value&quot;&#39;</span><span class="p">))</span>     
    <span class="o">+</span> <span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;enginesize&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;model1_prediction&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;&quot;Predicted value&quot;&#39;</span><span class="p">))</span> 
    <span class="o">+</span> <span class="n">scale_color_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">],</span> <span class="c1"># Colors</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">labs</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;log_price&#39;</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Simple Linear Regression: Scatter plot: Actual vs. Predicted Values&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Exercise_Chapter6_Solution-Copy1_106_0.png" src="../_images/Exercise_Chapter6_Solution-Copy1_106_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (332770749)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;log_price&#39;</span><span class="p">))</span>
    <span class="o">+</span>  <span class="n">geom_density</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">after_stat</span><span class="p">(</span><span class="s1">&#39;density&#39;</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;&quot;Actual Values&quot;&#39;</span> <span class="p">))</span>
    <span class="o">+</span>  <span class="n">geom_density</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;model1_prediction&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">after_stat</span><span class="p">(</span><span class="s1">&#39;density&#39;</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;&quot;Predicted Values&quot;&#39;</span><span class="p">))</span> 
    <span class="o">+</span>  <span class="n">scale_color_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">],</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Legend&#39;</span><span class="p">)</span> 
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Exercise_Chapter6_Solution-Copy1_107_0.png" src="../_images/Exercise_Chapter6_Solution-Copy1_107_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (331138065)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;df_train.index&#39;</span><span class="p">))</span>
    <span class="o">+</span>  <span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;model1_residual&#39;</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Prediction error&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Exercise_Chapter6_Solution-Copy1_108_0.png" src="../_images/Exercise_Chapter6_Solution-Copy1_108_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (339380181)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="o">*</span> 

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean Absolute Error:&#39;</span><span class="p">,</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span> <span class="p">,</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;model1_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean Squared Error:&#39;</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span> <span class="p">,</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;model1_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Root Mean Squared Error:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span> <span class="p">,</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;model1_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R-squared:&#39;</span><span class="p">,</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span> <span class="p">,</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;model1_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>

<span class="n">output_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">,</span><span class="s1">&#39;MSE&#39;</span><span class="p">,</span><span class="s1">&#39;R2-Score&#39;</span><span class="p">],</span><span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Linear Regression&#39;</span><span class="p">,</span><span class="s1">&#39;Multiple Linear Regression&#39;</span><span class="p">])</span>
<span class="n">output_df</span><span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">][</span><span class="s1">&#39;Linear Regression&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;model1_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
<span class="n">output_df</span><span class="p">[</span><span class="s1">&#39;MSE&#39;</span><span class="p">][</span><span class="s1">&#39;Linear Regression&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;model1_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">output_df</span><span class="p">[</span><span class="s1">&#39;R2-Score&#39;</span><span class="p">][</span><span class="s1">&#39;Linear Regression&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;model1_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean Absolute Error: 0.09868531570781863
Mean Squared Error: 0.014493961730686952
Root Mean Squared Error: 0.12039087062849471
R-squared: 0.7077864646218535
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>R2-Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Linear Regression</th>
      <td>0.098685</td>
      <td>0.014494</td>
      <td>0.707786</td>
    </tr>
    <tr>
      <th>Multiple Linear Regression</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Multiple Linear Regression</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">y_train</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;log_price&#39;</span><span class="p">]</span>
<span class="n">X_train</span> <span class="o">=</span> <span class="n">df_train</span><span class="p">[</span><span class="n">selected_var</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">selected_var</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;enginesize&#39;, &#39;curbweight&#39;, &#39;citympg&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model2</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s1">&#39;log_price ~ enginesize + curbweight + citympg&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_train</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model2</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>        <td>log_price</td>    <th>  R-squared:         </th> <td>   0.829</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.825</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   224.2</td>
</tr>
<tr>
  <th>Date:</th>             <td>Fri, 25 Mar 2022</td> <th>  Prob (F-statistic):</th> <td>4.69e-53</td>
</tr>
<tr>
  <th>Time:</th>                 <td>14:57:22</td>     <th>  Log-Likelihood:    </th> <td>  138.04</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   143</td>      <th>  AIC:               </th> <td>  -268.1</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   139</td>      <th>  BIC:               </th> <td>  -256.2</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     3</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>  <td>    4.0737</td> <td>    0.008</td> <td>  521.129</td> <td> 0.000</td> <td>    4.058</td> <td>    4.089</td>
</tr>
<tr>
  <th>enginesize</th> <td>    0.0663</td> <td>    0.015</td> <td>    4.484</td> <td> 0.000</td> <td>    0.037</td> <td>    0.095</td>
</tr>
<tr>
  <th>curbweight</th> <td>    0.1052</td> <td>    0.017</td> <td>    6.315</td> <td> 0.000</td> <td>    0.072</td> <td>    0.138</td>
</tr>
<tr>
  <th>citympg</th>    <td>   -0.0461</td> <td>    0.012</td> <td>   -3.711</td> <td> 0.000</td> <td>   -0.071</td> <td>   -0.022</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td>10.294</td> <th>  Durbin-Watson:     </th> <td>   2.403</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.006</td> <th>  Jarque-Bera (JB):  </th> <td>  10.400</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.599</td> <th>  Prob(JB):          </th> <td> 0.00552</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.558</td> <th>  Cond. No.          </th> <td>    4.23</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>Let’s visualise the data with a scatter plot and the fitted regression line<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;model2_prediction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>
<span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;model2_residual&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_train</span> <span class="o">-</span> <span class="n">model2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">)</span>

<span class="n">df_train</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>car_ID</th>
      <th>symboling</th>
      <th>CarName</th>
      <th>fueltype</th>
      <th>aspiration</th>
      <th>doornumber</th>
      <th>carbody</th>
      <th>drivewheel</th>
      <th>enginelocation</th>
      <th>wheelbase</th>
      <th>...</th>
      <th>horsepower</th>
      <th>peakrpm</th>
      <th>citympg</th>
      <th>highwaympg</th>
      <th>price</th>
      <th>log_price</th>
      <th>model1_prediction</th>
      <th>model1_residual</th>
      <th>model2_prediction</th>
      <th>model2_residual</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>99</th>
      <td>100</td>
      <td>0</td>
      <td>nissan rogue</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>hatchback</td>
      <td>fwd</td>
      <td>front</td>
      <td>97.2</td>
      <td>...</td>
      <td>97</td>
      <td>5200</td>
      <td>0.301122</td>
      <td>34</td>
      <td>8949.0</td>
      <td>3.951775</td>
      <td>4.034630</td>
      <td>-0.082855</td>
      <td>3.995817</td>
      <td>-0.044043</td>
    </tr>
    <tr>
      <th>158</th>
      <td>159</td>
      <td>0</td>
      <td>toyota corona</td>
      <td>diesel</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>fwd</td>
      <td>front</td>
      <td>95.7</td>
      <td>...</td>
      <td>56</td>
      <td>4500</td>
      <td>1.405238</td>
      <td>36</td>
      <td>7898.0</td>
      <td>3.897517</td>
      <td>3.992024</td>
      <td>-0.094506</td>
      <td>3.920153</td>
      <td>-0.022636</td>
    </tr>
    <tr>
      <th>85</th>
      <td>86</td>
      <td>1</td>
      <td>mitsubishi montero</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>fwd</td>
      <td>front</td>
      <td>96.3</td>
      <td>...</td>
      <td>88</td>
      <td>5000</td>
      <td>-0.014339</td>
      <td>32</td>
      <td>6989.0</td>
      <td>3.844415</td>
      <td>4.043151</td>
      <td>-0.198736</td>
      <td>4.021506</td>
      <td>-0.177091</td>
    </tr>
    <tr>
      <th>131</th>
      <td>132</td>
      <td>2</td>
      <td>renault 5 gtl</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>hatchback</td>
      <td>fwd</td>
      <td>front</td>
      <td>96.1</td>
      <td>...</td>
      <td>90</td>
      <td>5100</td>
      <td>-0.329801</td>
      <td>31</td>
      <td>9895.0</td>
      <td>3.995416</td>
      <td>4.085757</td>
      <td>-0.090341</td>
      <td>4.069972</td>
      <td>-0.074556</td>
    </tr>
    <tr>
      <th>171</th>
      <td>172</td>
      <td>2</td>
      <td>toyota corolla</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>hatchback</td>
      <td>rwd</td>
      <td>front</td>
      <td>98.4</td>
      <td>...</td>
      <td>116</td>
      <td>4800</td>
      <td>-0.172070</td>
      <td>30</td>
      <td>11549.0</td>
      <td>4.062544</td>
      <td>4.145405</td>
      <td>-0.082861</td>
      <td>4.134240</td>
      <td>-0.071696</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 31 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df_train</span><span class="p">)</span> 
    <span class="o">+</span> <span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;enginesize&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;log_price&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;&quot;Actual value&quot;&#39;</span><span class="p">))</span>     
    <span class="o">+</span> <span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;enginesize&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;model2_prediction&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;&quot;Predicted value&quot;&#39;</span><span class="p">))</span> 
    <span class="o">+</span> <span class="n">scale_color_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">],</span> <span class="c1"># Colors</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">labs</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;log_price&#39;</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Multiple Linear Regression: Scatter plot: Actual vs. Predicted Values&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Exercise_Chapter6_Solution-Copy1_118_0.png" src="../_images/Exercise_Chapter6_Solution-Copy1_118_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (339392609)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;log_price&#39;</span><span class="p">))</span>
    <span class="o">+</span>  <span class="n">geom_density</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">after_stat</span><span class="p">(</span><span class="s1">&#39;density&#39;</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;&quot;Actual Values&quot;&#39;</span> <span class="p">))</span>
    <span class="o">+</span>  <span class="n">geom_density</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;model2_prediction&#39;</span><span class="p">,</span><span class="n">y</span><span class="o">=</span><span class="n">after_stat</span><span class="p">(</span><span class="s1">&#39;density&#39;</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;&quot;Predicted Values&quot;&#39;</span><span class="p">))</span> 
    <span class="o">+</span>  <span class="n">scale_color_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;green&#39;</span><span class="p">,</span><span class="s1">&#39;red&#39;</span><span class="p">],</span> <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Legend&#39;</span><span class="p">)</span> 
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Exercise_Chapter6_Solution-Copy1_119_0.png" src="../_images/Exercise_Chapter6_Solution-Copy1_119_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (339433137)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df_train</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;df_train.index&#39;</span><span class="p">))</span>
    <span class="o">+</span>  <span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;model2_residual&#39;</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">labs</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;Prediction error&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Exercise_Chapter6_Solution-Copy1_120_0.png" src="../_images/Exercise_Chapter6_Solution-Copy1_120_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (339770197)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="o">*</span> 

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean Absolute Error:&#39;</span><span class="p">,</span> <span class="n">mean_absolute_error</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span> <span class="p">,</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;model2_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean Squared Error:&#39;</span><span class="p">,</span> <span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span> <span class="p">,</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;model2_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Root Mean Squared Error:&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span> <span class="p">,</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;model2_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;R-squared:&#39;</span><span class="p">,</span><span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span> <span class="p">,</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;model2_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>

<span class="c1">#output_df = pd.DataFrame(columns=[&#39;MAE&#39;,&#39;MSE&#39;,&#39;R2-Score&#39;],index=[&#39;Linear Regression&#39;,&#39;Multiple Linear Regression&#39;])</span>
<span class="n">output_df</span><span class="p">[</span><span class="s1">&#39;MAE&#39;</span><span class="p">][</span><span class="s1">&#39;Multiple Linear Regression&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;model2_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">))</span>
<span class="n">output_df</span><span class="p">[</span><span class="s1">&#39;MSE&#39;</span><span class="p">][</span><span class="s1">&#39;Multiple Linear Regression&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span> <span class="o">-</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;model2_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">output_df</span><span class="p">[</span><span class="s1">&#39;R2-Score&#39;</span><span class="p">][</span><span class="s1">&#39;Multiple Linear Regression&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">r2_score</span><span class="p">(</span><span class="n">y_train</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">df_train</span><span class="p">[</span><span class="s1">&#39;model2_prediction&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean Absolute Error: 0.07053176076943697
Mean Squared Error: 0.008493642666958187
Root Mean Squared Error: 0.09216096064472303
R-squared: 0.8287592172472993
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>MAE</th>
      <th>MSE</th>
      <th>R2-Score</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Linear Regression</th>
      <td>0.098685</td>
      <td>0.014494</td>
      <td>0.707786</td>
    </tr>
    <tr>
      <th>Multiple Linear Regression</th>
      <td>0.070532</td>
      <td>0.008494</td>
      <td>0.828759</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>Predictions on the test set</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model1</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>        <td>log_price</td>    <th>  R-squared:         </th> <td>   0.708</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.706</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   341.5</td>
</tr>
<tr>
  <th>Date:</th>             <td>Fri, 25 Mar 2022</td> <th>  Prob (F-statistic):</th> <td>1.71e-39</td>
</tr>
<tr>
  <th>Time:</th>                 <td>14:57:34</td>     <th>  Log-Likelihood:    </th> <td>  99.824</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>   143</td>      <th>  AIC:               </th> <td>  -195.6</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>   141</td>      <th>  BIC:               </th> <td>  -189.7</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>  <td>    4.0737</td> <td>    0.010</td> <td>  401.792</td> <td> 0.000</td> <td>    4.054</td> <td>    4.094</td>
</tr>
<tr>
  <th>enginesize</th> <td>    0.1874</td> <td>    0.010</td> <td>   18.480</td> <td> 0.000</td> <td>    0.167</td> <td>    0.207</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 2.510</td> <th>  Durbin-Watson:     </th> <td>   2.133</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.285</td> <th>  Jarque-Bera (JB):  </th> <td>   2.477</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.267</td> <th>  Prob(JB):          </th> <td>   0.290</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.638</td> <th>  Cond. No.          </th> <td>    1.00</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_test</span><span class="p">[</span><span class="n">selected_var</span><span class="p">]</span> <span class="o">=</span> <span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df_test</span><span class="p">[</span><span class="n">selected_var</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">df_test</span><span class="p">[</span><span class="n">selected_var</span><span class="p">]</span><span class="o">.</span><span class="n">describe</span><span class="p">())</span>

<span class="n">y_test</span> <span class="o">=</span> <span class="n">df_test</span><span class="p">[</span><span class="s1">&#39;log_price&#39;</span><span class="p">]</span>
<span class="n">X_test</span> <span class="o">=</span> <span class="n">df_test</span><span class="p">[</span><span class="n">selected_var</span><span class="p">]</span>

<span class="n">df_test</span><span class="p">[</span><span class="s1">&#39;model1_prediction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">df_test</span><span class="p">[</span><span class="s1">&#39;model1_residual&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">model1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">df_test</span><span class="p">[</span><span class="s1">&#39;model2_prediction&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">model2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>
<span class="n">df_test</span><span class="p">[</span><span class="s1">&#39;model2_residual&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_test</span> <span class="o">-</span> <span class="n">model2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">df_test</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>         enginesize  curbweight       citympg
count  6.200000e+01   62.000000  6.200000e+01
mean   1.325105e-16    0.000000  4.476706e-17
std    1.008163e+00    1.008163  1.008163e+00
min   -1.747813e+00   -2.072576 -1.518004e+00
25%   -7.041865e-01   -0.549137 -6.519036e-01
50%   -1.931695e-01   -0.209465 -1.466783e-01
75%    4.114140e-01    0.521236  6.472472e-01
max    3.232804e+00    2.528250  3.101199e+00
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>car_ID</th>
      <th>symboling</th>
      <th>CarName</th>
      <th>fueltype</th>
      <th>aspiration</th>
      <th>doornumber</th>
      <th>carbody</th>
      <th>drivewheel</th>
      <th>enginelocation</th>
      <th>wheelbase</th>
      <th>...</th>
      <th>horsepower</th>
      <th>peakrpm</th>
      <th>citympg</th>
      <th>highwaympg</th>
      <th>price</th>
      <th>log_price</th>
      <th>model1_prediction</th>
      <th>model1_residual</th>
      <th>model2_prediction</th>
      <th>model2_residual</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>63</th>
      <td>64</td>
      <td>0</td>
      <td>mazda glc deluxe</td>
      <td>diesel</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>fwd</td>
      <td>front</td>
      <td>98.8</td>
      <td>...</td>
      <td>64</td>
      <td>4650</td>
      <td>1.513348</td>
      <td>42</td>
      <td>10795.0</td>
      <td>4.033223</td>
      <td>4.075226</td>
      <td>-0.042004</td>
      <td>3.990809</td>
      <td>0.042414</td>
    </tr>
    <tr>
      <th>189</th>
      <td>190</td>
      <td>3</td>
      <td>vw dasher</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>convertible</td>
      <td>fwd</td>
      <td>front</td>
      <td>94.5</td>
      <td>...</td>
      <td>90</td>
      <td>5500</td>
      <td>-0.218853</td>
      <td>29</td>
      <td>11595.0</td>
      <td>4.064271</td>
      <td>4.005101</td>
      <td>0.059170</td>
      <td>4.005380</td>
      <td>0.058891</td>
    </tr>
    <tr>
      <th>58</th>
      <td>59</td>
      <td>3</td>
      <td>mazda glc 4</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>hatchback</td>
      <td>rwd</td>
      <td>front</td>
      <td>95.3</td>
      <td>...</td>
      <td>135</td>
      <td>6000</td>
      <td>-1.373654</td>
      <td>23</td>
      <td>15645.0</td>
      <td>4.194376</td>
      <td>3.848668</td>
      <td>0.345708</td>
      <td>4.055878</td>
      <td>0.138497</td>
    </tr>
    <tr>
      <th>107</th>
      <td>108</td>
      <td>0</td>
      <td>peugeot 504</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>rwd</td>
      <td>front</td>
      <td>107.9</td>
      <td>...</td>
      <td>97</td>
      <td>5000</td>
      <td>-0.940604</td>
      <td>24</td>
      <td>11900.0</td>
      <td>4.075547</td>
      <td>4.064438</td>
      <td>0.011109</td>
      <td>4.223472</td>
      <td>-0.147925</td>
    </tr>
    <tr>
      <th>38</th>
      <td>39</td>
      <td>0</td>
      <td>honda civic 1300</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>hatchback</td>
      <td>fwd</td>
      <td>front</td>
      <td>96.5</td>
      <td>...</td>
      <td>86</td>
      <td>5800</td>
      <td>0.214197</td>
      <td>33</td>
      <td>9095.0</td>
      <td>3.958803</td>
      <td>4.010495</td>
      <td>-0.051693</td>
      <td>3.994824</td>
      <td>-0.036022</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 31 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">metrics</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean Squared Error of Model1:&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model1</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mean Squared Error of Model2:&#39;</span><span class="p">,</span> <span class="n">metrics</span><span class="o">.</span><span class="n">mean_squared_error</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">model2</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Mean Squared Error of Model1: 0.01659778668071687
Mean Squared Error of Model2: 0.008033914142105277
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df_test</span><span class="p">)</span> 
    <span class="o">+</span> <span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;enginesize&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;log_price&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;&quot;Actual value&quot;&#39;</span><span class="p">))</span>     
    <span class="o">+</span> <span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;enginesize&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;model1_prediction&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;&quot;Predicted value&quot;&#39;</span><span class="p">))</span> 
    <span class="o">+</span> <span class="n">scale_color_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">],</span> <span class="c1"># Colors</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">labs</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;log_price&#39;</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Simple Linear Regression: Scatter plot: Actual vs. Predicted Values&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Exercise_Chapter6_Solution-Copy1_128_0.png" src="../_images/Exercise_Chapter6_Solution-Copy1_128_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (339669021)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df_test</span><span class="p">)</span> 
    <span class="o">+</span> <span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;enginesize&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;log_price&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;&quot;Actual value&quot;&#39;</span><span class="p">))</span>     
    <span class="o">+</span> <span class="n">geom_point</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;enginesize&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;model2_prediction&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;&quot;Predicted value&quot;&#39;</span><span class="p">))</span> 
    <span class="o">+</span> <span class="n">scale_color_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">],</span> <span class="c1"># Colors</span>
        <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
    <span class="o">+</span> <span class="n">labs</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;log_price&#39;</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Multiple Linear Regression: Scatter plot: Actual vs. Predicted Values&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/Exercise_Chapter6_Solution-Copy1_129_0.png" src="../_images/Exercise_Chapter6_Solution-Copy1_129_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (339883713)&gt;
</pre></div>
</div>
</div>
</div>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./Exercises"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Pairote Satiracoo<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>