
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>7. Practical Statistics &#8212; SCMA248 Introduction to Data Science</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="8. Regression Analysis" href="Chapter6_Regression.html" />
    <link rel="prev" title="6. Data Visualization" href="Chapter4_Data_Visualization.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">SCMA248 Introduction to Data Science</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Welcome to SCMA248 Introduction to Data Science
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Chapter1_Introduction_to_Data_Science.html">
   1. Introduction to Data Science
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Chapter2_Python_Basics.html">
   2. Python Basics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Chapter3_Data_Preparation.html">
   3. Data Selection
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Chapter4_Data_Visualization.html">
   6. Data Visualization
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   7. Practical Statistics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Chapter6_Regression.html">
   8. Regression Analysis
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Chapter7_Introduction_Machine_Learning.html">
   9. Machine learning: Introduction
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Chapter8_Unsupervised_Learning.html">
   10. Unsupervised Machine Learning: K-means Clustering
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/Chapter5_Practical_Statistics.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/executablebooks/jupyter-book"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2FChapter5_Practical_Statistics.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/docs/Chapter5_Practical_Statistics.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#density-plots-and-estimates">
   7.1. Density Plots and Estimates
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#correlation">
   7.2. Correlation
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-correlation-matrix">
     7.2.1. The correlation matrix
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#finding-correlation-between-two-variables">
     7.2.2. Finding Correlation Between Two Variables
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plotting-correlation-matrix">
     7.2.3. Plotting Correlation Matrix
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plotting-correlation-heatmap">
     7.2.4. Plotting Correlation HeatMap
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-and-sampling-distributions">
   7.3. Data and Sampling Distributions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#sampling-bias">
     7.3.1. Sampling bias
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#types-of-sampling-techniques">
     7.3.2. Types of sampling techniques
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#simple-random-sampling">
       7.3.2.1. Simple random sampling
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#systematic-sampling">
       7.3.2.2. Systematic sampling
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#stratified-sampling">
       7.3.2.3. Stratified Sampling
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cluster-sampling">
       7.3.2.4. Cluster Sampling
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#distribution-of-random-variables">
   7.4. Distribution of Random Variables
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#random-variable">
     7.4.1. Random Variable
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#discrete-random-variables">
       7.4.1.1. Discrete random variables
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#continuous-random-variables">
     7.4.2. Continuous random variables
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#the-uniform-distribution">
       7.4.2.1. The uniform distribution
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#uniform-distribution-in-python">
       7.4.2.2. Uniform Distribution in Python
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#uniform-random-variate">
       7.4.2.3. Uniform random variate
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#normal-distribution-function">
     7.4.3. Normal Distribution Function
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#poisson-distribution">
     7.4.4. Poisson Distribution
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#poisson-distribution-function">
       7.4.4.1. Poisson Distribution Function
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#fitting-models-to-data">
   7.5. Fitting Models to Data
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#generate-test-data-and-fit-it">
     7.5.1. Generate test data and fit it
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#fitting-distributions">
     7.5.2. Fitting distributions
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#choosing-the-most-appropriate-distribution-and-indentifying-the-parameters">
     7.5.3. Choosing the most appropriate distribution and indentifying the parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#distribution-fitting-with-distfit">
     7.5.4. Distribution fitting with distfit
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#distribution-fitting-with-python-scipy">
     7.5.5. Distribution Fitting with Python SciPy
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#calculating-the-sum-of-squared-errors">
       7.5.5.1. Calculating the sum of squared errors
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#get-data-points-from-a-histogram-in-python-from-matplotlib">
       7.5.5.2. Get data points from a histogram in Python from matplotlib
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="practical-statistics">
<h1><span class="section-number">7. </span>Practical Statistics<a class="headerlink" href="#practical-statistics" title="Permalink to this headline">¶</a></h1>
<section id="density-plots-and-estimates">
<h2><span class="section-number">7.1. </span>Density Plots and Estimates<a class="headerlink" href="#density-plots-and-estimates" title="Permalink to this headline">¶</a></h2>
<p>A histogram is a visual representation of a frequency table, with the data count on the y-axis and the bins on the x-axis. It displays the amount of occurrences of certain values. In Chapter 4, we have learned how to make a histogram with pandas and plotnine.</p>
<p>A density plot is similar to a histogram in that it representts the distribution of data values as a continuous line.</p>
<p>A density plot can be thought of as a smoothed histogram, which is normally produced directly from the data using a <strong>kernel density estimate (KDE)</strong>.</p>
<p>Both histograms and KDEs are supported by the majority of major data science libraries. For example, in pandas, we can use <code class="docutils literal notranslate"><span class="pre">df.hist</span></code> to plot a histogram of data for a given DataFrame. <code class="docutils literal notranslate"><span class="pre">df.plot.density()</span></code>, on the other hand, returns a KDE plot with Gaussian kernels.</p>
<p>Recall that the histogram in the 1967 income distribution values of the Gapminder dataset revealed a dichotomy (two groups). In the following example, a density estimate is superimposed on a histogram of the income distribution with the following Python commands.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">plotnine</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="o">*</span>

<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">IFrame</span><span class="p">,</span> <span class="n">YouTubeVideo</span><span class="p">,</span> <span class="n">SVG</span><span class="p">,</span> <span class="n">HTML</span>

<span class="c1"># Add this line so you can plot your charts into your Jupyter Notebook.</span>
<span class="o">%</span><span class="k">matplotlib</span> inline 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="o">/</span><span class="n">var</span><span class="o">/</span><span class="n">folders</span><span class="o">/</span><span class="n">kl</span><span class="o">/</span><span class="n">h_r05n_j76n32kt0dwy7kynw0000gn</span><span class="o">/</span><span class="n">T</span><span class="o">/</span><span class="n">ipykernel_5496</span><span class="o">/</span><span class="mf">3222504104.</span><span class="n">py</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="ne">----&gt; </span><span class="mi">3</span> <span class="kn">from</span> <span class="nn">plotnine</span> <span class="kn">import</span> <span class="o">*</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="o">*</span>
<span class="g g-Whitespace">      </span><span class="mi">5</span> 

<span class="ne">ModuleNotFoundError</span>: No module named &#39;plotnine&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># for inline plots in jupyter</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="c1"># import matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="c1"># for latex equations</span>
<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">Math</span><span class="p">,</span> <span class="n">Latex</span>
<span class="c1"># for displaying images</span>
<span class="kn">from</span> <span class="nn">IPython.core.display</span> <span class="kn">import</span> <span class="n">Image</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">gapminder</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;/Users/Kaemyuijang/SCMA248/Data/gapminder_full.csv&#39;</span><span class="p">)</span>

<span class="c1">#url = &#39;https://raw.githubusercontent.com/STLinde/Anvendt-Statistik/main/gapminder_full.csv&#39;</span>
<span class="c1">#gapminder = pd.read_csv(url)</span>
<span class="c1">#gapminder[&#39;year&#39;].unique()</span>

<span class="n">past_year</span> <span class="o">=</span> <span class="mi">1967</span>

<span class="n">gapminder1967</span> <span class="o">=</span> <span class="n">gapminder</span><span class="o">.</span><span class="n">pipe</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">dollars_per_day</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">gdp_cap</span><span class="o">/</span><span class="mi">365</span><span class="p">))</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;year == @past_year&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># see https://plotnine.readthedocs.io/en/stable/generated/plotnine.stats.stat_density.html#plotnine.stats.stat_density</span>
<span class="c1"># plotnine.mapping.after_stat evaluates mapping after statistic has been calculated</span>

<span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">gapminder1967</span><span class="p">)</span> <span class="o">+</span> 
    <span class="n">aes</span><span class="p">(</span><span class="s1">&#39;dollars_per_day&#39;</span><span class="p">)</span> <span class="o">+</span>
    <span class="n">geom_histogram</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">after_stat</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">)),</span> <span class="n">binwidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span> <span class="o">+</span>
    <span class="n">geom_density</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">after_stat</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">)))</span> <span class="o">+</span>
    <span class="n">scale_x_continuous</span><span class="p">(</span><span class="n">trans</span> <span class="o">=</span> <span class="s1">&#39;log2&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Chapter5_Practical_Statistics_6_0.png" src="_images/Chapter5_Practical_Statistics_6_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (310164697)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># see https://plotnine.readthedocs.io/en/stable/generated/plotnine.stats.stat_density.html#plotnine.stats.stat_density</span>
<span class="c1"># plotnine.mapping.after_stat evaluates mapping after statistic has been calculated</span>

<span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">gapminder1967</span><span class="p">)</span> <span class="o">+</span> 
    <span class="n">aes</span><span class="p">(</span><span class="s1">&#39;dollars_per_day&#39;</span><span class="p">)</span> <span class="o">+</span>
    <span class="n">geom_histogram</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">after_stat</span><span class="p">(</span><span class="s1">&#39;density&#39;</span><span class="p">)),</span> <span class="n">binwidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span> <span class="o">+</span>
    <span class="n">geom_density</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">after_stat</span><span class="p">(</span><span class="s1">&#39;density&#39;</span><span class="p">)))</span> <span class="o">+</span>
    <span class="n">scale_x_continuous</span><span class="p">(</span><span class="n">trans</span> <span class="o">=</span> <span class="s1">&#39;log2&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Chapter5_Practical_Statistics_7_0.png" src="_images/Chapter5_Practical_Statistics_7_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (278383825)&gt;
</pre></div>
</div>
</div>
</div>
<p>The scale of the y-axis of the KDE differs from the histogram presented in Figures above. A density plot corresponds to plotting the histogram as a <strong>proportion</strong> rather than counts (you indicate this with the <code class="docutils literal notranslate"><span class="pre">aes(y=after_stat('density')</span></code> parameter). You calculate areas under the curve between any two points on the x-axis, which correspond to the proportion of the distribution residing between those two locations, instead of counting in bins.</p>
<p><strong>Exercise</strong> use <code class="docutils literal notranslate"><span class="pre">plot.hist</span></code> and <code class="docutils literal notranslate"><span class="pre">plot.density</span></code> to  display a density estimate of income distribution superposed on a histogram.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># gapminder1967[&#39;dollars_per_day&#39;].plot.hist(density=True)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="correlation">
<h2><span class="section-number">7.2. </span>Correlation<a class="headerlink" href="#correlation" title="Permalink to this headline">¶</a></h2>
<p>In many modeling initiatives (whether in data science or research), exploratory data analysis requires looking for correlations among predictors and between predictors and a target variable.</p>
<p><strong>Positively correlated</strong> variables X and Y (each with measured data) are those in which high values of X correspond to high values of Y and low values of X correspond to low values of Y.</p>
<p>The variables are <strong>negatively correlated</strong> if high values of X correspond to low values of Y and vice versa.</p>
<p><strong>Correlation Term Glossary</strong></p>
<ul class="simple">
<li><p><strong>(Pearson’s) Correlation coefficient</strong>
This metric, which goes from –1 to +1, quantifies the degree to which numeric variables are associated to one another.</p></li>
<li><p><strong>Correlation matrix</strong>
The variables are displayed on both rows and columns in this table, and the cell values represent the correlations between the variables.</p></li>
</ul>
<p>To get Pearson’s correlation coefficient, we multiply deviations from the mean for variable 1 times those for variable 2, and divide by the product of the standard deviations:
Given paired data $<span class="math notranslate nohighlight">\({\displaystyle \left\{(x_{1},y_{1}),\ldots ,(x_{n},y_{n})\right\}}{\displaystyle \left\{(x_{1},y_{1}),\ldots ,(x_{n},y_{n})\right\}}\)</span><span class="math notranslate nohighlight">\( consisting of \)</span>{\displaystyle n}$ pairs</p>
<div class="math notranslate nohighlight">
\[{\displaystyle r_{xy}={\frac {\sum _{i=1}^{n}(x_{i}-{\bar {x}})(y_{i}-{\bar {y}})}{{\sqrt {\sum _{i=1}^{n}(x_{i}-{\bar {x}})^{2}}}{\sqrt {\sum _{i=1}^{n}(y_{i}-{\bar {y}})^{2}}}}}}\]</div>
<p>or</p>
<div class="math notranslate nohighlight">
\[{\displaystyle r_{xy}={\frac {1}{n-1}}\sum _{i=1}^{n}\left({\frac {x_{i}-{\bar {x}}}{s_{x}}}\right)\left({\frac {y_{i}-{\bar {y}}}{s_{y}}}\right)}\]</div>
<section id="the-correlation-matrix">
<h3><span class="section-number">7.2.1. </span>The correlation matrix<a class="headerlink" href="#the-correlation-matrix" title="Permalink to this headline">¶</a></h3>
<p>The correlation matrix presents the relationship between all of the variable (feature) pairs. It is frequently the initial step in dimensionality reduction because it shows you how many features are tightly connected (and so may be discarded) versus how many are independent.</p>
<p>For illustration, let us use the Iris Data Set, containing four features of three Iris classes.
The correlation matrix may be simply computed using the following code:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Need to transpose the Iris dataset (which is the numpy array) before </span>
<span class="c1"># applying corrcoef</span>

<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">iris</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span>


<span class="c1">#cov_data = np.corrcoef(iris.data.T)</span>
<span class="c1">#import matplotlib.pyplot as plt</span>
<span class="c1">#img = plt.matshow(cov_data, cmap=plt.cm.winter)</span>
<span class="c1">#plt.colorbar(img, ticks=[-1, 0, 1])</span>
<span class="c1">#print(cov_data)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">iris</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">iris</span><span class="o">.</span><span class="n">feature_names</span><span class="p">)</span>

<span class="n">df</span><span class="p">[</span><span class="s2">&quot;target&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">iris</span><span class="o">.</span><span class="n">target</span>

<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.1</td>
      <td>3.5</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4.9</td>
      <td>3.0</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.7</td>
      <td>3.2</td>
      <td>1.3</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.6</td>
      <td>3.1</td>
      <td>1.5</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5.0</td>
      <td>3.6</td>
      <td>1.4</td>
      <td>0.2</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="finding-correlation-between-two-variables">
<h3><span class="section-number">7.2.2. </span>Finding Correlation Between Two Variables<a class="headerlink" href="#finding-correlation-between-two-variables" title="Permalink to this headline">¶</a></h3>
<p>The pandas dataframe provides the method called <code class="docutils literal notranslate"><span class="pre">corr()</span></code> to find the correlation between the variables. It calculates the correlation between the two variables.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">correlation</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;sepal length (cm)&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;petal length (cm)&quot;</span><span class="p">])</span>

<span class="n">correlation</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8717537758865831
</pre></div>
</div>
</div>
</div>
<p>The correlation between the features sepal length and petal length is around 0.8717. The number is closer to 1, which means these two features are highly correlated.</p>
</section>
<section id="plotting-correlation-matrix">
<h3><span class="section-number">7.2.3. </span>Plotting Correlation Matrix<a class="headerlink" href="#plotting-correlation-matrix" title="Permalink to this headline">¶</a></h3>
<p>In this section, you’ll plot the correlation matrix by using the background gradient colors. This internally uses the matplotlib library.</p>
<p>First, find the correlation between each variable available in the dataframe using the <code class="docutils literal notranslate"><span class="pre">corr()</span></code> method. The <code class="docutils literal notranslate"><span class="pre">corr()</span></code> method will give a matrix with the correlation values between each variable.</p>
<p>Now, set the background gradient for the correlation data. Then, you’ll see the correlation matrix colored.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">corr</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">corr</span>
<span class="c1"># corr.style.background_gradient(cmap=&#39;coolwarm&#39;)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sepal length (cm)</th>
      <th>sepal width (cm)</th>
      <th>petal length (cm)</th>
      <th>petal width (cm)</th>
      <th>target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>sepal length (cm)</th>
      <td>1.000000</td>
      <td>-0.117570</td>
      <td>0.871754</td>
      <td>0.817941</td>
      <td>0.782561</td>
    </tr>
    <tr>
      <th>sepal width (cm)</th>
      <td>-0.117570</td>
      <td>1.000000</td>
      <td>-0.428440</td>
      <td>-0.366126</td>
      <td>-0.426658</td>
    </tr>
    <tr>
      <th>petal length (cm)</th>
      <td>0.871754</td>
      <td>-0.428440</td>
      <td>1.000000</td>
      <td>0.962865</td>
      <td>0.949035</td>
    </tr>
    <tr>
      <th>petal width (cm)</th>
      <td>0.817941</td>
      <td>-0.366126</td>
      <td>0.962865</td>
      <td>1.000000</td>
      <td>0.956547</td>
    </tr>
    <tr>
      <th>target</th>
      <td>0.782561</td>
      <td>-0.426658</td>
      <td>0.949035</td>
      <td>0.956547</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="plotting-correlation-heatmap">
<h3><span class="section-number">7.2.4. </span>Plotting Correlation HeatMap<a class="headerlink" href="#plotting-correlation-heatmap" title="Permalink to this headline">¶</a></h3>
<p>We can visualize the correlation matrix in a graphical form using a heatmap from  the Seaborn library.</p>
<p>In what follows, you can add title and axes labels using the <code class="docutils literal notranslate"><span class="pre">heatmap.set(xlabel=’X</span> <span class="pre">Axis</span> <span class="pre">label’,</span> <span class="pre">ylabel=’Y</span> <span class="pre">axis</span> <span class="pre">label’,</span> <span class="pre">title=’title’)</span></code>.</p>
<p>After setting the values, you can use the <code class="docutils literal notranslate"><span class="pre">plt.show()</span></code> method to plot the heat map with the x-axis label, y-axis label, and the title for the heat map.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">hm</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">corr</span><span class="p">(),</span> <span class="n">annot</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">hm</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">IRIS Flower Details&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;IRIS Flower Details</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Correlation matrix of IRIS data</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/Users/Kaemyuijang/opt/anaconda3/lib/python3.7/site-packages/IPython/core/pylabtools.py:151: UserWarning: Glyph 9 (	) missing from current font.
</pre></div>
</div>
<img alt="_images/Chapter5_Practical_Statistics_21_1.png" src="_images/Chapter5_Practical_Statistics_21_1.png" />
</div>
</div>
<p>The value of the diagonals is 1 as you can see in the preceding figure. There is also a strong link (high correlation) between the first and third features, the first and fourth features, and the third and fourth features. As a result, we can observe that only the second feature is nearly independent of the others; the rest are associated in some way.</p>
<p>The correlation coefficient, like the mean and standard deviation, is sensitive to outliers in the data. Robust alternatives to the traditional correlation coefficient are available in software packages. The methods in the <code class="docutils literal notranslate"><span class="pre">sklearn.covariance</span></code> scikit-learn module implement a range of approaches. 􏰜See <a class="reference external" href="http://scikit-learn.org/stable/modules/covariance.html">http://scikit-learn.org/stable/modules/covariance.html</a> for more detail.</p>
<p>To use plotnine to create the heatmap, see <a class="reference external" href="https://www.r-bloggers.com/2021/06/plotnine-make-great-looking-correlation-plots-in-python/">https://www.r-bloggers.com/2021/06/plotnine-make-great-looking-correlation-plots-in-python/</a></p>
</section>
</section>
<section id="data-and-sampling-distributions">
<h2><span class="section-number">7.3. </span>Data and Sampling Distributions<a class="headerlink" href="#data-and-sampling-distributions" title="Permalink to this headline">¶</a></h2>
<p>When we are working on a problem with a large data set, it is usually not possible or necessary to work with the entire data set unless you want to wait hours for processing transformations and feature engineering to complete.</p>
<p>Drawing a sample from your data that is informative enough to discover important insights is a more effective method that will still allow you to draw accurate conclusions from your results.</p>
<p>Let us have a look at some fundamental terminology.</p>
<p>The term <strong>“population”</strong> refers to a grouping of items that share some property. The population size is determined by the number of elements in the population.</p>
<p>The term <strong>“sample”</strong> refers to a portion of the population. Sampling is the procedure for picking a sample. The sample size is the number of elements in the sample.</p>
<p>The term <strong>“probability Sampling method”</strong> employs randomization to ensure that every member of the population has an equal probability of being included in the chosen sample. <strong>Random sampling</strong> is another name for it.</p>
<p>The figure below depicts a diagram that explains the principles of data and sampling distributions that we will cover in this chapter.</p>
<p><img alt="Image from oreilly" src="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/assets/psds_0201.png" /></p>
<p>Image source: <a class="reference external" href="https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/assets/psds_0201.png">https://www.oreilly.com/library/view/practical-statistics-for/9781491952955/assets/psds_0201.png</a></p>
<p>The population on the left represents a population that is believed to <strong>follow an underlying but unknown distribution in statistics</strong>. Only the sample data and its empirical distribution, as shown on the right, are available.</p>
<p><strong>A sampling process</strong> is utilized to move from the left to the right side (represented by an arrow).</p>
<ul class="simple">
<li><p>Traditional statistics emphasized the left side, employing theory based on strong assumptions about the population.</p></li>
<li><p>Modern statistics has shifted to the righthand side, eliminating the need for such assumptions.</p></li>
</ul>
<p>When compared to working with full or complete datasets, sampling offers numerous advantages, including lower costs and faster processing.</p>
<p>To sample data, you must first specify your population and the procedure for selecting (and sometimes rejecting) observations for inclusion in your sample. The population parameters you want to estimate with the sample could very well describe this.</p>
<p>Before obtaining a data sample, think about the following points:</p>
<ul class="simple">
<li><p>Sample Goal. The population property (parameters) that you wish to estimate using the sample.</p></li>
<li><p>Population. The range or domain within which observations could be made.</p></li>
<li><p>Selection Criteria.   The procedure for accepting or rejecting observations from your sample.</p></li>
<li><p>Sample Size. The number of observations that will constitute the sample.</p></li>
</ul>
<section id="sampling-bias">
<h3><span class="section-number">7.3.1. </span>Sampling bias<a class="headerlink" href="#sampling-bias" title="Permalink to this headline">¶</a></h3>
<p>One of the most common types of biases seen in real-world scenarios is sampling bias.</p>
<p>Sampling bias arises when some members of a population are systematically more likely to be selected in a sample than others.</p>
<p>In machine learning, it arises when the data used to train a model does not accurately reflect the distribution of samples that the model would encounter in the production.</p>
</section>
<section id="types-of-sampling-techniques">
<h3><span class="section-number">7.3.2. </span>Types of sampling techniques<a class="headerlink" href="#types-of-sampling-techniques" title="Permalink to this headline">¶</a></h3>
<p><img alt="Image from questionpro" src="https://cdn.scribbr.com/wp-content/uploads/2019/09/probability-sampling.png" /></p>
<p>Image source: <a class="reference external" href="https://cdn.scribbr.com/wp-content/uploads/2019/09/probability-sampling.png">https://cdn.scribbr.com/wp-content/uploads/2019/09/probability-sampling.png</a></p>
<section id="simple-random-sampling">
<h4><span class="section-number">7.3.2.1. </span>Simple random sampling<a class="headerlink" href="#simple-random-sampling" title="Permalink to this headline">¶</a></h4>
<p>The simple random sampling is the simplest straightforward approach to sample data. In essence, the subset is made up of observations that were randomly selected from a bigger set; each observation has the same chance of being chosen from the larger set.</p>
<p>Simple random sampling is simple and straightforward to implement. However, it’s still feasible that we’ll introduce bias into our sample data. Consider a scenario in which we have a large dataset with unbalanced labels (or categories). We may mistakenly fail to collect enough cases to represent the minority class by using simple random sampling.</p>
<p><strong>Example</strong> You wish to choose a simple random sample of 100 employees of the company . You assign a number from 1 to 1000 to each employee in the company database, and then choose 100 numbers using a random number generator.</p>
<p><img alt="Image from gcumedia" src="https://lc.gcumedia.com/hlt362v/the-visual-learner/images/simple-random-sample.png" /></p>
<p>Image source: <a class="reference external" href="https://lc.gcumedia.com/hlt362v/the-visual-learner/images/simple-random-sample.png">https://lc.gcumedia.com/hlt362v/the-visual-learner/images/simple-random-sample.png</a></p>
<p>For illustration, we will be using synthetic data which can be prepared in Python as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create synthetic data</span>
<span class="nb">id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">height</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">165</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="nb">id</span><span class="p">)),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># convert to pandas dataframe</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="nb">id</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">height</span><span class="p">}</span> 
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>166.34</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>126.03</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>166.33</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>191.29</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>147.31</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>153.55</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>183.67</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>154.53</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>177.61</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>187.80</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To perform random sampling, Python pandas includes a method called <code class="docutils literal notranslate"><span class="pre">sample()</span></code>. You can use <code class="docutils literal notranslate"><span class="pre">random_state</span></code> for reproducibility.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># simple sampling example</span>
<span class="n">simple_random_sample</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">888</span><span class="p">)</span> 
<span class="n">simple_random_sample</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>166.33</td>
    </tr>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>166.34</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>177.61</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>153.55</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>147.31</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="systematic-sampling">
<h4><span class="section-number">7.3.2.2. </span>Systematic sampling<a class="headerlink" href="#systematic-sampling" title="Permalink to this headline">¶</a></h4>
<p>Systematic sampling is similar to simple random sampling, but it is usually slightly easier to carry out. Every person in the population is assigned a number, but rather than assigning numbers at random, individuals are chosen at regular intervals.</p>
<p>When the observations are randomized, systematic sampling usually yields a better sample than simple random sampling. If our data contains periodicity or repeating patterns, however, systematic sampling is not suitable.</p>
<p><strong>Example</strong> All of the company’s employees are listed alphabetically. You choose a starting point at random from the first ten numbers: number 6. Every tenth individual on the list is chosen from number 6 onwards (6, 16, 26, 36, and so on), resulting in a sample of 100 persons.</p>
<p><img alt="Image from gcumedia" src="https://lc.gcumedia.com/hlt362v/the-visual-learner/images/systematic-sampling.png" /></p>
<p>Image source: <a class="reference external" href="https://lc.gcumedia.com/hlt362v/the-visual-learner/images/systematic-sampling.png">https://lc.gcumedia.com/hlt362v/the-visual-learner/images/systematic-sampling.png</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># interval sampling example</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span> <span class="n">step</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span> <span class="c1">#Return evenly spaced values within a given interval.</span>
<span class="n">interval_sample</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">interval_sample</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>166.34</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>166.33</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>147.31</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>183.67</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>177.61</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="stratified-sampling">
<h4><span class="section-number">7.3.2.3. </span>Stratified Sampling<a class="headerlink" href="#stratified-sampling" title="Permalink to this headline">¶</a></h4>
<p>Stratified random sampling is a kind of probability sampling in which a research organization divides the total population into many non-overlapping, homogenous groups (strata) and selects final members for research at random from the various strata. Each of these groupings’ members should be unique enough that every member of each group has an equal chance of being chosen using basic probability. The number of instances from each stratum to choose from is proportionate to the stratum’s size.</p>
<p>Arranging or classifying by  age, socioeconomic divisions, nationality, religion, educational achievements is a common practice.</p>
<p><strong>Example:</strong> There are 800 female employees and 200 male employees at the company. You select the population into two strata based on gender to ensure that the sample reflects the company’s gender balance. Then you select 80 women and 20 men at random from each group, giving you a representative sample of 100 people.</p>
<p><strong>Example:</strong> Consider the following scenario: a study team is looking for opinions on investing in Crypto from people of various ages. Instead of polling all Thai nationals, a random sample of roughly 10,000 people could be chosen for research. These ten thousand people can be separated into age groups, such as 18-29, 30-39, 40-49, 50-59, and 60 and up. Each stratum will have its own set of members and numbers.</p>
<p><img alt="Image from gcumedia" src="https://lc.gcumedia.com/hlt362v/the-visual-learner/images/stratified-sample.png" /></p>
<p>Image source: <a class="reference external" href="https://lc.gcumedia.com/hlt362v/the-visual-learner/images/stratified-sample.png">https://lc.gcumedia.com/hlt362v/the-visual-learner/images/stratified-sample.png</a></p>
<p>Here we will use Scikit-learn for stratified sampling. Note that you will see this in more details later in the chapter on Introduction to Machine Leaning.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create synthetic data</span>
<span class="c1"># id = np.arange(0, 10).tolist()</span>
<span class="c1"># height = np.round(np.random.normal(loc=165, scale =15, size=len(id)), 2)</span>

<span class="c1"># convert to pandas dataframe</span>
<span class="c1"># data = {&quot;id&quot;:id, &quot;height&quot;: height} </span>
<span class="c1"># df = pd.DataFrame(data=data)</span>
<span class="c1"># df</span>
</pre></div>
</div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">StratifiedKFold</span></code> module in Scikit-learn sets up <code class="docutils literal notranslate"><span class="pre">n_splits</span></code> (folds, partitions or groups) of the dataset in a way that the folds are made by <strong>preserving the percentage of samples for each class</strong>.</p>
<p>The brief explaination for the code below (also see the diagram below) is as follows:</p>
<ol class="simple">
<li><p>The dataset has been split into K (K = 2 in our example) equal  partitions (or folds).</p></li>
<li><p>(In iteration 1) use fold 1 as the testing set and the union of the other folds as the training set.</p></li>
<li><p>Repeat step 2 for K times, using a different fold as the testing set each time.</p></li>
</ol>
<p><img alt="Image from gcumedia" src="https://www.researchgate.net/profile/Mingchao-Li/publication/331209203/figure/fig2/AS:728070977748994&#64;1550597056956/K-fold-cross-validation-method_W640.jpg" /></p>
<p>Image source: <a class="reference external" href="https://www.researchgate.net/profile/Mingchao-Li/publication/331209203/figure/fig2/AS:728070977748994&#64;1550597056956/K-fold-cross-validation-method_W640.jpg">https://www.researchgate.net/profile/Mingchao-Li/publication/331209203/figure/fig2/AS:728070977748994&#64;1550597056956/K-fold-cross-validation-method_W640.jpg</a></p>
<p>This sampling strategy tends to improve the representativeness of the sample by reducing the amount of bias we introduce; in the worst-case scenario, our resulting sample would be no worse than random sampling. Determining the strata, on the other hand, can be a tough operation because it necessitates a thorough understanding of the data’s features. It’s also the most time-consuming of the approaches discussed.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create synthetic data</span>
<span class="c1"># population size of 20</span>

<span class="nb">id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">height</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">165</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="nb">id</span><span class="p">)),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># convert to pandas dataframe</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="nb">id</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">height</span><span class="p">}</span> 
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedKFold</span>

<span class="c1"># dividing the data into groups</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;strata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># instantiating stratified sampling</span>
<span class="n">stratified</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>

<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">stratified</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;strata&quot;</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TRAIN INDEX:&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;TEST INDEX:&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">stratified_random_sample</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> 

<span class="c1">#stratified_random_sample</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TRAIN INDEX: [ 5  6  7  8  9 15 16 17 18 19] TEST INDEX: [ 0  1  2  3  4 10 11 12 13 14]
TRAIN INDEX: [ 0  1  2  3  4 10 11 12 13 14] TEST INDEX: [ 5  6  7  8  9 15 16 17 18 19]
</pre></div>
</div>
</div>
</div>
<p>By supplying <code class="docutils literal notranslate"><span class="pre">shufle=True</span></code>, each class’s samples will be shuffled before splitting into batches. Note also that the samples within each split will not be shuffled. We also use <code class="docutils literal notranslate"><span class="pre">n_splits=4</span></code> in the following code below:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">StratifiedKFold</span>

<span class="c1"># dividing the data into groups</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;strata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="c1"># instantiating stratified sampling</span>
<span class="n">stratified</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">888</span><span class="p">)</span>

<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">stratified</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;strata&quot;</span><span class="p">]):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TRAIN INDEX:&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;TEST INDEX:&quot;</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">stratified_random_sample</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> 

<span class="c1">#stratified_random_sample</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TRAIN INDEX: [ 2  3  4  6  7  8  9 11 12 13 14 15 16 17 18] TEST INDEX: [ 0  1  5 10 19]
TRAIN INDEX: [ 0  1  2  5  6  7  9 10 11 12 13 14 16 17 19] TEST INDEX: [ 3  4  8 15 18]
TRAIN INDEX: [ 0  1  2  3  4  5  6  8 10 11 14 15 17 18 19] TEST INDEX: [ 7  9 12 13 16]
TRAIN INDEX: [ 0  1  3  4  5  7  8  9 10 12 13 15 16 18 19] TEST INDEX: [ 2  6 11 14 17]
</pre></div>
</div>
</div>
</div>
<p>The following code can be used to acsess a single batch instead of using <code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">loop</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## sklearn Kfold access single fold instead of for loop</span>
<span class="c1">## https://stackoverflow.com/questions/27380636/sklearn-kfold-acces-single-fold-instead-of-for-loop</span>

<span class="n">skf</span> <span class="o">=</span> <span class="n">stratified</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;strata&quot;</span><span class="p">])</span>
<span class="n">mylist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">skf</span><span class="p">)</span>

<span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">mylist</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span>

<span class="n">stratified_random_sample_train</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> 
<span class="n">stratified_random_sample_test</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> 

<span class="nb">print</span><span class="p">(</span><span class="n">stratified_random_sample_train</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    id  height  strata
0    0  160.56       1
1    1  141.48       1
3    3  147.74       1
4    4  186.11       1
5    5  130.88       1
7    7  159.12       1
8    8  172.77       1
9    9  147.52       1
10  10  136.51       2
12  12  183.23       2
13  13  171.81       2
15  15  141.52       2
16  16  162.69       2
18  18  156.08       2
19  19  167.08       2
</pre></div>
</div>
</div>
</div>
<p>Alternative to the above approach, we use the <code class="docutils literal notranslate"><span class="pre">next()</span></code> function that returns the next item from the iterator. See <a class="reference external" href="https://www.programiz.com/python-programming/methods/built-in/next">https://www.programiz.com/python-programming/methods/built-in/next</a> for more detail.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://stackoverflow.com/questions/27380636/sklearn-kfold-acces-single-fold-instead-of-for-loop</span>
<span class="c1"># https://stackoverflow.com/questions/2300756/get-the-nth-item-of-a-generator-in-python</span>
<span class="c1"># In Python, Itertools is the inbuilt module that allows us to handle the iterators in an efficient way. They make iterating through the iterables like lists and strings very easily. One such itertools function is islice().</span>


<span class="c1">#from itertools import islice, count</span>
<span class="kn">import</span> <span class="nn">itertools</span>


<span class="n">skf</span> <span class="o">=</span> <span class="n">stratified</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;strata&quot;</span><span class="p">])</span>

<span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">itertools</span><span class="o">.</span><span class="n">islice</span><span class="p">(</span><span class="n">skf</span><span class="p">,</span><span class="n">index</span><span class="p">,</span><span class="kc">None</span><span class="p">))</span>

<span class="n">stratified_random_sample_train</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> 
<span class="n">stratified_random_sample_test</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> 

<span class="nb">print</span><span class="p">(</span><span class="n">stratified_random_sample_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stratified_random_sample_test</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    id  height  strata
2    2  171.95       1
3    3  147.74       1
4    4  186.11       1
6    6  147.88       1
7    7  159.12       1
8    8  172.77       1
9    9  147.52       1
11  11  147.56       2
12  12  183.23       2
13  13  171.81       2
14  14  178.27       2
15  15  141.52       2
16  16  162.69       2
17  17  162.48       2
18  18  156.08       2
    id  height  strata
0    0  160.56       1
1    1  141.48       1
5    5  130.88       1
10  10  136.51       2
19  19  167.08       2
</pre></div>
</div>
</div>
</div>
<p>This sampling strategy tends to improve the representativeness of the sample by reducing the amount of bias we introduce; in the worst-case scenario, our resulting sample would be no worse than random sampling. Determining the strata, on the other hand, can be a tough operation because it necessitates a thorough understanding of the data’s features. It’s also the most time-consuming of the approaches discussed.</p>
<p><strong>Exercise:</strong> This exercise aims to explain how <code class="docutils literal notranslate"><span class="pre">StratifiedKFold</span></code> can be used for stratified sampling.</p>
<ol class="simple">
<li><p>What is the class ratio for the column “strata”, i.e. the proportion of data which are in strata (groups) 1 and 2?</p></li>
</ol>
<p>Note that when we create our folds we want each split to have this same percentage of categories (groups).</p>
<p>When we perform the splits we will need to tell the function which column we are going to use as the target, strata in this case. The command will be
<code class="docutils literal notranslate"><span class="pre">stratified.split(df,</span> <span class="pre">df[&quot;strata&quot;])</span></code>.</p>
<p>Then we use a for loop and StratifiedKFold’s split operation to get the train and test row indexes for each split.</p>
<p>We can then use these indexes to split our data into train and test dataframes.</p>
<ol class="simple">
<li><p>What are the indexes used in the train data and test data in the first batch (or split)?</p></li>
<li><p>Determine the class ratio for each batch (split) from the test set (you may also want to try for the training set).</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create synthetic data</span>
<span class="c1"># Population size of 100</span>

<span class="nb">id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">height</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">165</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="nb">id</span><span class="p">)),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># convert to pandas dataframe</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="nb">id</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">height</span><span class="p">}</span> 
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># dividing the data into groups</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;strata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span><span class="mf">0.8</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)])</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Solutions to exercise</strong></p>
<ol class="simple">
<li><p>What is the class ratio for the column “strata”, i.e. the proportion of data which are in strata (groups) 1 and 2?</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;strata&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">id</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>strata
1    20
2    80
Name: id, dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Ans: the class ratio of strata 1 to 2 is 1:4.</p>
<ol class="simple">
<li><p>What are the indexes used in the train data and test data in the first batch (or split)?</p></li>
</ol>
<p>Ans: skf is actually a <strong>generator</strong>, which does not compute the train-test split until it is needed. This <strong>improves memory usage</strong>, as you are not storing items you do not need. Making a list of the skf object forces it to make all values available.</p>
<p>The following Python commands can be applied to access the indexes of the train data and test data in the first split (or the n-th split). Simply change the value of the <code class="docutils literal notranslate"><span class="pre">index</span></code> variable to access different splits:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">## sklearn Kfold acces single fold instead of for loop</span>
<span class="c1">## https://stackoverflow.com/questions/27380636/sklearn-kfold-acces-single-fold-instead-of-for-loop</span>

<span class="c1"># instantiating stratified sampling</span>

<span class="n">K</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">stratified</span> <span class="o">=</span> <span class="n">StratifiedKFold</span><span class="p">(</span><span class="n">n_splits</span><span class="o">=</span><span class="n">K</span><span class="p">)</span>

<span class="n">skf</span> <span class="o">=</span> <span class="n">stratified</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;strata&quot;</span><span class="p">])</span>
<span class="n">mylist</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">skf</span><span class="p">)</span>

<span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">mylist</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

<span class="n">stratified_random_sample_train</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> 
<span class="n">stratified_random_sample_test</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> 

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Training set: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">stratified_random_sample_train</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The class ratio of groups 1 to 2 in this batch of the training set is&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stratified_random_sample_train</span><span class="p">[</span><span class="s1">&#39;strata&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Test set: </span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">stratified_random_sample_test</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The class ratio of groups 1 to 2 in this batch of the test set is&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">stratified_random_sample_test</span><span class="p">[</span><span class="s1">&#39;strata&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Training set: 
     id  height  strata
5    5  168.29       1
6    6  163.27       1
7    7  164.88       1
8    8  163.55       1
9    9  157.62       1
..  ..     ...     ...
95  95  151.83       2
96  96  163.17       2
97  97  155.09       2
98  98  164.62       2
99  99  171.49       2

[75 rows x 3 columns]
The class ratio of groups 1 to 2 in this batch of the training set is
2    60
1    15
Name: strata, dtype: int64
Test set: 
     id  height  strata
0    0  188.69       1
1    1  163.28       1
2    2  153.06       1
3    3  170.40       1
4    4  175.91       1
20  20  159.42       2
21  21  172.81       2
22  22  161.30       2
23  23  152.85       2
24  24  184.57       2
25  25  136.93       2
26  26  160.15       2
27  27  146.00       2
28  28  156.73       2
29  29  161.16       2
30  30  158.09       2
31  31  173.13       2
32  32  164.89       2
33  33  190.48       2
34  34  160.57       2
35  35  165.80       2
36  36  184.03       2
37  37  147.90       2
38  38  189.03       2
39  39  162.01       2
The class ratio of groups 1 to 2 in this batch of the test set is
2    20
1     5
Name: strata, dtype: int64
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Determine the class ratio for each batch (split) from the test set (you may also want to try for the training set).</p></li>
</ol>
<p>Ans: We can use for loop to go through each split of the <strong>generator, StratifiedKFold(n_splits=K) within the test split.</strong></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">split_no</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">stratified</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">df</span><span class="p">[</span><span class="s2">&quot;strata&quot;</span><span class="p">]):</span>
    <span class="c1"># print(&quot;TRAIN INDEX:&quot;, x, &quot;TEST INDEX:&quot;, y)</span>
    <span class="n">stratified_random_sample</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">x</span><span class="p">]</span> 
    <span class="n">stratified_random_sample</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">y</span><span class="p">]</span> 
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Batch&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">split_no</span><span class="p">),</span><span class="s1">&#39;: The class ratio of groups (strata) 1 to 2 is&#39;</span><span class="p">,</span> <span class="n">stratified_random_sample_test</span><span class="p">[</span><span class="s1">&#39;strata&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">stratified_random_sample_test</span><span class="p">[</span><span class="s1">&#39;strata&#39;</span><span class="p">]))</span>
    <span class="n">split_no</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Batch 1 : The class ratio of groups (strata) 1 to 2 is 0.2
Batch 2 : The class ratio of groups (strata) 1 to 2 is 0.2
Batch 3 : The class ratio of groups (strata) 1 to 2 is 0.2
Batch 4 : The class ratio of groups (strata) 1 to 2 is 0.2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Determind the class ratio</span>
<span class="c1">#stratified_random_sample_test[&#39;strata&#39;].value_counts()[1]/len(stratified_random_sample_test[&#39;strata&#39;])</span>
</pre></div>
</div>
</div>
</div>
<p><strong>Conclusion</strong> In this example, the population size is 100. If we want a sample based on stratified sampling with the sample size of 25, then we can use the test sets from any of the splits as a sample. For example, the sample using the stratified sampling technique is</p>
<p>Alternative to <code class="docutils literal notranslate"><span class="pre">StratifiedKFold</span></code>, one can use <code class="docutils literal notranslate"><span class="pre">train_test_split</span></code> for stratified sampling.
The train_test_split is the most basic one which just divides the data into two parts according to the specified partitioning ratio. For instance, <code class="docutils literal notranslate"><span class="pre">train_test_split(test_size=0.2)</span></code>.</p>
<p>See <a class="reference external" href="https://towardsdatascience.com/how-to-train-test-split-kfold-vs-stratifiedkfold-281767b93869">https://towardsdatascience.com/how-to-train-test-split-kfold-vs-stratifiedkfold-281767b93869</a> for more detail.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Using train_test_split for stratified sampling:</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

<span class="c1"># create synthetic data</span>
<span class="nb">id</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">height</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">165</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="nb">id</span><span class="p">)),</span> <span class="mi">2</span><span class="p">)</span>

<span class="c1"># convert to pandas dataframe</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;id&quot;</span><span class="p">:</span><span class="nb">id</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">:</span> <span class="n">height</span><span class="p">}</span> 
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="n">df</span>


<span class="c1"># dividing the data into groups</span>
<span class="n">df</span><span class="p">[</span><span class="s2">&quot;strata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">),</span><span class="mf">0.8</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)])</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>

<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">test_size</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="n">stratify</span><span class="o">=</span><span class="n">df</span><span class="p">[</span><span class="s2">&quot;strata&quot;</span><span class="p">],</span> <span class="n">random_state</span> <span class="o">=</span> <span class="mi">888</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="cluster-sampling">
<h4><span class="section-number">7.3.2.4. </span>Cluster Sampling<a class="headerlink" href="#cluster-sampling" title="Permalink to this headline">¶</a></h4>
<p>Cluster Sampling is a method where the entire population is divided into clusters or portions Some of these clusters are then chosen at random. For this sampling, <strong>all of the selcted clusters’ elements</strong> are used.</p>
<p>The term <strong>cluster</strong> refers to a natural intact (but heterogeneous) grouping of the members of the population.</p>
<p>Researchers use this sampling technique to examine a sample that contain multiple sample parameters such as demographics, habits, background – or any other population attribute that is relevant to the research being undertaken.</p>
<p><strong>Example:</strong> The company has offices in twenty different provinces around Thailand (all with roughly the same number of employees in similar roles). Because we do not have the resources to visit every office to collect data, we use random sampling to select three offices as your clusters.</p>
<p><strong>Example:</strong> A researcher in Thailand intends to undertake a study to evaluate sophomores’ performance in science education. It is impossible to undertake a research study in which every university’s student participates. Instead, the researcher can combine the universities from each region into a single cluster through cluster sampling. The sophomore student population in Thailand is then defined by these groupings. Then, using either simple random sampling or systematic random sampling, select clusters for the research project at random.</p>
<p><img alt="Image from gcumedia" src="https://lc.gcumedia.com/hlt362v/the-visual-learner/images/cluster-sampling.png" /></p>
<p>Image source: <a class="reference external" href="https://lc.gcumedia.com/hlt362v/the-visual-learner/images/cluster-sampling.png">https://lc.gcumedia.com/hlt362v/the-visual-learner/images/cluster-sampling.png</a></p>
<p>In the following example, the population is divided into 5 clusters of equal size. Note that heterogeneity is internal within clusters (or groupings), while homogeneity is external (among clusters). A systematic random sampling of the clusters (by select clusters with even cluster_id) is chosen and the elements in each of these clusters are then sampled.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># cluster sampling example</span>
<span class="c1"># removing the strata</span>
<span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;strata&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Divide the units into 5 clusters of equal size</span>
<span class="n">df</span><span class="p">[</span><span class="s1">&#39;cluster_id&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">([</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">)],</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">/</span><span class="mi">5</span><span class="p">)</span>

<span class="c1"># Append the indexes from the clusters that meet the criteria</span>
<span class="n">idx</span> <span class="o">=</span> <span class="p">[]</span>
<span class="c1"># add all observations with an even cluster_id to idx</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)):</span>
    <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;cluster_id&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">idx</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        
<span class="n">cluster_random_sample</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
<span class="n">cluster_random_sample</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>id</th>
      <th>height</th>
      <th>cluster_id</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>10</th>
      <td>10</td>
      <td>163.59</td>
      <td>2</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
      <td>161.27</td>
      <td>2</td>
    </tr>
    <tr>
      <th>12</th>
      <td>12</td>
      <td>157.23</td>
      <td>2</td>
    </tr>
    <tr>
      <th>13</th>
      <td>13</td>
      <td>171.97</td>
      <td>2</td>
    </tr>
    <tr>
      <th>14</th>
      <td>14</td>
      <td>150.42</td>
      <td>2</td>
    </tr>
    <tr>
      <th>15</th>
      <td>15</td>
      <td>179.87</td>
      <td>2</td>
    </tr>
    <tr>
      <th>16</th>
      <td>16</td>
      <td>176.95</td>
      <td>2</td>
    </tr>
    <tr>
      <th>17</th>
      <td>17</td>
      <td>136.71</td>
      <td>2</td>
    </tr>
    <tr>
      <th>18</th>
      <td>18</td>
      <td>141.73</td>
      <td>2</td>
    </tr>
    <tr>
      <th>19</th>
      <td>19</td>
      <td>163.07</td>
      <td>2</td>
    </tr>
    <tr>
      <th>30</th>
      <td>30</td>
      <td>158.31</td>
      <td>4</td>
    </tr>
    <tr>
      <th>31</th>
      <td>31</td>
      <td>143.46</td>
      <td>4</td>
    </tr>
    <tr>
      <th>32</th>
      <td>32</td>
      <td>170.21</td>
      <td>4</td>
    </tr>
    <tr>
      <th>33</th>
      <td>33</td>
      <td>176.85</td>
      <td>4</td>
    </tr>
    <tr>
      <th>34</th>
      <td>34</td>
      <td>152.70</td>
      <td>4</td>
    </tr>
    <tr>
      <th>35</th>
      <td>35</td>
      <td>174.23</td>
      <td>4</td>
    </tr>
    <tr>
      <th>36</th>
      <td>36</td>
      <td>159.46</td>
      <td>4</td>
    </tr>
    <tr>
      <th>37</th>
      <td>37</td>
      <td>142.95</td>
      <td>4</td>
    </tr>
    <tr>
      <th>38</th>
      <td>38</td>
      <td>189.67</td>
      <td>4</td>
    </tr>
    <tr>
      <th>39</th>
      <td>39</td>
      <td>161.76</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This cluster sampling approach is particularly cost-effective because it involves minimal sample preparation labor and is also simple to use. On the other hand, this samplint approach makes it easy to generate biased data.</p>
</section>
</section>
</section>
<section id="distribution-of-random-variables">
<h2><span class="section-number">7.4. </span>Distribution of Random Variables<a class="headerlink" href="#distribution-of-random-variables" title="Permalink to this headline">¶</a></h2>
<p>In this tutorial, we will learn about probability distributions that are often used in machine learning literature and how to implement them in Python.</p>
<p>The underlying components of Data Science are probability and statistics. In truth, statistical mathematics and linear algebra are the core principles of machine learning and artificial intelligence.</p>
<p>You will frequently find yourself in circumstances, particularly in Data Science, where you will need to read a research article that contains a lot of math to understand a certain issue, therefore if you want to improve at Data Science, you will need to have a solid mathematical and statistical understanding.</p>
<p>In this section, we will look at some of the most often used probability distributions in machine learning research.</p>
<p>We will cover the following topics:</p>
<ul class="simple">
<li><p>Learn about probability terminologies such as random variables, density curves, and probability functions.</p></li>
<li><p>Discover the various probability distributions and their distribution functions, as well as some of their features.</p></li>
<li><p>Learn how to use Python to construct and plot these distributions.</p></li>
</ul>
<p>Before you begin, you need be familiar with some mathematical terms, which will be covered in the next section.</p>
<section id="random-variable">
<h3><span class="section-number">7.4.1. </span>Random Variable<a class="headerlink" href="#random-variable" title="Permalink to this headline">¶</a></h3>
<p>A <strong>random variable</strong> is a variable whose possible values are numerical results of a random event. Discrete and continuous random variables are the two forms of random variables.</p>
<section id="discrete-random-variables">
<h4><span class="section-number">7.4.1.1. </span>Discrete random variables<a class="headerlink" href="#discrete-random-variables" title="Permalink to this headline">¶</a></h4>
<p>A <strong>discrete random variable</strong> is one that can only have a finite number of different values and can thus be quantified.</p>
<p>For example, a random variable <span class="math notranslate nohighlight">\(X\)</span> can be defined as the number that appears when a fair dice is rolled. <span class="math notranslate nohighlight">\(X\)</span> is a discrete random variable with the following values: [1,2,3,4,5,6].</p>
<p>The probability distribution of a discrete random variable is a list of probabilities associated with each of its potential values. It’s also known as the <strong>probability mass function (pmf) or the probability function</strong>. Consider a random variable <span class="math notranslate nohighlight">\(X\)</span> that can take <span class="math notranslate nohighlight">\(k\)</span> distinct values, with the probability that <span class="math notranslate nohighlight">\(X=x_i\)</span> being defined as <span class="math notranslate nohighlight">\(P(X=x_i)=p_i\)</span>. The probabilities <span class="math notranslate nohighlight">\(p_i\)</span> must then satisfy the following conditions:</p>
<ol class="simple">
<li><p><span class="math notranslate nohighlight">\(0 &lt; p_i &lt; 1\)</span> for each <span class="math notranslate nohighlight">\(i\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(p_1 + p_2 + \ldots + p_k = 1.\)</span></p></li>
</ol>
<p>Bernoulli distribution, Binomial distribution, Poisson distribution, and other discrete probability distributions are examples.</p>
<p>The following python code generate random samples from the random variable <span class="math notranslate nohighlight">\(X\)</span> that can be defined as the number that appears when a fair dice is rolled, i.e. generate a uniform random sample from <code class="docutils literal notranslate"><span class="pre">np.arange(1,7)</span></code> of size n.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># generate random integer values</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">seed</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randint</span>
<span class="c1"># seed random number generator</span>
<span class="n">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="c1"># sample size</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">3</span>

<span class="c1"># generate some integers</span>
<span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
5
1
</pre></div>
</div>
</div>
</div>
<p>It is much more convenient to use <code class="docutils literal notranslate"><span class="pre">numpy.random.choice</span></code> to generates a random sample from a given 1-D array.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">replace</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([3, 2, 5, 4, 3, 3, 4, 5, 4, 2])
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="continuous-random-variables">
<h3><span class="section-number">7.4.2. </span>Continuous random variables<a class="headerlink" href="#continuous-random-variables" title="Permalink to this headline">¶</a></h3>
<p>A <strong>continuous random variable</strong> can take an infinite number of different values. For example, a random variable X can be defined as the height of pupils in a class.</p>
<p>The area under a curve is used to represent a continuous random variable because it is defined throughout a range of values (or the integral).</p>
<p><strong>Probability distribution functions (pdf)</strong> are functions that take on continuous values and represent the probability distribution of a continuous random variable. Because the number of possible values for the random variable is unlimited, the probability of seeing any single value is zero.</p>
<p>A random variable <span class="math notranslate nohighlight">\(X\)</span>, for example, could take any value within a range of real integers. The area above and below a curve is defined as the probability that <span class="math notranslate nohighlight">\(X\)</span> is in the set of outcomes <span class="math notranslate nohighlight">\(A,P(A)\)</span>. The curve that represents the function <span class="math notranslate nohighlight">\(p(x)\)</span> must meet the following requirements:</p>
<ol class="simple">
<li><p>There are no negative values on the curve (<span class="math notranslate nohighlight">\(p(x)&gt;0\)</span> for all <span class="math notranslate nohighlight">\(x\)</span>).</p></li>
<li><p>The total area under the curve is 1.</p></li>
</ol>
<p>The term <strong>density curve</strong> refers to a curve that meets certain criteria.</p>
<p>Normal distribution, exponential distribution, beta distribution, and other continuous probability distributions are examples.</p>
<section id="the-uniform-distribution">
<h4><span class="section-number">7.4.2.1. </span>The uniform distribution<a class="headerlink" href="#the-uniform-distribution" title="Permalink to this headline">¶</a></h4>
<p>The <strong>uniform distribution</strong> is one of the most basic and useful distributions. The probability distribution function of the continuous uniform distribution’s is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}f(x)={\begin{cases}{\frac {1}{b-a}}&amp;\mathrm {for} \ a\leq x\leq b,\\[8pt]0&amp;\mathrm {for} \ x&lt;a\ \mathrm {or} \ x&gt;b\end{cases}}\end{split}\]</div>
<p>The curve depicting the distribution is a rectangle, with constant height across the interval and 0 height everywhere, because each interval of numbers of equal width has an equal chance of being seen.</p>
<p>Because the area under the curve must equal 1, the height of the curve is determined by the length of the gap.</p>
<p>A uniform distribution in intervals <span class="math notranslate nohighlight">\((a,b)\)</span> is depicted in the diagram below. Because the area must be 1, <span class="math notranslate nohighlight">\(1/(b-a)\)</span> is the height setting.</p>
</section>
<section id="uniform-distribution-in-python">
<h4><span class="section-number">7.4.2.2. </span>Uniform Distribution in Python<a class="headerlink" href="#uniform-distribution-in-python" title="Permalink to this headline">¶</a></h4>
<p>We can also use plotnine to construct more complicated statistical visualisations than simple plots like bar and scatterplots.</p>
<p>We can combine the capabilities of the <strong>scipy</strong> package with <strong>plotnine</strong> to chart some probability density functions in the plot below.</p>
<p>Here we use <code class="docutils literal notranslate"><span class="pre">stat_function</span></code> to superimpose a function (or add the graph of a function) onto a plot.</p>
<p>Also, we also specify the density function of a uniform distributin in scipy as <code class="docutils literal notranslate"><span class="pre">uniform.pdf()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://stackoverflow.com/questions/48349713/how-to-graph-a-function-in-python-using-plotnine-library</span>
<span class="c1"># https://t-redactyl.io/blog/2019/10/making-beautiful-plots-in-python-plus-a-shameless-book-plug.html</span>
<span class="n">a</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">b</span> <span class="o">=</span> <span class="mi">2</span>

<span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">]}),</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">stat_function</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span>  <span class="n">uniform</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">b</span><span class="o">-</span><span class="n">a</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Chapter5_Practical_Statistics_79_0.png" src="_images/Chapter5_Practical_Statistics_79_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (310012209)&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="uniform-random-variate">
<h4><span class="section-number">7.4.2.3. </span>Uniform random variate<a class="headerlink" href="#uniform-random-variate" title="Permalink to this headline">¶</a></h4>
<p>In probability and statistics, a <strong>random variate</strong> is a particular outcome of a random variable: the random variates which are other outcomes of the same random variable might have different values (random numbers).</p>
<p>The <code class="docutils literal notranslate"><span class="pre">uniform.rvs</span></code> function, with its <code class="docutils literal notranslate"><span class="pre">loc</span></code> and <code class="docutils literal notranslate"><span class="pre">scale</span></code> arguments, creates a uniform continuous variable between the provided intervals.</p>
<p>In the standard form, the distribution is uniform on [0, 1]. Using the parameters loc and scale, one obtains the uniform distribution on [loc, loc + scale].</p>
<p>The <code class="docutils literal notranslate"><span class="pre">size</span></code> arguments specify how many random variates there are. Include a random state argument with a number if you wish to keep things consistent.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># random numbers from uniform distribution</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">start</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">width</span> <span class="o">=</span> <span class="mi">2</span>

<span class="n">data_uniform</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="n">uniform</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="n">start</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">width</span><span class="p">)})</span>
</pre></div>
</div>
</div>
</div>
<p>To visualize the histogram of the distribution you just built together with the kernel density estimate, use plotnine as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">data_uniform</span><span class="p">)</span> <span class="o">+</span>  <span class="c1"># What data to use</span>
    <span class="n">aes</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="o">+</span>  <span class="c1"># What variable to use</span>
    <span class="n">geom_histogram</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">after_stat</span><span class="p">(</span><span class="s1">&#39;density&#39;</span><span class="p">)),</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="c1"># Geometric object to use for drawing</span>
    <span class="n">geom_density</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">after_stat</span><span class="p">(</span><span class="s1">&#39;density&#39;</span><span class="p">)))</span> 
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Chapter5_Practical_Statistics_84_0.png" src="_images/Chapter5_Practical_Statistics_84_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (278390077)&gt;
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="normal-distribution-function">
<h3><span class="section-number">7.4.3. </span>Normal Distribution Function<a class="headerlink" href="#normal-distribution-function" title="Permalink to this headline">¶</a></h3>
<p>In Data Science, the <strong>Normal Distribution</strong>, commonly known as the <strong>Gaussian Distribution</strong>, is often used, especially when it comes to statistical inference. Many data science techniques make this assumption as well.</p>
<p>The mean <span class="math notranslate nohighlight">\(\mu\)</span> and standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span> of a normal distribution define a bell-shaped density curve. The density curve is symmetrical, centered around its mean, and its spread is determined by its standard deviation, indicating that data close to the mean occur more frequently than those further from it.</p>
<p>At a given point <span class="math notranslate nohighlight">\(x\)</span>, the probability distribution function of a normal density curve with mean <span class="math notranslate nohighlight">\(\mu\)</span> and standard deviation <span class="math notranslate nohighlight">\(\sigma\)</span> is:
$<span class="math notranslate nohighlight">\({\displaystyle f(x)={\frac {1}{\sigma {\sqrt {2\pi }}}}e^{-{\frac {1}{2}}\left({\frac {x-\mu }{\sigma }}\right)^{2}}}\)</span>$</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># df = pd.DataFrame({&#39;x&#39;:np.linspace(-10.0,10.0,200)})</span>
<span class="c1"># df = df.assign(y = norm.pdf(df.x))</span>
</pre></div>
</div>
</div>
</div>
<p>The following code plots the density of the normal distribution where the location (<code class="docutils literal notranslate"><span class="pre">loc</span></code>) keyword specifies the mean. The scale (<code class="docutils literal notranslate"><span class="pre">scale</span></code>) keyword specifies the standard deviation</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sd</span> <span class="o">=</span> <span class="mi">1</span>

<span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">]}),</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">stat_function</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span>  <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="n">mu</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">sd</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Chapter5_Practical_Statistics_88_0.png" src="_images/Chapter5_Practical_Statistics_88_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (311062993)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.01</span><span class="p">),</span>
                <span class="n">norm</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.99</span><span class="p">),</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">),</span>
       <span class="s1">&#39;r-&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;norm pdf&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x128930e50&gt;]
</pre></div>
</div>
<img alt="_images/Chapter5_Practical_Statistics_89_1.png" src="_images/Chapter5_Practical_Statistics_89_1.png" />
</div>
</div>
<p>Exercise:</p>
<ol class="simple">
<li><p>What percent of data falls within 1 standard deviation above the mean?</p></li>
<li><p>What percent of data falls within 2 standard deviation above the mean?</p></li>
</ol>
<p>Hint: use <code class="docutils literal notranslate"><span class="pre">norm.cdf(x,</span> <span class="pre">loc,</span> <span class="pre">scale)</span></code> cumulative distribution function.</p>
<p>Exercise:</p>
<ol class="simple">
<li><p>Generate <span class="math notranslate nohighlight">\(n = 10000\)</span> random numbers from standard normal distribution.</p></li>
<li><p>Plot the histogram of those <span class="math notranslate nohighlight">\(n\)</span> random numbers and superimpose the kernel density estimate of the histogram.</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># random numbers from normal distribution</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sd</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">data_norm</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="n">norm</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="n">mu</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="n">sd</span><span class="p">)})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">data_norm</span><span class="p">)</span> <span class="o">+</span>  <span class="c1"># What data to use</span>
    <span class="n">aes</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="o">+</span>  <span class="c1"># What variable to use</span>
    <span class="n">geom_histogram</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">after_stat</span><span class="p">(</span><span class="s1">&#39;density&#39;</span><span class="p">)),</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span> <span class="n">fill</span> <span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">colour</span> <span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="c1"># Geometric object to use for drawing</span>
    <span class="n">geom_density</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">after_stat</span><span class="p">(</span><span class="s1">&#39;density&#39;</span><span class="p">)),</span><span class="n">colour</span> <span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">)</span> 
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Chapter5_Practical_Statistics_93_0.png" src="_images/Chapter5_Practical_Statistics_93_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (311126465)&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="poisson-distribution">
<h3><span class="section-number">7.4.4. </span>Poisson Distribution<a class="headerlink" href="#poisson-distribution" title="Permalink to this headline">¶</a></h3>
<p>Typically, a Poisson random variable is used to model the number of times an event occurs in a certain time frame. A Poisson process, for example, might be considered as the number of users who visit a website at a certain interval.</p>
<p>The rate (<span class="math notranslate nohighlight">\(\mu\)</span>) at which events occur is given by the Poisson distribution. In a certain interval, an event can occur 0, 1, 2,… times.</p>
<p>The average number of events in an interval is designated <span class="math notranslate nohighlight">\(λ\)</span> (lambda). The event rate, commonly known as the rate parameter, is <span class="math notranslate nohighlight">\(\lambda\)</span>.</p>
<p>The following equation gives the likelihood of seeing <span class="math notranslate nohighlight">\(k\)</span> events in a given interval:
$<span class="math notranslate nohighlight">\(\!f(k; \lambda)= \Pr(X{=}k)= \frac{\lambda^k e^{-\lambda}}{k!},\)</span>$</p>
<section id="poisson-distribution-function">
<h4><span class="section-number">7.4.4.1. </span>Poisson Distribution Function<a class="headerlink" href="#poisson-distribution-function" title="Permalink to this headline">¶</a></h4>
<p>It is worth noting that</p>
<ol class="simple">
<li><p>the normal distribution is a special case of the Poisson distribution with parameter <span class="math notranslate nohighlight">\(\lambda \rightarrow \infty\)</span>.</p></li>
<li><p>In addition, if the intervals between random events follow an exponential distribution with rate <span class="math notranslate nohighlight">\(\lambda\)</span>, then the total number of occurrences in a time period of length <span class="math notranslate nohighlight">\(t\)</span> follows the Poisson distribution with parameter <span class="math notranslate nohighlight">\(\lambda t\)</span>.</p></li>
</ol>
<p>Exercise:</p>
<ol class="simple">
<li><p>Generate <span class="math notranslate nohighlight">\(n = 1000\)</span> random numbers from a Poisson  distribution with rates <span class="math notranslate nohighlight">\(\lambda = 1\)</span> and <span class="math notranslate nohighlight">\(\lambda  = 4\)</span>.</p></li>
<li><p>Plot the histogram of those <span class="math notranslate nohighlight">\(n\)</span> random numbers.</p></li>
<li><p>Create the frequency distribution of the random numbers generated and compare with those numbers (frequencies) obtained from the Poisson distribution with the specified parameter values.</p></li>
</ol>
<p>Before attempting to answer questions, we first plot the pmf of a Poisson distribution.</p>
<p>The following python codes plot the pmf of a Poisson distribution using matplotlib and plotnine.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="n">mu</span> <span class="o">=</span> <span class="mi">4</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">poisson</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">mu</span><span class="p">),</span>
              <span class="n">poisson</span><span class="o">.</span><span class="n">ppf</span><span class="p">(</span><span class="mf">0.99</span><span class="p">,</span> <span class="n">mu</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">poisson</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">),</span> <span class="s1">&#39;bo&#39;</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;poisson pmf&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">vlines</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">poisson</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">),</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.LineCollection at 0x128b25590&gt;
</pre></div>
</div>
<img alt="_images/Chapter5_Practical_Statistics_97_1.png" src="_images/Chapter5_Practical_Statistics_97_1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span> <span class="o">=</span> <span class="mi">4</span>

<span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">]}),</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;x&quot;</span><span class="p">))</span>
    <span class="o">+</span> <span class="n">stat_function</span><span class="p">(</span><span class="n">geom</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="n">fun</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span>  <span class="n">poisson</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">mu</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Chapter5_Practical_Statistics_98_0.png" src="_images/Chapter5_Practical_Statistics_98_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (311160229)&gt;
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Generate <span class="math notranslate nohighlight">\(n = 1000\)</span> random numbers from a Poisson  distribution with rates <span class="math notranslate nohighlight">\(\lambda = 1\)</span> and <span class="math notranslate nohighlight">\(\lambda  = 4\)</span>.</p></li>
</ol>
<p>Ans: We use <code class="docutils literal notranslate"><span class="pre">poisson.rvs</span></code> to generate <span class="math notranslate nohighlight">\(n\)</span> random number from the Poisson distributin with <span class="math notranslate nohighlight">\(\lambda  = 4\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># random numbers from Poisson distribution</span>

<span class="n">n</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">mu</span> <span class="o">=</span> <span class="mi">4</span>

<span class="n">data_poisson</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="n">poisson</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="n">mu</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">n</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">888</span><span class="p">)})</span>
</pre></div>
</div>
</div>
</div>
<p>By the method of moments, we can obtain the parameter of the Poisson distribution by matching</p>
<p>Model : X ~ Poisson(lambda)</p>
<p>E[X] = lambda = X_bar = sample mean</p>
<p>The estimate of lambda (lambda~ = sample mean)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lambda_est</span> <span class="o">=</span> <span class="n">data_poisson</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">lambda_est</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>4.033
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Plot the histogram of those <span class="math notranslate nohighlight">\(n\)</span> random numbers.</p></li>
</ol>
<p>Ans: The histogram can be obtained as follows:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">data_poisson</span><span class="p">)</span> <span class="o">+</span> 
    <span class="n">aes</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="o">+</span> 
    <span class="n">geom_histogram</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">after_stat</span><span class="p">(</span><span class="s1">&#39;count&#39;</span><span class="p">)),</span> <span class="n">binwidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span> <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Chapter5_Practical_Statistics_104_0.png" src="_images/Chapter5_Practical_Statistics_104_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (279189929)&gt;
</pre></div>
</div>
</div>
</div>
<ol class="simple">
<li><p>Create the frequency distribution of the random numbers generated and compare with those numbers (frequencies) obtained from the Poisson distribution with the specified parameter values.</p></li>
</ol>
<p>Ans: We can simply create a frequency table using <code class="docutils literal notranslate"><span class="pre">value_counts</span></code>. Note that we also specify <code class="docutils literal notranslate"><span class="pre">sort=False</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_poisson</span><span class="o">.</span><span class="n">value_counts</span><span class="p">(</span><span class="n">sort</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>x 
0      26
1      67
2     140
3     175
4     206
5     168
6     109
7      65
8      22
9      11
10      8
11      3
dtype: int64
</pre></div>
</div>
</div>
</div>
<p>Alternatively, we can also create the frequency table using <code class="docutils literal notranslate"><span class="pre">groupby</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data_poisson</span><span class="p">[</span><span class="s1">&#39;simulation&#39;</span><span class="p">]</span><span class="o">=</span> <span class="n">data_poisson</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span>
<span class="c1">#data_poisson[&#39;freq&#39;]= data_poisson[&#39;x&#39;]</span>
<span class="n">data_poisson</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>simulation</th>
    </tr>
    <tr>
      <th>x</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>26</td>
    </tr>
    <tr>
      <th>1</th>
      <td>67</td>
    </tr>
    <tr>
      <th>2</th>
      <td>140</td>
    </tr>
    <tr>
      <th>3</th>
      <td>175</td>
    </tr>
    <tr>
      <th>4</th>
      <td>206</td>
    </tr>
    <tr>
      <th>5</th>
      <td>168</td>
    </tr>
    <tr>
      <th>6</th>
      <td>109</td>
    </tr>
    <tr>
      <th>7</th>
      <td>65</td>
    </tr>
    <tr>
      <th>8</th>
      <td>22</td>
    </tr>
    <tr>
      <th>9</th>
      <td>11</td>
    </tr>
    <tr>
      <th>10</th>
      <td>8</td>
    </tr>
    <tr>
      <th>11</th>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>With the specified value of <span class="math notranslate nohighlight">\(n\)</span> (the number of simulated random numbers), we calculate the expected numbers from the Poisson distribution and add them into a new column called <strong>poisson</strong>.</p>
<p>The results also show that the distribution of the simulated random numbers comes from the Poisson distribution. How do we  confirm our findings?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">output_freq</span> <span class="o">=</span> <span class="n">data_poisson</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">count</span><span class="p">()</span>
<span class="n">output_freq</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output_freq</span><span class="o">.</span><span class="n">index</span>
<span class="n">output_freq</span><span class="o">.</span><span class="n">sort_index</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">output_freq</span><span class="p">[</span><span class="s1">&#39;poisson&#39;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">n</span><span class="o">*</span><span class="n">poisson</span><span class="o">.</span><span class="n">pmf</span><span class="p">(</span><span class="n">output_freq</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span><span class="n">mu</span><span class="p">)</span>
<span class="n">output_freq</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>simulation</th>
      <th>poisson</th>
    </tr>
    <tr>
      <th>x</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>26</td>
      <td>18.315639</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>67</td>
      <td>73.262556</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>140</td>
      <td>146.525111</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>175</td>
      <td>195.366815</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>206</td>
      <td>195.366815</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>168</td>
      <td>156.293452</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>109</td>
      <td>104.195635</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>65</td>
      <td>59.540363</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>22</td>
      <td>29.770181</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>11</td>
      <td>13.231192</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
      <td>8</td>
      <td>5.292477</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
      <td>3</td>
      <td>1.924537</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#pd.melt(output_freq, id_vars = &#39;x&#39;, value_vars=[&#39;freq&#39;,&#39;poisson&#39;], value_name=&#39;values&#39;)</span>
<span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">output_freq</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;simulation&#39;</span><span class="p">,</span><span class="s1">&#39;poisson&#39;</span><span class="p">],</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;values&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>variable</th>
      <th>values</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>simulation</td>
      <td>26.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>simulation</td>
      <td>67.000000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2</td>
      <td>simulation</td>
      <td>140.000000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3</td>
      <td>simulation</td>
      <td>175.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4</td>
      <td>simulation</td>
      <td>206.000000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>5</td>
      <td>simulation</td>
      <td>168.000000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>6</td>
      <td>simulation</td>
      <td>109.000000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>7</td>
      <td>simulation</td>
      <td>65.000000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>8</td>
      <td>simulation</td>
      <td>22.000000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>9</td>
      <td>simulation</td>
      <td>11.000000</td>
    </tr>
    <tr>
      <th>10</th>
      <td>10</td>
      <td>simulation</td>
      <td>8.000000</td>
    </tr>
    <tr>
      <th>11</th>
      <td>11</td>
      <td>simulation</td>
      <td>3.000000</td>
    </tr>
    <tr>
      <th>12</th>
      <td>0</td>
      <td>poisson</td>
      <td>18.315639</td>
    </tr>
    <tr>
      <th>13</th>
      <td>1</td>
      <td>poisson</td>
      <td>73.262556</td>
    </tr>
    <tr>
      <th>14</th>
      <td>2</td>
      <td>poisson</td>
      <td>146.525111</td>
    </tr>
    <tr>
      <th>15</th>
      <td>3</td>
      <td>poisson</td>
      <td>195.366815</td>
    </tr>
    <tr>
      <th>16</th>
      <td>4</td>
      <td>poisson</td>
      <td>195.366815</td>
    </tr>
    <tr>
      <th>17</th>
      <td>5</td>
      <td>poisson</td>
      <td>156.293452</td>
    </tr>
    <tr>
      <th>18</th>
      <td>6</td>
      <td>poisson</td>
      <td>104.195635</td>
    </tr>
    <tr>
      <th>19</th>
      <td>7</td>
      <td>poisson</td>
      <td>59.540363</td>
    </tr>
    <tr>
      <th>20</th>
      <td>8</td>
      <td>poisson</td>
      <td>29.770181</td>
    </tr>
    <tr>
      <th>21</th>
      <td>9</td>
      <td>poisson</td>
      <td>13.231192</td>
    </tr>
    <tr>
      <th>22</th>
      <td>10</td>
      <td>poisson</td>
      <td>5.292477</td>
    </tr>
    <tr>
      <th>23</th>
      <td>11</td>
      <td>poisson</td>
      <td>1.924537</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To compare the plots of frequency plots (bar plots) side by side (from two variables <strong>simulation</strong> and <strong>poisson</strong> of our data frame, we need to <strong>reshape</strong> our data frame into a more computer-friendly form using Pandas in Python.</p>
<p>To achieve this, <code class="docutils literal notranslate"><span class="pre">pandas.melt()</span></code> unpivots a DataFrame from wide format to long format.</p>
<p><code class="docutils literal notranslate"><span class="pre">melt()</span></code> function is useful to reshape a DataFrame into a format where one or more columns are identifier variables, while all other columns, considered measured variables, are unpivoted to the row axis, leaving just two non-identifier columns, variable and value.</p>
<p>See <a class="reference external" href="https://stackoverflow.com/questions/42820677/ggplot-bar-plot-side-by-side-using-two-variables">https://stackoverflow.com/questions/42820677/ggplot-bar-plot-side-by-side-using-two-variables</a></p>
<p><a class="reference external" href="https://www.geeksforgeeks.org/python-pandas-melt/">https://www.geeksforgeeks.org/python-pandas-melt/</a> for more detail.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://stackoverflow.com/questions/42820677/ggplot-bar-plot-side-by-side-using-two-variables</span>
<span class="c1"># https://www.geeksforgeeks.org/python-pandas-melt/</span>

<span class="n">output_freq_melted</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">output_freq</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;simulation&#39;</span><span class="p">,</span><span class="s1">&#39;poisson&#39;</span><span class="p">],</span> <span class="n">value_name</span><span class="o">=</span><span class="s1">&#39;values&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">output_freq_melted</span><span class="p">)</span>

<span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">output_freq_melted</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;values&#39;</span><span class="p">,</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;variable&#39;</span><span class="p">))</span> <span class="o">+</span>
    <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="o">=</span><span class="s1">&#39;identity&#39;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;dodge&#39;</span><span class="p">)</span>
<span class="p">)</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>     x    variable      values
0    0  simulation   26.000000
1    1  simulation   67.000000
2    2  simulation  140.000000
3    3  simulation  175.000000
4    4  simulation  206.000000
5    5  simulation  168.000000
6    6  simulation  109.000000
7    7  simulation   65.000000
8    8  simulation   22.000000
9    9  simulation   11.000000
10  10  simulation    8.000000
11  11  simulation    3.000000
12   0     poisson   18.315639
13   1     poisson   73.262556
14   2     poisson  146.525111
15   3     poisson  195.366815
16   4     poisson  195.366815
17   5     poisson  156.293452
18   6     poisson  104.195635
19   7     poisson   59.540363
20   8     poisson   29.770181
21   9     poisson   13.231192
22  10     poisson    5.292477
23  11     poisson    1.924537
</pre></div>
</div>
<img alt="_images/Chapter5_Practical_Statistics_113_1.png" src="_images/Chapter5_Practical_Statistics_113_1.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (312077221)&gt;
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="fitting-models-to-data">
<h2><span class="section-number">7.5. </span>Fitting Models to Data<a class="headerlink" href="#fitting-models-to-data" title="Permalink to this headline">¶</a></h2>
<p>We will learn how to find the best-matching statistical distributions for your data points. Modeling quantities of interest for example claim numbers and sizes is the subject of this section, which involves fitting probability distributions from selected families to sets of data containing observed claim numbers or sizes.</p>
<p>After an exploratory investigation of the data set, the family may be chosen by looking at numerical summaries such as mean, median, mode, standard deviation (or variance), skewness, kurtosis, and graphs like the empirical distribution function.</p>
<p>Of course, one might want to fit a distribution from each of several families to compare the fitted models, as well as compare them to earlier work and make a decision.</p>
<p>In statistics, <strong>probability distributions</strong> are a fundamental concept. They are employed in both theoretical and practical settings.</p>
<p>The following are some examples of probability distributions in use:</p>
<ul class="simple">
<li><p>It is frequently used in the case of univariate data to determine an appropriate distributional model for the data.</p></li>
<li><p>Specific distributional assumptions are frequently used in statistical intervals and hypothesis tests.</p></li>
<li><p>Calculate parameter confidence intervals as well as critical regions for hypothesis testing.</p></li>
<li><p>Continuous probability distributions are frequently employed in machine learning models, particularly in the distribution of numerical input and output variables, as well as the distribution of model errors.</p></li>
</ul>
<p>To fit a <strong>parametric model</strong> (i.e. a probability distribution), we must obtain estimates of the probability distribution’s unknown parameters. The method of moments, the method of maximum likelihood, the method of percentiles, and the method of minimum distance are among the criteria offered.</p>
<section id="generate-test-data-and-fit-it">
<h3><span class="section-number">7.5.1. </span>Generate test data and fit it<a class="headerlink" href="#generate-test-data-and-fit-it" title="Permalink to this headline">¶</a></h3>
<p>For the first illustration, we will begin by generating some normally distributed test data using the <strong>NumPy</strong> module and fit them by using the <strong>Fitter</strong> library to see whether the fitter is able to identify the distribution.</p>
<p>The <strong>Fitter</strong> package offers a basic class that can be used to identify the distribution from which a data sample is drawn. It employs 80 Scipy distributions and allows you to plot the results to see which distribution is the most likely and which parameters are the best.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set random seed and generate test data</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">88</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="n">data</span><span class="p">})</span>

<span class="c1"># Alternatively, we can run</span>
<span class="c1"># data_norm = pd.DataFrame({&#39;x&#39;:norm.rvs(size=n, loc = mu, scale=sd)})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6.068843</td>
    </tr>
    <tr>
      <th>1</th>
      <td>27.058152</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14.565627</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.684111</td>
    </tr>
    <tr>
      <th>4</th>
      <td>15.685138</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We can use the plotnine to plot the histogram. The number of bins provided here is 20. The plot shows that the data overall follows a normal distribution.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">+</span> <span class="n">aes</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">geom_histogram</span><span class="p">(</span><span class="n">bins</span> <span class="o">=</span> <span class="mi">40</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Chapter5_Practical_Statistics_119_0.png" src="_images/Chapter5_Practical_Statistics_119_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (313611497)&gt;
</pre></div>
</div>
</div>
</div>
</section>
<section id="fitting-distributions">
<h3><span class="section-number">7.5.2. </span>Fitting distributions<a class="headerlink" href="#fitting-distributions" title="Permalink to this headline">¶</a></h3>
<p>The next step is to start fitting different distributions to the data and determining which one is best for the data.</p>
<p>The steps are as follows:</p>
<ol class="simple">
<li><p>Call the Fitter method to create a Fitter instance.</p></li>
<li><p>If you have a basic idea of the distributions that might fit your data, provide the data and distributions list.</p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">.fit()</span></code> method.</p></li>
<li><p>Using the <code class="docutils literal notranslate"><span class="pre">.summary()</span></code> method, create a summary of the fitted distribution.</p></li>
</ol>
<p><strong>Note:</strong> If you have no idea what distribution might fit your data at first, you can run Fitter() and merely provide the data.</p>
<p>The Fitter class in the backend uses the <strong>Scipy</strong> library, which supports 80 different distributions. The <strong>Fitter</strong> class will scan all of them, call the fit function for you, ignore any that fail or run forever, and then provide you a summary of the best distributions in terms of sum of square errors.</p>
<p>However, because it will try so many different distributions, this may take some time, and the fitting time varies depending on the size of your sample. As a result, it is recommended that you display a histogram to have a general idea of the types of distributions that might match the data and supply those distribution names in a list. This will save you a lot of time.</p>
<p><strong>Fitter</strong> library utilizes SciPy’s fit method to extract the parameters of a distribution that best fit the data given a data sample. This process is repeated for all available distributions. Finally, we present a summary so that the quality of the fit for those distributions may be determined.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pip install fitter</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Required libraries</span>

<span class="kn">from</span> <span class="nn">fitter</span> <span class="kn">import</span> <span class="n">Fitter</span><span class="p">,</span> <span class="n">get_common_distributions</span><span class="p">,</span> <span class="n">get_distributions</span>
</pre></div>
</div>
</div>
</div>
<p>Here we speficy a list of possible undelying distribution that could have generated a data set including gamma, lognormal, beta and normal distributions.</p>
<p>However, the distribution’s parameters are unknown, thus there are numerous distributions. As a result, an automated method of fitting multiple distributions to the data would be beneficial.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">Fitter</span><span class="p">(</span><span class="n">data</span><span class="p">,</span>
           <span class="n">distributions</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;gamma&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;lognorm&#39;</span><span class="p">,</span>
                          <span class="s2">&quot;norm&quot;</span><span class="p">])</span>
<span class="n">f</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">f</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sumsquare_error</th>
      <th>aic</th>
      <th>bic</th>
      <th>kl_div</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>norm</th>
      <td>0.001267</td>
      <td>960.095049</td>
      <td>-28528.628648</td>
      <td>inf</td>
    </tr>
    <tr>
      <th>lognorm</th>
      <td>0.001281</td>
      <td>964.877953</td>
      <td>-28499.085772</td>
      <td>inf</td>
    </tr>
    <tr>
      <th>gamma</th>
      <td>0.001310</td>
      <td>964.163478</td>
      <td>-28453.859526</td>
      <td>inf</td>
    </tr>
  </tbody>
</table>
</div></div><img alt="_images/Chapter5_Practical_Statistics_124_1.png" src="_images/Chapter5_Practical_Statistics_124_1.png" />
</div>
</div>
</section>
<section id="choosing-the-most-appropriate-distribution-and-indentifying-the-parameters">
<h3><span class="section-number">7.5.3. </span>Choosing the most appropriate distribution and indentifying the parameters<a class="headerlink" href="#choosing-the-most-appropriate-distribution-and-indentifying-the-parameters" title="Permalink to this headline">¶</a></h3>
<p>We may also use the <code class="docutils literal notranslate"><span class="pre">.get_best()</span></code> method to retrieve the best distribution, where we can additionally specify the technique for picking the best distribution.</p>
<p>As selection criteria, we can use the <code class="docutils literal notranslate"><span class="pre">sumsquare_error</span></code> in the method argument. It will print the name of the distribution with the lowest sum square error, as well as the relevant parameters. ‘sumsquare_error’ is a formula used to measure the difference between the given data and the expected data obtained by the fitted model, i.e. <strong>lower is better</strong>.</p>
<p>Based on the sum square error criteria, we can observe that the normal distribution is the best fit. It also prints the normal distribution’s optimum parameters including location (loc), and scale parameters (scale).</p>
<p>Note that sum of the square errors between the data <span class="math notranslate nohighlight">\(Y_i\)</span> and the fitted distribution <span class="math notranslate nohighlight">\(pdf(X_i)\)</span> is defined by $<span class="math notranslate nohighlight">\(\sum_i \left( Y_i - pdf(X_i) \right)^2.\)</span>$
(see <a class="reference external" href="https://fitter.readthedocs.io/en/latest/references.html?highlight=sum%20square#fitter.fitter.Fitter.fit">https://fitter.readthedocs.io/en/latest/references.html?highlight=sum square#fitter.fitter.Fitter.fit</a>)</p>
<p>Alternative to the square errors, we can also test the goodness of fit using the <strong>Kolmogorov–Smirnov test</strong> after fitting a probability distribution to our data. The Kolmogorov–Smirnov test is a widely used option.   The test essentially provides you with a statistic and a p-value, which you must interpret using a K-S test table.</p>
<p>See <a class="reference external" href="https://medium.com/&#64;amirarsalan.rajabi/distribution-fitting-with-python-scipy-bb70a42c0aed">https://medium.com/&#64;amirarsalan.rajabi/distribution-fitting-with-python-scipy-bb70a42c0aed</a> for more detail.</p>
<p>For details about relative fit measures and goodness of fit see <a class="reference external" href="https://vortarus.com/assessing-distribution-fit/">https://vortarus.com/assessing-distribution-fit/</a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">get_best</span><span class="p">(</span><span class="n">method</span> <span class="o">=</span> <span class="s1">&#39;sumsquare_error&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;norm&#39;: {&#39;loc&#39;: 5.630744055249008, &#39;scale&#39;: 9.899359274217787}}
</pre></div>
</div>
</div>
</div>
<p>In addition, we can also print the fitted parameters using the fitted_param attribute and indexing it out using the distribution name for example ‘gamma’.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">fitted_param</span><span class="p">[</span><span class="s1">&#39;norm&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(5.630744055249008, 9.899359274217787)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="o">.</span><span class="n">fitted_param</span><span class="p">[</span><span class="s1">&#39;lognorm&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(0.010345149115340332, -948.2039689041416, 953.8081165452257)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">data</span><span class="p">)</span> <span class="o">+</span>  <span class="c1"># What data to use</span>
    <span class="n">aes</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span> <span class="o">+</span>  <span class="c1"># What variable to use</span>
    <span class="n">geom_histogram</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">after_stat</span><span class="p">(</span><span class="s1">&#39;density&#39;</span><span class="p">)),</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">40</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="c1"># Geometric object to use for drawing</span>
    <span class="n">geom_density</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">after_stat</span><span class="p">(</span><span class="s1">&#39;density&#39;</span><span class="p">)),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span> <span class="o">+</span>
    <span class="n">stat_function</span><span class="p">(</span><span class="n">fun</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span>  <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">fitted_param</span><span class="p">[</span><span class="s1">&#39;norm&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">fitted_param</span><span class="p">[</span><span class="s1">&#39;norm&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]),</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">)</span> 
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Chapter5_Practical_Statistics_130_0.png" src="_images/Chapter5_Practical_Statistics_130_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (313770689)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># data2.drop(&#39;fitted&#39;,axis=1,inplace=True)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Aim: add type so that legend will be created</span>

<span class="n">data2</span> <span class="o">=</span> <span class="n">data</span>
<span class="n">data2</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span>
<span class="n">data2</span><span class="p">[</span><span class="s1">&#39;fitted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">data2</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">],</span> <span class="n">loc</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">fitted_param</span><span class="p">[</span><span class="s1">&#39;norm&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">fitted_param</span><span class="p">[</span><span class="s1">&#39;norm&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>  <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#data2.drop(&#39;type&#39;,axis=1,inplace=True)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># (ggplot(data2) + aes(x = &#39;x&#39;, y = &#39;fitted&#39;,color=&#39;type&#39;) + geom_line() + geom_histogram(aes(y=after_stat(&#39;density&#39;))  ))</span>

<span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span> <span class="o">+</span>  <span class="c1"># What data to use</span>
    <span class="n">aes</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">)</span> <span class="o">+</span>  <span class="c1"># What variable to use</span>
    <span class="n">geom_histogram</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">after_stat</span><span class="p">(</span><span class="s1">&#39;density&#39;</span><span class="p">)),</span><span class="n">fill</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">40</span>  <span class="p">)</span> <span class="o">+</span>
    <span class="n">scale_color_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Chapter5_Practical_Statistics_134_0.png" src="_images/Chapter5_Practical_Statistics_134_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (313762393)&gt;
</pre></div>
</div>
</div>
</div>
<p><strong>Note</strong> alternative to Fitter library, we can also use <strong>Distfit</strong> Python library to automatically fit distributions to data.</p>
<p>See the following links for more details:</p>
<p><a class="reference external" href="https://erdogant.github.io/distfit/pages/html/index.html">https://erdogant.github.io/distfit/pages/html/index.html</a></p>
<p><a class="reference external" href="https://towardsdatascience.com/find-the-best-matching-distribution-for-your-data-effortlessly-bcc091aa08ab">https://towardsdatascience.com/find-the-best-matching-distribution-for-your-data-effortlessly-bcc091aa08ab</a></p>
</section>
<section id="distribution-fitting-with-distfit">
<h3><span class="section-number">7.5.4. </span>Distribution fitting with distfit<a class="headerlink" href="#distribution-fitting-with-distfit" title="Permalink to this headline">¶</a></h3>
<p>The distfit library uses the goodness of fit test with the Sum of Squared Errors (or estimates) (SSE) to determine the best probability distribution.</p>
<p>The Sum of Squared Errors (or estimates) (SSE), also named Residual Sum of Squares (RSS) works by comparing the observed frequency (f) to the expected frequency from the model (f-hat), and computing the residual sum of squares (RSS).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Load library</span>
<span class="kn">from</span> <span class="nn">distfit</span> <span class="kn">import</span> <span class="n">distfit</span>
<span class="c1"># Initialize model and test only for normal distribution</span>
<span class="c1">#dist = distfit(distr=&#39;norm&#39;)</span>
<span class="c1"># Set multiple distributions to test for</span>
<span class="c1"># see for bin size and smoothing https://erdogant.github.io/distfit/pages/html/Performance.html#probability-density-function-fitting</span>
<span class="n">dist</span> <span class="o">=</span> <span class="n">distfit</span><span class="p">(</span><span class="n">distr</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;norm&#39;</span><span class="p">,</span><span class="s1">&#39;lognorm&#39;</span><span class="p">],</span><span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>

<span class="c1"># Search for best theoretical fit on your empirical data</span>
<span class="n">results</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[distfit] &gt;fit..
[distfit] &gt;transform..
[distfit] &gt;[norm   ] [0.00 sec] [RSS: 0.0012671] [loc=5.631 scale=9.899]
[distfit] &gt;[lognorm] [0.28 sec] [RSS: 0.0012811] [loc=-948.204 scale=953.808]
[distfit] &gt;Compute confidence interval [parametric]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>

<span class="c1"># Make plot</span>
<span class="n">dist</span><span class="o">.</span><span class="n">plot_summary</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">dist</span><span class="o">.</span><span class="n">summary</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[distfit] &gt;plot..
[distfit] &gt;plot summary..
     distr     score  LLE         loc       scale                      arg
0     norm  0.001267  NaN    5.630744    9.899359                       ()
1  lognorm  0.001281  NaN -948.203969  953.808117  (0.010345149115340332,)
</pre></div>
</div>
<img alt="_images/Chapter5_Practical_Statistics_138_1.png" src="_images/Chapter5_Practical_Statistics_138_1.png" />
<img alt="_images/Chapter5_Practical_Statistics_138_2.png" src="_images/Chapter5_Practical_Statistics_138_2.png" />
</div>
</div>
</section>
<section id="distribution-fitting-with-python-scipy">
<h3><span class="section-number">7.5.5. </span>Distribution Fitting with Python SciPy<a class="headerlink" href="#distribution-fitting-with-python-scipy" title="Permalink to this headline">¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy</span> <span class="kn">import</span> <span class="n">stats</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>

<span class="n">dist</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="n">stats</span><span class="p">,</span> <span class="s1">&#39;norm&#39;</span><span class="p">)</span>
<span class="n">parameters</span> <span class="o">=</span> <span class="n">dist</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">parameters</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(5.630744055249008, 9.899359274217787)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#dist = getattr(stats, &#39;lognorm&#39;)</span>
<span class="c1">#parameters = dist.fit(data[&#39;x&#39;])</span>
<span class="c1">#print(parameters)</span>
</pre></div>
</div>
</div>
</div>
<section id="calculating-the-sum-of-squared-errors">
<h4><span class="section-number">7.5.5.1. </span>Calculating the sum of squared errors<a class="headerlink" href="#calculating-the-sum-of-squared-errors" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>type</th>
      <th>fitted</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>6.068843</td>
      <td>x</td>
      <td>0.040260</td>
    </tr>
    <tr>
      <th>1</th>
      <td>27.058152</td>
      <td>x</td>
      <td>0.003872</td>
    </tr>
    <tr>
      <th>2</th>
      <td>14.565627</td>
      <td>x</td>
      <td>0.026817</td>
    </tr>
    <tr>
      <th>3</th>
      <td>5.684111</td>
      <td>x</td>
      <td>0.040299</td>
    </tr>
    <tr>
      <th>4</th>
      <td>15.685138</td>
      <td>x</td>
      <td>0.024060</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1995</th>
      <td>10.669909</td>
      <td>x</td>
      <td>0.035403</td>
    </tr>
    <tr>
      <th>1996</th>
      <td>17.114355</td>
      <td>x</td>
      <td>0.020563</td>
    </tr>
    <tr>
      <th>1997</th>
      <td>8.697924</td>
      <td>x</td>
      <td>0.038411</td>
    </tr>
    <tr>
      <th>1998</th>
      <td>5.497944</td>
      <td>x</td>
      <td>0.040296</td>
    </tr>
    <tr>
      <th>1999</th>
      <td>14.580694</td>
      <td>x</td>
      <td>0.026780</td>
    </tr>
  </tbody>
</table>
<p>2000 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get histogram of original data</span>
<span class="c1">#y, x = np.histogram(data, bins=100, density=True)</span>
<span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">x_mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.0</span>  <span class="c1"># go from bin edges to bin middles</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#(ggplot(pd.DataFrame(data={&quot;x&quot;: x, &quot;y&quot;:y}), aes(x=&quot;x&quot;,y=&quot;y&quot;))</span>
<span class="c1">#    + geom_col())</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>9.899359274217787
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculate fitted PDF and error with fit in distribution</span>
<span class="n">pdf</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x_mid</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">scale</span><span class="o">=</span><span class="n">parameters</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="c1"># To go from pdf back to counts need to un-normalise the pdf</span>
<span class="c1"># See Fitting All of Scipy&#39;s Distributions: https://nedyoxall.github.io/fitting_all_of_scipys_distributions.html</span>
<span class="c1"># pdf_scaled = pdf * bin_width * N # to go from pdf back to counts need to un-normalise the pdf</span>

<span class="n">sse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">pdf</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="n">sse</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.0012671148087710314
</pre></div>
</div>
</div>
</div>
</section>
<section id="get-data-points-from-a-histogram-in-python-from-matplotlib">
<h4><span class="section-number">7.5.5.2. </span>Get data points from a histogram in Python from matplotlib<a class="headerlink" href="#get-data-points-from-a-histogram-in-python-from-matplotlib" title="Permalink to this headline">¶</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#counts, bins, bars = plt.hist(data, density=True,bins=10)</span>
<span class="n">counts</span><span class="p">,</span> <span class="n">bins</span><span class="p">,</span> <span class="n">bars</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">bins</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Chapter5_Practical_Statistics_150_0.png" src="_images/Chapter5_Practical_Statistics_150_0.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bins</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-26.34134829, -20.29646977, -14.25159126,  -8.20671274,
        -2.16183422,   3.88304429,   9.92792281,  15.97280133,
        22.01767984,  28.06255836,  34.10743688])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get histogram of original data</span>
<span class="n">y</span><span class="p">,</span> <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">histogram</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span> <span class="n">density</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">x_mid</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">roll</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="mf">2.0</span> <span class="c1"># go from bin edges to bin middles</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Aim: plot histogram of original data (from y and x obtained abov) </span>
<span class="c1"># and plot the fitted values</span>

<span class="n">df_freq</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;x&#39;</span><span class="p">:</span><span class="n">x_mid</span><span class="p">,</span> <span class="s1">&#39;data&#39;</span><span class="p">:</span><span class="n">y</span> <span class="p">})</span>

<span class="n">df_freq</span><span class="p">[</span><span class="s1">&#39;fitted&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">norm</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">df_freq</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">loc</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">fitted_param</span><span class="p">[</span><span class="s1">&#39;norm&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">scale</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">fitted_param</span><span class="p">[</span><span class="s1">&#39;norm&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>

<span class="n">df_freq</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>x</th>
      <th>data</th>
      <th>fitted</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-25.585738</td>
      <td>0.000331</td>
      <td>0.000279</td>
    </tr>
    <tr>
      <th>1</th>
      <td>-24.074519</td>
      <td>0.000662</td>
      <td>0.000447</td>
    </tr>
    <tr>
      <th>2</th>
      <td>-22.563299</td>
      <td>0.000662</td>
      <td>0.000698</td>
    </tr>
    <tr>
      <th>3</th>
      <td>-21.052080</td>
      <td>0.001985</td>
      <td>0.001066</td>
    </tr>
    <tr>
      <th>4</th>
      <td>-19.540860</td>
      <td>0.002316</td>
      <td>0.001590</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">df_freq</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">))</span> <span class="o">+</span> 
     <span class="n">geom_col</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;&quot;data&quot;&#39;</span><span class="p">),</span><span class="n">fill</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span> <span class="o">+</span>
     <span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;fitted&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;&quot;fitted&quot;&#39;</span><span class="p">))</span> <span class="o">+</span>
     <span class="n">scale_color_manual</span><span class="p">(</span><span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">])</span> <span class="o">+</span>
     <span class="n">scale_color_discrete</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Type&quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Chapter5_Practical_Statistics_154_0.png" src="_images/Chapter5_Practical_Statistics_154_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (313112281)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">df_freq</span><span class="p">,</span> <span class="n">aes</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">))</span> <span class="o">+</span> 
     <span class="n">geom_col</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;data&#39;</span><span class="p">))</span> <span class="o">+</span>
     <span class="n">geom_line</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="s1">&#39;fitted&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;&quot;fitted&quot;&#39;</span><span class="p">))</span> <span class="o">+</span>
     <span class="n">scale_color_discrete</span><span class="p">(</span><span class="n">name</span> <span class="o">=</span> <span class="s2">&quot; &quot;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Chapter5_Practical_Statistics_155_0.png" src="_images/Chapter5_Practical_Statistics_155_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (313105013)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_freq_melted</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">df_freq</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="s1">&#39;fitted&#39;</span><span class="p">],</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># https://rpubs.com/Mentors_Ubiqum/geom_col_1</span>

<span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df_freq_melted</span><span class="p">)</span> <span class="o">+</span>
    <span class="n">geom_col</span><span class="p">(</span><span class="n">aes</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;value&#39;</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">),</span> <span class="n">position</span><span class="o">=</span><span class="s1">&#39;dodge&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Chapter5_Practical_Statistics_157_0.png" src="_images/Chapter5_Practical_Statistics_157_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (314094577)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">ggplot</span><span class="p">(</span><span class="n">df_freq_melted</span><span class="p">)</span> <span class="o">+</span> 
    <span class="n">aes</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;value&#39;</span><span class="p">,</span><span class="n">fill</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">geom_bar</span><span class="p">(</span><span class="n">stat</span><span class="o">=</span><span class="s1">&#39;identity&#39;</span><span class="p">,</span><span class="n">position</span><span class="o">=</span><span class="s1">&#39;dodge&#39;</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Chapter5_Practical_Statistics_158_0.png" src="_images/Chapter5_Practical_Statistics_158_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (313475537)&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_freq_melted</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">melt</span><span class="p">(</span><span class="n">df_freq</span><span class="p">,</span> <span class="n">id_vars</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">value_vars</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">,</span><span class="s1">&#39;fitted&#39;</span><span class="p">],</span> <span class="n">var_name</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">)</span>


<span class="p">(</span><span class="n">ggplot</span><span class="p">(</span><span class="n">df_freq_melted</span><span class="p">)</span> <span class="o">+</span> 
     <span class="n">aes</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;value&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;type&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="n">geom_point</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/Chapter5_Practical_Statistics_159_0.png" src="_images/Chapter5_Practical_Statistics_159_0.png" />
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;ggplot: (313466893)&gt;
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="Chapter4_Data_Visualization.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title"><span class="section-number">6. </span>Data Visualization</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="Chapter6_Regression.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title"><span class="section-number">8. </span>Regression Analysis</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Pairote Satiracoo<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>